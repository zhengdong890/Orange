define("log/config",["require"],function(require){var exports={};return exports.logOnce=["data","load"],exports.sigleData={accountManage:["accountList"],authority:["dataRoleList"]},exports}),define("log/main",["require","./config"],function(require){function e(){return(new Date).getTime()}function t(e,t){var i=e[o]||[];if(i.length)return r(i,t)}function i(e,t,i){if(i)return!1;for(var module=f[e]||[],n=0,r=module.length;r>n;n++)if(module[n]===t)return!0;return!1}function n(e){var t=e.type;if(r(h,t)){var i=e.moduleName;f[i]=f[i]||[],f[i].push(t)}}function r(e,t){for(var i=0,n=e.length;n>i;i++)if(e[i]===t)return!0;return!1}var o,a,s,exports={},l="http://sc.qiao.baidu.com",u="/newbridge/setting.gif",c=require("./config"),d=window.loadBegin,f={},h=c.logOnce,p=c.sigleData;return exports.sendLog=function(e){if(!i(e.m,e.t,e.i)&&e.m){exports.send(e);var t={moduleName:e.m,type:e.t};if(!e.i)n(t)}},exports.send=function(e){var t=[];for(var i in e)if(e.hasOwnProperty(i))t.push(i+"="+e[i]);t.push("time="+ +new Date);var n=document.createElement("img");n.src=l+u+"?"+t.join("&")},exports.getData=function(){a=e()},exports.resData=function(){if(a)exports.sendLog({m:o,t:"data",v:e()-a}),a=0},exports.getSingleData=function(){s=e()},exports.resSingleData=function(){if(t(p,arguments[0])&&s)exports.sendLog({m:o,t:"data",i:arguments[0],v:e()-s})},exports.setLoadBegin=function(){if(!d)d=e()},exports.loaded=function(){if(d)exports.sendLog({m:o,t:"load",v:e()-d}),d=0},exports.pageLoad=function(){var e=window.performance;if(e){var t=e.timing;exports.sendLog({m:o,t:"load",v:t.loadEventStart-t.navigationStart})}},exports.init=function(e){o=e,exports.setLoadBegin()},exports}),define("log",["log/main"],function(e){return e}),define("er/Model",["require","./util","./Deferred","log/main","mini-event/EventTarget"],function(require){function e(e,t){function i(i){if(d.resSingleData(t.name),t.dump)e.fill(i,c);else e.set(t.name,i,c);return{success:!0,name:t.name,options:t,value:i}}function n(e){return{success:!1,name:t.name,options:t,error:e}}try{var r=t.retrieve(e,t);if(u.isPromise(r)){if("function"==typeof r.abort)e.addPendingWorker(r);return r.then(i,function(t){t=n(t);try{var r=e.handleError(t);return i(r)}catch(o){if(o.success===!1)throw o;else throw n(o)}})}else{var o=i(r);return u.resolved(o)}}catch(a){var s=n(a);return u.rejected(s)}}function t(e,t){for(var i=u.resolved(),r=0;r<t.length;r++){var o=t[r],a=l.bind(n,null,e,o);i=i.then(a)}return i}function i(e,t){var i=[];for(var r in t)if(t.hasOwnProperty(r)){var o=t[r];if("function"==typeof o)o={retrieve:o,name:r};else if("function"==typeof o.retrieve)o=l.mix({name:r},o);i.push(n(e,o))}return u.all(i)}function n(n,r){if(d.getSingleData(),!r)return u.resolved();if("function"==typeof r){var o={retrieve:r,dump:!0};return e(n,o)}if(r instanceof Array)return t(n,r);if("function"==typeof r.retrieve)return e(n,r);else return i(n,r)}function r(e){if(this.store={},this.pendingWorkers=[],e)this.fill(e,c);this.initialize(),d.getData()}function o(e,t){for(var i=0;i<e.pendingWorkers.length;i++)if(e.pendingWorkers[i]===t)return void e.pendingWorkers.splice(i,1)}function a(){function e(e){var t={success:!1,name:"$prepare",options:{},error:e};throw t}try{var t=this.prepare();if(u.isPromise(t))return t.fail(e);else return t}catch(i){e(i)}}function s(e,t,i){var n=e.store.hasOwnProperty(t)?"change":"add",r=e.store[t];if(e.store[t]=i,r!==i)return{type:n,name:t,oldValue:r,newValue:i};else return null}var l=require("./util"),u=require("./Deferred"),c={silent:!0},d=require("log/main"),f=require("mini-event/EventTarget");return r.prototype.initialize=l.noop,r.prototype.addPendingWorker=function(e){this.pendingWorkers.push(e),e.ensure(l.bind(o,null,this,e))},r.prototype.datasource=null,r.prototype.getDatasource=function(){return this.datasource},r.prototype.load=function(){try{var e=this.getDatasource(),t=n(this,e);return t.then(l.bind(a,this))}catch(i){return u.rejected(i)}},r.prototype.prepare=l.noop,r.prototype.get=function(e){return this.store[e]},r.prototype.set=function(e,t,i){i=i||{};var n=s(this,e,t);if(n&&!i.silent){var r={changes:[n]};this.fire("change",r)}return t},r.prototype.fill=function(e,t){t=t||{};var i=[];for(var n in e)if(e.hasOwnProperty(n)){var r=s(this,n,e[n]);if(r)i.push(r)}if(i.length&&!t.silent){var o={changes:i};this.fire("change",o)}return e},r.prototype.remove=function(e,t){if(this.store.hasOwnProperty(e)){t=t||{};var i=this.store[e];if(delete this.store[e],!t.silent){var n={changes:[{type:"remove",name:e,oldValue:i,newValue:void 0}]};this.fire("change",n)}return i}},r.prototype.getAsModel=function(e){var t=this.get(e);if(!t||"[object Object]"!=={}.toString.call(t))return new r;else return new r(t)},r.prototype.dump=function(){return l.mix({},this.store)},r.prototype.has=function(e){return this.store.hasOwnProperty(e)},r.prototype.hasValue=function(e){return this.has(e)&&null!=this.store[e]},r.prototype.hasReadableValue=function(e){return this.hasValue(e)&&""!==this.store[e]},r.prototype.valueOf=function(){return this.dump()},r.prototype.clone=function(){return new r(this.store)},r.prototype.handleError=function(e){throw e},r.prototype.dispose=function(){for(var e=0;e<this.pendingWorkers.length;e++){var t=this.pendingWorkers[e];if("function"==typeof t.abort)try{t.abort()}catch(i){}}this.pendingWorkers=null},l.inherits(r,f),r}),void function(e){e("eoo/oo",[],function(){function e(){return e.create.apply(e,Array.prototype.slice.call(arguments))}function t(t){var i=function(){return i.prototype.constructor.apply(this,arguments)};o.prototype=t.prototype;var n=i.prototype=new o;if(n.$self=i,i.$superClass=t,!("$super"in n))n.$super=e.prototype.$super;return i}function i(e,t){for(var i in e)n(e,i)&&t(e[i],i,e);if(l)for(var r=u.length-1;r>-1;--r){var o=u[r];n(e,o)&&t(e[o],o,e)}}function n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function r(){return this.prototype.constructor.toString()}var o=function(){},a="__name__",s="__owner__";e.create=function(n,o){if(o=o||{},n=n||e,"object"==typeof n)o=n,n=e;var l=t(n),u=l.prototype;return i(o,function(e,t){if("function"==typeof e)e[a]=t,e[s]=l;u[t]=e}),l.toString=r,l},e["static"]="function"==typeof Object.create?Object.create:function(e){if(arguments.length>1)throw Error("Second argument not supported");if("object"!=typeof e)throw TypeError("Argument must be an object");return o.prototype=e,new o},e.toString=function(){return"function Class() { [native code] }"},e.prototype={constructor:function(){},$self:e,$superClass:Object,$super:function(e){var t=this.$super.caller,i=t.__name__,n=t.__owner__.$superClass,r=n.prototype[i];if("function"!=typeof r)throw"Call the super class's "+i+", but it is not a function!";return r.apply(this,e)}};var l=!{toString:1}.propertyIsEnumerable("toString"),u=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toString","toLocaleString","valueOf"];return e})}("function"==typeof define&&define.amd?define:function(e){module.exports=e(require)}),define("eoo",["eoo/oo"],function(e){return e}),define("ef/UIModel",["require","er/Model","eoo"],function(require){function e(e){return e+="",1===e.length?"0"+e:e}var t=require("er/Model"),exports={},i={date:function(t){return t.getFullYear()+"-"+e(t.getMonth()+1)+"-"+e(t.getDate())},dateRange:function(e){return i.date(e.begin)+","+i.date(e.end)},time:function(t){return i.date(t)+" "+e(t.getHours())+":"+e(t.getMinutes())+":"+e(t.getSeconds())},timeRange:function(e){return i.time(e.begin)+","+i.time(e.end)}};exports.formatters={},exports.set=function(e,t,i){if(this.formatters.hasOwnProperty(e))t=this.formatters[e](t);this.$super([e,t,i])},exports.fill=function(e,t){for(var i in e)if(e.hasOwnProperty(i)&&this.formatters.hasOwnProperty(i)){var n=this.formatters[i],r=e[i];e[i]=n(r)}this.$super(arguments)},exports.getPart=function(e){if("[object Array]"!==Object.prototype.toString.call(e))e=[].slice.call(arguments);for(var t={},i=0;i<e.length;i++){var n=e[i];t[n]=this.get(n)}return t};var n=require("eoo").create(t,exports);return n.formatters=i,n}),define("newstyleManage/messageBoardCMS/MessageBoardCMSModel",["require","ef/UIModel","er/util"],function(require){function e(){t.apply(this,arguments)}var t=require("ef/UIModel"),i=require("er/util");return e.prototype.prepare=function(){var e=this,t=e.get("itemData");if(t)e.set("itemData",JSON.parse(t));else e.set("itemData",{subItems:[]});var i="select"===e.get("type");if(i)e.makePadding(),e.set("validItemLen",this.getValidItemsLen())},e.prototype.makePadding=function(){var e=this,t=4,i=e.get("itemData");!i.subItems[0]&&(i.subItems[0]=""),!i.subItems[1]&&(i.subItems[1]="");var n,r=i.subItems.length,o=t-r;for(n=0;o>n;n++)i.subItems.push(null)},e.prototype.getValidItemsLen=function(){return this.get("itemData").subItems.filter(function(e){return null!==e}).length},i.inherits(e,t),e}),function(e){function t(e,t){for(var i in t)if(t.hasOwnProperty(i))e[i]=t[i];return e}function i(){this.raw=[],this.length=0}function n(){return"___"+A++}function r(e,t){var i=new Function;i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e}function o(e){return k[e]}function a(e){return'"'+e.replace(/\x5C/g,"\\\\").replace(/"/g,'\\"').replace(/\x0A/g,"\\n").replace(/\x09/g,"\\t").replace(/\x0D/g,"\\r")+'"'}function s(e){var t=arguments;return e.replace(/\{([0-9]+)\}/g,function(e,i){return t[i-0+1]})}function l(e){return e=e.replace(/^\s*\*/,""),s('gv({0},["{1}"])',a(e),e.replace(/\[['"]?([^'"]+)['"]?\]/g,function(e,t){return"."+t}).split(".").join('","'))}function u(e,t,i,n,r,o){for(var a=i.length,s=e.split(t),l=0,u=[],c=0,d=s.length;d>c;c++){var f=s[c];if(c){var h=1;for(l++;;){var p=f.indexOf(i);if(0>p){u.push(l>1&&h?t:"",f);break}if(l=n?l-1:0,u.push(l>0&&h?t:"",f.slice(0,p),l>0?i:""),f=f.slice(p+a),h=0,0===l)break}if(0===l)r(u.join("")),o(f),u=[]}else f&&o(f)}if(l>0&&u.length>0)o(t),o(u.join(""))}function c(e,t,i){var n,r=[],o=t.options,s="",d="",f="",h="";if(i)s="ts(",d=")",f=N,h=R,n=o.defaultFilter;return u(e,o.variableOpen,o.variableClose,1,function(e){if(i&&e.indexOf("|")<0&&n)e+="|"+n;var o=e.indexOf("|"),a=(o>0?e.slice(0,o):e).replace(/^\s+/,"").replace(/\s+$/,""),u=o>0?e.slice(o+1):"",p=0===a.indexOf("*"),g=[p?"":s,l(a),p?"":d];if(u){u=c(u,t);for(var v=u.split("|"),m=0,y=v.length;y>m;m++){var b=v[m];if(/^\s*([a-z0-9_-]+)(\((.*)\))?\s*$/i.test(b)){if(g.unshift('fs["'+RegExp.$1+'"]('),RegExp.$3)g.push(",",RegExp.$3);g.push(")")}}}r.push(f,g.join(""),h)},function(e){r.push(f,i?a(e):e,h)}),r.join("")}function d(e,t){this.value=e,this.engine=t}function f(e,t){this.value=e,this.engine=t,this.children=[]}function h(e,t){var i=e.stack,n=t?i.find(function(e){return e instanceof t}):i.bottom();if(n){var r;do{if(r=i.top(),!r.autoClose)throw new Error(r.type+" must be closed manually: "+r.value);r.autoClose(e)}while(r!==n)}return n}function p(e,t){if(!/^\s*([a-z0-9_-]+)\s*(\(\s*master\s*=\s*([a-z0-9_-]+)\s*\))?\s*/i.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.master=RegExp.$3,this.name=RegExp.$1,f.call(this,e,t),this.contents={}}function g(e,t){if(!/^\s*([a-z0-9_-]+)\s*(\(\s*master\s*=\s*([a-z0-9_-]+)\s*\))?\s*/i.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.master=RegExp.$3,this.name=RegExp.$1,f.call(this,e,t),this.contents={}}function v(e,t){if(!/^\s*([a-z0-9_-]+)\s*$/i.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.name=RegExp.$1,f.call(this,e,t)}function m(e,t){if(!/^\s*([a-z0-9_-]+)\s*$/i.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.name=RegExp.$1,f.call(this,e,t)}function y(e,t){if(!/^\s*([a-z0-9_-]+)\s*$/i.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.name=RegExp.$1,f.call(this,e,t)}function b(e,t){if(!/^\s*([a-z0-9_]+)\s*=([\s\S]*)$/i.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.name=RegExp.$1,this.expr=RegExp.$2,f.call(this,e,t)}function w(e,t){if(!/^\s*([a-z0-9_-]+)\s*(\(([\s\S]*)\))?\s*$/i.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.name=RegExp.$1,this.args=RegExp.$3,f.call(this,e,t)}function x(e,t){if(!/^\s*([a-z0-9_-]+)\s*(\(([\s\S]*)\))?\s*$/i.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.name=RegExp.$1,this.args=RegExp.$3,f.call(this,e,t)}function C(e,t){if(!/^\s*(\$\{[\s\S]+\})\s+as\s+\$\{([0-9a-z_]+)\}\s*(,\s*\$\{([0-9a-z_]+)\})?\s*$/i.test(e))throw new Error("Invalid "+this.type+" syntax: "+e);this.list=RegExp.$1,this.item=RegExp.$2,this.index=RegExp.$4,f.call(this,e,t)}function E(e,t){f.call(this,e,t)}function P(e,t){E.call(this,e,t)}function T(e,t){f.call(this,e,t)}function S(e,t){t.targetOrMaster=e;var i=t.engine,n=e.name,r=e instanceof p,o=r?"targets":"masters";if(i[o][n])switch(i.options.namingConflict){case"override":i[o][n]=e,r&&t.targets.push(n);case"ignore":break;default:throw new Error((r?"Target":"Master")+" is exists: "+n)}else i[o][n]=e,r&&t.targets.push(n)}function I(e,t){H[e]=t,t.prototype.type=e}function D(e){this.options={commandOpen:"<!--",commandClose:"-->",variableOpen:"${",variableClose:"}",defaultFilter:"html"},this.config(e),this.masters={},this.targets={},this.filters=t({},L)}function O(e,t){function n(){if(p.length>0){var e=p.join(""),i=new d(e,t);if(i.beforeAdd(c),l.top().addTextNode(i),p=[],t.options.strip&&c.current instanceof f)i.value=e.replace(/^[\x20\t\r]*\n/,"");c.current=i}}function r(e){return e instanceof o}var o,a=t.options.commandOpen,s=t.options.commandClose,l=new i,c={engine:t,targets:[],stack:l},p=[];return u(e,a,s,0,function(e){var i=/^\s*(\/)?([a-z]+)\s*(:([\s\S]*))?$/.exec(e);if(i&&(o=H[i[2].toLowerCase()])&&"function"==typeof o){n();var u=c.current;if(t.options.strip&&u instanceof d)u.value=u.value.replace(/\r?\n[\x20\t]*$/,"\n");if(i[1])u=l.find(r),u&&u.close(c);else{if(u=new o(i[4],t),"function"==typeof u.beforeOpen)u.beforeOpen(c);u.open(c)}c.current=u}else if(!/^\s*\/\//.test(e))p.push(a,e,s);o=null},function(e){p.push(e)}),n(),h(c),c.targets}i.prototype={push:function(e){this.raw[this.length++]=e},pop:function(){if(this.length>0){var e=this.raw[--this.length];return this.raw.length=this.length,e}},top:function(){return this.raw[this.length-1]},bottom:function(){return this.raw[0]},find:function(e){for(var t=this.length;t--;){var i=this.raw[t];if(e(i))return i}}};var A=178245,k={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},L={html:function(e){return e.replace(/[&<>"']/g,o)},url:encodeURIComponent,raw:function(e){return e}},M='var r="";',N="r+=",R=";",B="return r;";if("undefined"!=typeof navigator&&/msie\s*([0-9]+)/i.test(navigator.userAgent)&&RegExp.$1-0<8)M="var r=[],ri=0;",N="r[ri++]=",B='return r.join("");';d.prototype={getRendererBody:function(){var e=this.value,t=this.engine.options;if(!e||t.strip&&/^\s*$/.test(e))return"";else return c(e,this.engine,1)},getContent:function(){return this.value}},f.prototype={addChild:function(e){this.children.push(e)},open:function(e){var t=e.stack.top();this.parent=t,t&&t.addChild(this),e.stack.push(this)},close:function(e){for(;e.stack.pop().constructor!==this.constructor;);},addTextNode:function(e){this.addChild(e)},getRendererBody:function(){for(var e=[],t=this.children,i=0;i<t.length;i++)e.push(t[i].getRendererBody());return e.join("")}};var V='data=data||{};var v={},fs=engine.filters,hg=typeof data.get=="function",gv=function(n,ps){var p=ps[0],d=v[p];if(d==null){if(hg){return data.get(n);}d=data[p];}for(var i=1,l=ps.length;i<l;i++)if(d!=null)d = d[ps[i]];return d;},ts=function(s){if(typeof s==="string"){return s;}if(s==null){s="";}return ""+s;};';r(p,f),r(g,f),r(v,f),r(m,f),r(y,f),r(b,f),r(w,f),r(x,f),r(C,f),r(E,f),r(P,E),r(T,f);var $={READING:1,READED:2,APPLIED:3,READY:4};g.prototype.close=g.prototype.autoClose=p.prototype.close=p.prototype.autoClose=function(e){f.prototype.close.call(this,e),this.state=this.master?$.READED:$.APPLIED,e.targetOrMaster=null},p.prototype.applyMaster=g.prototype.applyMaster=function(){if(this.state>=$.APPLIED)return 1;var e=this.engine.masters[this.master];if(e&&e.applyMaster()){this.children=[];for(var t=0,i=e.children.length;i>t;t++){var n=e.children[t];if(n instanceof m)this.children.push.apply(this.children,(this.contents[n.name]||n).children);else this.children.push(n)}return this.state=$.APPLIED,1}},p.prototype.isReady=function(){function e(n){for(var r=0,o=n.children.length;o>r;r++){var a=n.children[r];if(a instanceof y){var s=t.targets[a.name];i=i&&s&&s.isReady(t)}else if(a instanceof f)e(a)}}if(this.state>=$.READY)return 1;var t=this.engine,i=1;if(this.applyMaster())return e(this),i&&(this.state=$.READY),i;else return void 0},p.prototype.getRenderer=function(){if(this.renderer)return this.renderer;if(this.isReady()){var e=new Function("data","engine",[V,M,this.getRendererBody(),B].join("\n")),t=this.engine;return this.renderer=function(i){return e(i,t)},this.renderer}return null},p.prototype.getContent=function(){if(this.isReady()){for(var e=[],t=this.children,i=0;i<t.length;i++)e.push(t[i].getContent());return e.join("")}return""},p.prototype.open=g.prototype.open=function(e){h(e),f.prototype.open.call(this,e),this.state=$.READING,S(this,e)},y.prototype.open=b.prototype.open=x.prototype.open=function(e){var t=e.stack.top();this.parent=t,t.addChild(this)},x.prototype.beforeOpen=y.prototype.beforeOpen=b.prototype.beforeOpen=C.prototype.beforeOpen=w.prototype.beforeOpen=E.prototype.beforeOpen=d.prototype.beforeAdd=function(e){if(!e.stack.bottom()){var t=new p(n(),e.engine);t.open(e)}},x.prototype.close=y.prototype.close=T.prototype.close=b.prototype.close=function(){},y.prototype.getContent=function(){var e=this.engine.targets[this.name];return e.getContent()},y.prototype.getRendererBody=function(){var e=this.engine.targets[this.name];return e.getRendererBody()},x.prototype.getRendererBody=function(){return s("{0}engine.render({2},{{3}}){1}",N,R,a(this.name),c(this.args,this.engine).replace(/(^|,)\s*([a-z0-9_]+)\s*=/gi,function(e,t,i){return(t||"")+a(i)+":"}))},b.prototype.getRendererBody=function(){if(this.expr)return s("v[{0}]={1};",a(this.name),c(this.expr,this.engine));else return""},E.prototype.getRendererBody=function(){var e=s("if({0}){{1}}",c(this.value,this.engine),f.prototype.getRendererBody.call(this)),t=this["else"];if(t)return[e,s("else{{0}}",t.getRendererBody())].join("");else return e},C.prototype.getRendererBody=function(){return s('var {0}={1};if({0} instanceof Array)for (var {4}=0,{5}={0}.length;{4}<{5};{4}++){v[{2}]={4};v[{3}]={0}[{4}];{6}}else if(typeof {0}==="object")for(var {4} in {0}){v[{2}]={4};v[{3}]={0}[{4}];{6}}',n(),c(this.list,this.engine),a(this.index||n()),a(this.item),n(),n(),f.prototype.getRendererBody.call(this))},w.prototype.getRendererBody=function(){var e=this.args;return s("{2}fs[{5}]((function(){{0}{4}{1}})(){6}){3}",M,B,N,R,f.prototype.getRendererBody.call(this),a(this.name),e?","+c(e,this.engine):"")},v.prototype.open=function(e){h(e,v),f.prototype.open.call(this,e),e.targetOrMaster.contents[this.name]=this},m.prototype.open=function(e){h(e,m),f.prototype.open.call(this,e)},v.prototype.autoClose=E.prototype.autoClose=f.prototype.close,m.prototype.autoClose=function(e){var t=this.parent.children;t.push.apply(t,this.children),this.children.length=0,this.close(e)},E.prototype.addChild=function(e){var t=this["else"];(t?t.children:this.children).push(e)},P.prototype.open=function(e){var t=new T;t.open(e);var i=h(e,E);i.addChild(this),e.stack.push(this)},T.prototype.open=function(e){var t=h(e,E);t["else"]=this,e.stack.push(t)};var H={};I("target",p),I("master",g),I("content",v),I("contentplaceholder",m),I("import",y),I("use",x),I("var",b),I("for",C),I("if",E),I("elif",P),I("else",T),I("filter",w),D.prototype.config=function(e){t(this.options,e)},D.prototype.compile=D.prototype.parse=function(e){if(e){var t=O(e,this);if(t.length)return this.targets[t[0]].getRenderer()}return new Function('return ""')},D.prototype.getRenderer=function(e){var t=this.targets[e];if(t)return t.getRenderer();else return void 0},D.prototype.get=function(e){var t=this.targets[e];if(t)return t.getContent();else return""},D.prototype.render=function(e,t){var i=this.getRenderer(e);if(i)return i(t);else return""},D.prototype.addFilter=function(e,t){if("function"==typeof t)this.filters[e]=t};var j=new D;if(j.Engine=D,"object"==typeof exports&&"object"==typeof module)exports=module.exports=j;else if("function"==typeof define&&define.amd)define("etpl/main",[],j);else e.etpl=j}(this),define("etpl",["etpl/main"],function(e){return e}),define("er/View",["require","./util","mini-event/EventTarget","./Model","etpl"],function(require){function e(){this.initialize()}var t=require("./util"),i=require("mini-event/EventTarget");return e.prototype.initialize=t.noop,e.prototype.template="",e.prototype.getTemplateName=function(){return this.template||""},e.prototype.model=null,e.prototype.container="",e.prototype.getContainerElement=function(){return t.getElement(this.container)||null},e.prototype.getTemplateData=function(){var e=this.model;if(e&&"function"!=typeof e.get){var t=require("./Model");e=new t(e)}var i=function(t){for(var i=t.replace(/\[(\d+)\]/g,".$1").split("."),n=i.shift(),r=e.get(n);r&&(n=i.shift());)r=r[n];return r};return{get:i,relatedModel:e}},e.prototype.render=function(){var e=this.getContainerElement();if(!e){var t=this.model&&"function"==typeof this.model.get&&this.model.get("url");throw new Error("Container not found when rendering "+(t?'"'+t+'"':"view"))}var i=require("etpl"),n=i.render(this.getTemplateName(),this.getTemplateData());e.innerHTML=n,this.enterDocument()},e.prototype.enterDocument=require("./util").noop,e.prototype.dispose=function(){var e=this.getContainerElement();e&&(e.innerHTML="")},require("./util").inherits(e,i),e}),define("esui/lib/string",["require","underscore"],function(require){var e=require("underscore"),t={},i=/^[\s\xa0\u3000]+|[\u3000\xa0\s]+$/g;return t.trim=function(e){if(!e)return"";else return String(e).replace(i,"")},t.format=function(e,t){if(!e)return"";if(null==t)return e;else return e.replace(/\$\{(.+?)\}/g,function(e,i){var n=t[i];if("function"==typeof n)n=n(i);return null==n?"":n})},t.camelize=function(e){if(!e)return"";else return e.replace(/-([a-z])/g,function(e){return e.toUpperCase()})},t.pascalize=function(e){if(!e)return"";else return e.charAt(0).toUpperCase()+t.camelize(e.slice(1))},t.splitTokenList=function(i){if(!i)return[];if(!e.isArray(i))return e.chain(i.split(/[,\s]/)).map(t.trim).compact().value()},t}),define("esui/lib/dom",["require","underscore","./string"],function(require){var e=require("underscore"),t=require("./string"),i={};return i.g=function(e){if(!e)return null;else return"string"==typeof e?document.getElementById(e):e},i.isInput=function(e){var t=e.nodeName.toLowerCase();return"input"===t||"select"===t||"textarea"===t},i.removeNode=function(e){if("string"==typeof e)e=i.g(e);if(e){var t=e.parentNode;if(t)t.removeChild(e)}},i.insertAfter=function(e,t){var i=t.parentNode;if(i)i.insertBefore(e,t.nextSibling);return e},i.insertBefore=function(e,t){var i=t.parentNode;if(i)i.insertBefore(e,t);return e},i.getChildren=function(t){return e.filter(t.children,function(e){return 1===e.nodeType})},i.getComputedStyle=function(e,t){if(!e)return"";var i=9==e.nodeType?e:e.ownerDocument||e.document;if(i.defaultView&&i.defaultView.getComputedStyle){var n=i.defaultView.getComputedStyle(e,null);if(n)return n[t]||n.getPropertyValue(t)}else if(e&&e.currentStyle)return e.currentStyle[t];return""},i.getStyle=function(e,n){return n=t.camelize(n),e.style[n]||(e.currentStyle?e.currentStyle[n]:"")||i.getComputedStyle(e,n)},i.getOffset=function(e){var t=e.getBoundingClientRect(),i={top:t.top,right:t.right,bottom:t.bottom,left:t.left,width:t.right-t.left,height:t.bottom-t.top},n=document.documentElement.clientTop||document.body.clientTop||0,r=document.documentElement.clientLeft||document.body.clientLeft||0,o=window.pageYOffset||document.documentElement.scrollTop,a=window.pageXOffset||document.documentElement.scrollLeft;return i.top=i.top+o-n,i.bottom=i.bottom+o-n,i.left=i.left+a-r,i.right=i.right+a-r,i},i.getText=function(t){var n="";if(3===t.nodeType||4===t.nodeType)n+=t.nodeValue;else if(8!==t.nodeType)e.each(t.childNodes,function(e){n+=i.getText(e)});return n},i.dom={},i.dom.first=function(e){if(e=i.g(e),e.firstElementChild)return e.firstElementChild;for(var t=e.firstChild;t;t=t.nextSibling)if(1==t.nodeType)return t;return null},i.dom.last=function(e){if(e=i.g(e),e.lastElementChild)return e.lastElementChild;for(var t=e.lastChild;t;t=t.previousSibling)if(1===t.nodeType)return t;return null},i.dom.next=function(e){if(e=i.g(e),e.nextElementSibling)return e.nextElementSibling;for(var t=e.nextSibling;t;t=t.nextSibling)if(1==t.nodeType)return t;return null},i.dom.contains=function(e,t){return e=i.g(e),t=i.g(t),e.contains?e!=t&&e.contains(t):!!(16&e.compareDocumentPosition(t))},i}),define("esui/lib/attribute",["require","./dom"],function(require){var e=require("./dom"),t={};t.hasAttribute=function(e,t){if(e.hasAttribute)return e.hasAttribute(t);else return e.attributes&&e.attributes[t]&&e.attributes[t].specified};var i=function(){var e={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",rowspan:"rowSpan",valign:"vAlign",usemap:"useMap",frameborder:"frameBorder"},t=document.createElement("div");t.innerHTML='<label for="test" class="test"></label>';var i=t.getElementsByTagName("label")[0];if("test"===i.getAttribute("className"))e["class"]="className";else e.className="class";if("test"===i.getAttribute("for"))e.htmlFor="for";else e["for"]="htmlFor";return e}();return t.setAttribute=function(t,n,r){if(t=e.g(t),"style"===n)t.style.cssText=r;else n=i[n]||n,t.setAttribute(n,r);return t},t.getAttribute=function(t,n){if(t=e.g(t),"style"===n)return t.style.cssText;else return n=i[n]||n,t.getAttribute(n)},t.removeAttribute=function(t,n){t=e.g(t),n=i[n]||n,t.removeAttribute(n)},t}),define("esui/lib/class",["require","underscore","./dom"],function(require){function e(e){return e.className?e.className.split(/\s+/):[]}var t=require("underscore"),i=require("./dom"),n={};return n.hasClass=function(n,r){if(n=i.g(n),""===r)throw new Error("className must not be empty");if(!n||!r)return!1;if(n.classList)return n.classList.contains(r);var o=e(n);return t.contains(o,r)},n.addClass=function(n,r){if(n=i.g(n),""===r)throw new Error("className must not be empty");if(!n||!r)return n;if(n.classList)return n.classList.add(r),n;var o=e(n);if(t.contains(o,r))return n;else return o.push(r),n.className=o.join(" "),n},n.addClasses=function(n,r){if(n=i.g(n),!n||!r)return n;if(n.classList)return t.each(r,function(e){n.classList.add(e)}),n;var o=e(n),a=t.union(o,r);if(a.length>o.length)n.className=a.join(" ");return n},n.removeClass=function(t,n){if(t=i.g(t),""===n)throw new Error("className must not be empty");if(!t||!n)return t;if(t.classList)return t.classList.remove(n),t;for(var r=e(t),o=!1,a=0;a<r.length;a++)if(r[a]===n)r.splice(a,1),a--,o=!0;if(o)t.className=r.join(" ");return t},n.removeClasses=function(n,r){if(n=i.g(n),!n||!r)return n;if(n.classList)return t.each(r,function(e){n.classList.remove(e)}),n;var o=e(n),a=t.difference(o,r);if(a.length<o.length)n.className=a.join(" ");return n},n.toggleClass=function(t,n){if(t=i.g(t),""===n)throw new Error("className must not be empty");if(!t||!n)return t;if(t.classList)return t.classList.toggle(n),t;for(var r=e(t),o=!1,a=0;a<r.length;a++)if(r[a]===n)r.splice(a,1),o=!0,a--;if(!o)r.push(n);return t.className=r.join(" "),t},n}),define("esui/lib/date",["require","moment"],function(require){var e=require("moment"),t={};return t.dateFormats=["YYYYMMDDHHmmss","YYYY-MM-DD HH:mm:ss","YYYY/MM/DD HH:mm:ss","YYYY-MM-DDTHH:mm:ss.SSSZ"],t.format=function(t,i){return e(t).format(i)},t.parse=function(i,n){var r=e(i,n||t.dateFormats);return r.toDate()},{date:t}}),define("esui/lib/page",["require"],function(require){var e=document.documentElement,t=document.body,i="BackCompat"==document.compatMode?t:e,n={};return n.getWidth=function(){return Math.max(e?e.scrollWidth:0,t?t.scrollWidth:0,i?i.clientWidth:0,0)},n.getHeight=function(){return Math.max(e?e.scrollHeight:0,t?t.scrollHeight:0,i?i.clientHeight:0,0)},n.getViewWidth=function(){return i?i.clientWidth:0},n.getViewHeight=function(){return i?i.clientHeight:0},n.getScrollTop=function(){return window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0},n.getScrollLeft=function(){return window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0},n.getClientTop=function(){return document.documentElement.clientTop||document.body.clientTop||0},n.getClientLeft=function(){return document.documentElement.clientLeft||document.body.clientLeft||0},{page:n}}),define("esui/lib/event",["require","./dom","./page"],function(require){var e=require("./dom"),t=require("./page").page,i={};return i.preventDefault=function(e){if(e=e||window.event,e.preventDefault)e.preventDefault();else e.returnValue=!1},i.stopPropagation=function(e){if(e=e||window.event,e.stopPropagation)e.stopPropagation();else e.cancelBubble=!0},i.getMousePosition=function(e){if(e=e||window.event,"number"!=typeof e.pageX)e.pageX=e.clientX+t.getScrollLeft()-t.getClientLeft();if("number"!=typeof e.pageY)e.pageY=e.clientY+t.getScrollTop()-t.getClientTop();return e},i.getTarget=function(e){return e=e||window.event,e.target||e.srcElement},{on:function(t,i,n){if(t=e.g(t),t.addEventListener)t.addEventListener(i,n,!1);else if(t.attachEvent)t.attachEvent("on"+i,n)},un:function(t,i,n){if(t=e.g(t),t.addEventListener)t.removeEventListener(i,n,!1);else if(t.attachEvent)t.detachEvent("on"+i,n)},event:i}}),define("esui/lib/lang",["require","underscore"],function(require){var e=require("underscore"),t={},i=8785925;return t.getGUID=function(e){return e=e||"esui",e+i++},t.inherits=function(e,t){var i=function(){};i.prototype=t.prototype;var n=e.prototype,r=e.prototype=new i;for(var o in n)r[o]=n[o];return e.prototype.constructor=e,e.superClass=t.prototype,e},t.deepClone=function(i){if(!e.isObject(i)||e.isFunction(i)||e.isRegExp(i))return i;if(e.isArray(i))return e.map(i,t.deepClone);var n={};return e.each(i,function(e,i){n[i]=t.deepClone(e)}),n},t.toDictionary=function(t){var i={};return e.each(t,function(e){i[e]=!0}),i},t.clone=t.deepClone,t.isArray=e.isArray,t.toArray=e.toArray,t.extend=e.extend,t.bind=e.bind,t.curry=e.partial,t.indexOf=e.indexOf,t.decodeHTML=e.unescape,t.encodeHTML=e.escape,t}),define("esui/lib",["require","underscore","./lib/attribute","./lib/class","./lib/date","./lib/dom","./lib/event","./lib/lang","./lib/page","./lib/string"],function(require){var e={},t=require("underscore");if(/msie (\d+\.\d+)/i.test(navigator.userAgent))e.ie=document.documentMode||+RegExp.$1;return t.extend(e,require("./lib/attribute"),require("./lib/class"),require("./lib/date"),require("./lib/dom"),require("./lib/event"),require("./lib/lang"),require("./lib/page"),require("./lib/string")),e}),define("esui/ControlCollection",["require","underscore"],function(require){function e(){this.length=0}var t=require("underscore");return e.prototype.splice=Array.prototype.splice,e.prototype.add=function(e){var i=t.indexOf(this,e);if(0>i)[].push.call(this,e)},e.prototype.remove=function(e){for(var t=0;t<this.length;t++)if(this[t]===e)return void[].splice.call(this,t,1)},e.prototype.each=function(e,i){t.each(this,function(t,n){e.call(i||t,t,n,this)})},e.prototype.invoke=function(e){var i=[this];return i.push.apply(i,arguments),t.invoke.apply(t,i)},t.each(["enable","disable","setDisabled","show","hide","toggle","addChild","removeChild","set","setProperties","addState","removeState","toggleState","on","off","fire","dispose","destroy","setViewContext","render","repaint","appendTo","insertBefore"],function(t){e.prototype[t]=function(){var e=[t];e.push.apply(e,arguments);var i=this.invoke.apply(this,e);return i&&i[0]}}),t.each(["isDisabled","isHidden","hasState","get","getCategory","getChild","getChildSafely"],function(t){e.prototype[t]=function(){var e=this[0];return e?e[t].apply(e,arguments):void 0}}),e}),define("esui/SafeWrapper",["require","underscore"],function(require){
function e(){}var t=require("underscore");return t.each(["enable","disable","setDisabled","show","hide","toggle","setValue","setRawValue","addChild","removeChild","set","addState","removeState","toggleState","on","off","fire","dispose","destroy","initOptions","createMain","initStructure","setViewContext","render","repaint","appendTo","insertBefore","initChildren","disposeChildren"],function(t){e.prototype[t]=function(){}}),t.each(["isDisabled","isHidden","hasState","isPropertyChanged"],function(t){e.prototype[t]=function(){return!1}}),t.each(["getRawValue","getChild","get"],function(t){e.prototype[t]=function(){return null}}),t.each(["getValue"],function(t){e.prototype[t]=function(){return""}}),t.each(["setProperties"],function(t){e.prototype[t]=function(){return{}}}),e.prototype.getCategory=function(){return"control"},e.prototype.getChildSafely=function(t){var i=new e;if(i.childName=t,i.parent=this,this.viewContext)i.viewContext=this.viewContext;return i},e}),define("esui/ViewContext",["require","./ControlCollection","./lib","./SafeWrapper"],function(require){function e(e){a.apply(this,arguments),this.name=e}function t(e,t){a.prototype.add.call(t,e)}function i(e,t){a.prototype.remove.call(t,e)}function n(e){var t=e.get("group");return t?t.split(/[\t\r\n ]/):[]}function r(){return"vt"+s++}function o(e){if(this.controls={},this.groups={},e=e||r(),l.hasOwnProperty(e)){for(var t=1,i=e+"-";l.hasOwnProperty(i+t);)t++;e=i+t}this.id=e,l[this.id]=this}var a=require("./ControlCollection");require("./lib").inherits(e,a),e.prototype.add=void 0,e.prototype.remove=void 0,e.prototype.disposeGroup=function(){for(var e=0;e<this.length;e++)delete this[e];this.length=0};var s=8587523,l={};o.get=function(e){return l[e]||null},o.prototype.add=function(e){var i=this.controls[e.id];if(i){if(i===e)return;i.setViewContext(null)}this.controls[e.id]=e;for(var r=n(e),o=0;o<r.length;o++){var a=r[o];if(a){var s=this.getGroup(a);t(e,s)}else;}e.setViewContext(this)},o.prototype.remove=function(e){delete this.controls[e.id];for(var t=n(e),r=0;r<t.length;r++){var o=t[r];if(o){var a=this.getGroup(o);i(e,a)}else;}e.setViewContext(null)},o.prototype.get=function(e){return this.controls[e]};var u=require("./SafeWrapper");return o.prototype.getSafely=function(e){var t=this.get(e);if(!t)t=new u,t.id=e,t.viewContext=this;return t},o.prototype.getGroup=function(t){if(!t)throw new Error("name is unspecified");var i=this.groups[t];if(!i)i=this.groups[t]=new e(t);return i},o.prototype.clean=function(){for(var e in this.controls)if(this.controls.hasOwnProperty(e)){var t=this.controls[e];if(t.dispose(),t.viewContext&&t.viewContext===this)this.remove(t)}for(var i in this.groups)if(this.groups.hasOwnProperty(i))this.groups[i].disposeGroup(),this.groups[i]=void 0},o.prototype.dispose=function(){this.clean(),delete l[this.id]},o}),define("esui/main",["require","./lib","./ViewContext","./ControlCollection"],function(require){function e(e,t){if("function"==typeof e){var i=e.prototype.type;if(i in t)throw new Error(i+" is exists!");t[i]=e}}function t(e,t,i){var n=i[e];if(n)return delete t.type,new n(t);else return null}var i=require("./lib"),n={};n.version="3.1.0-beta.3";var r=require("./ViewContext"),o=new r("default");n.getViewContext=function(){return o};var a={uiPrefix:"data-ui",extensionPrefix:"data-ui-extension",customElementPrefix:"esui",instanceAttr:"data-ctrl-id",viewContextAttr:"data-ctrl-view-context",uiClassPrefix:"ui",skinClassPrefix:"skin",stateClassPrefix:"state"};n.config=function(e){i.extend(a,e)},n.getConfig=function(e){return a[e]},n.parseAttribute=function(e,t){if(!e)return{};for(var n={},r=0,o=0;o<e.length;){for(;o<e.length&&":"!==e.charAt(o);)o++;if(o>=e.length)break;var a=i.trim(e.slice(r,o));for(o++,r=o;o<e.length&&";"!==e.charAt(o);)o++;for(var s=o+1;s<e.length;){var l=e.charAt(s);if(";"===l)o=s;if(":"===l)break;s++}var u=i.trim(e.slice(r,o));n[a]=t?t(u):u,o++,r=o}return n},n.getControlByDOM=function(e){if(!e)return null;var t,i=n.getConfig,o=e.getAttribute(i("instanceAttr")),a=e.getAttribute(i("viewContextAttr"));if(o&&a&&(t=r.get(a)))return t.get(o);else return null};var s={};n.register=function(t){e(t,s)},n.create=function(e,i){return t(e,i,s)},n.get=function(e){return o.get(e)},n.getSafely=function(e){return o.getSafely(e)};var l=require("./ControlCollection");n.wrap=function(){for(var e=new l,t=0;t<arguments.length;t++)e.add(arguments[t]);return e},n.init=function(e,t){function i(e){function t(e){return e.toUpperCase()}for(var i=1,n=e.length;n>i;i++)e[i]=e[i].replace(/^[a-z]/,t);return e.join("")}function r(e,t){for(var i in t)if(!(i in e))e[i]=t[i]}function o(e,t,o){if(0===t.length)r(e,n.parseAttribute(o,s));else e[i(t)]=s(o)}e=e||document.body,t=t||{};for(var s=t.valueReplacer||function(e){return e},l=e.getElementsByTagName("*"),u=[],c=0,d=l.length;d>c;c++)if(1===l[c].nodeType)u.push(l[c]);for(var f=n.getConfig("uiPrefix"),h=n.getConfig("extensionPrefix"),p=n.getConfig("customElementPrefix"),g=f.length,v=h.length,m=t.properties||{},y=[],c=0,d=u.length;d>c;c++){var b=u[c];if(!b.getAttribute(a.instanceAttr)){for(var w=b.attributes,x={},C={},E=0,P=w.length;P>E;E++){var T=w[E],S=T.name,I=T.value;if(0===S.indexOf(h)){var D=S.slice(v+1).split("-"),O=D[0];D.shift();var A=C[O];if(!A)A=C[O]={};o(A,D,I)}else if(0===S.indexOf(f)){var D=S.length==g?[]:S.slice(g+1).split("-");o(x,D,I)}}var k=x.type;if(!k){var L=b.nodeName.toLowerCase(),M=L.indexOf(p);if(0===M){var N=L.replace(/-(\S)/g,function(e,t){return t.toUpperCase()});N=N.slice(p.length),x.type=N,k=N}}if(k){var R=x.id,B=R?m[R]:{};for(var V in B)x[V]=s(B[V]);var $=x.extensions||[];x.extensions=$;for(var V in C){var A=C[V],H=n.createExtension(A.type,A);H&&$.push(H)}x.viewContext=t.viewContext,x.renderOptions=t,x.main=b;var j=n.create(k,x);if(j){if(y.push(j),t.parent)t.parent.addChild(j);try{j.render()}catch(q){var F=new Error('Render control "'+(j.id||"anonymous")+'" of type '+j.type+" failed because: "+q.message);throw F.actualError=q,F}}}}else;}return y};var u={};n.registerExtension=function(t){e(t,u)},n.createExtension=function(e,i){return t(e,i,u)};var c={};n.attachExtension=function(e,t){c[e]=t},n.createGlobalExtensions=function(){for(var e=c,t=[],i=0,r=e.length;r>i;i++){var o,a=e[i],s=a.type;if(s)o=n.create(s,a);o&&t.push(o)}return t};var d=[];return n.registerRule=function(e,t){d.push({type:e,priority:t}),d.sort(function(e,t){return e.priority-t.priority})},n.createRulesByControl=function(e){for(var t=[],i=0;i<d.length;i++){var n=d[i].type;if(null!=e.get(n.prototype.type))t.push(new n)}return t},n}),define("esui",["esui/main"],function(e){return e}),define("esui/painters",["require","underscore","./lib"],function(require){var e=require("underscore"),t=require("./lib"),i={};i.state=function(e){return{name:e,paint:function(e,t){var i=t?"addState":"removeState";e[i](this.name)}}},i.attribute=function(e,t,i){return{name:e,attribute:t||e,value:i,paint:function(e,t){t=null==this.value?t:this.value,e.main.setAttribute(this.attribute,t)}}};var n={width:!0,height:!0,top:!0,right:!0,bottom:!0,left:!0,fontSize:!0,padding:!0,paddingTop:!0,paddingRight:!0,paddingBottom:!0,paddingLeft:!0,margin:!0,marginTop:!0,marginRight:!0,marginBottom:!0,marginLeft:!0,borderWidth:!0,borderTopWidth:!0,borderRightWidth:!0,borderBottomWidth:!0,borderLeftWidth:!0};return i.style=function(e,t){return{name:e,property:t||e,paint:function(e,t){if(null!=t){if(n.hasOwnProperty(this.property))t=0===t?"0":t+"px";e.main.style[this.property]=t}}}},i.html=function(e,t,i){return{name:e,element:t||"",generate:i,paint:function(e,t){var i="function"==typeof this.element?this.element(e):this.element?e.helper.getPart(this.element):e.main;if(i){var n="function"==typeof this.generate?this.generate(e,t):t;i.innerHTML=n||""}}}},i.text=function(t,i,n){return{name:t,element:i||"",generate:n,paint:function(t,i){var n="function"==typeof this.element?this.element(t):this.element?t.helper.getPart(this.element):t.main;if(n){var r="function"==typeof this.generate?this.generate(t,i):i;n.innerHTML=e.escape(r||"")}}}},i.delegate=function(e,t,i){return{name:e,member:this.member,method:this.method,paint:function(e,t){e[this.member][this.method](t)}}},i.createRepaint=function(){var e=[].concat.apply([],[].slice.call(arguments));return function(i,n){for(var r=t.extend({},n),o=0;o<e.length;o++){var a=e[o];if("function"!=typeof a){var s=[].concat(a.name),l=!i;if(!l)for(var u=0;u<s.length;u++){var c=s[u];if(n.hasOwnProperty(c)){l=!0;break}}if(l){for(var d=[this],u=0;u<s.length;u++){var c=s[u];d.push(this[c]),delete r[c]}try{a.paint.apply(a,d)}catch(f){var h='"'+s.join('", "')+'"',p=new Error("Failed to paint ["+h+'] for control "'+(this.id||"anonymous")+'" of type '+this.type+" because: "+f.message);throw p.actualError=p,p}}else;}else a.apply(this,arguments)}var g=[];for(var v in r)if(r.hasOwnProperty(v))g.push(r[v]);return g}},i}),define("esui/helper/children",["require","underscore","../main"],function(require){var e=require("underscore"),t=require("../main"),i={};return i.initChildren=function(i,n){return i=i||this.control.main,n=e.extend({},this.control.renderOptions,n),n.viewContext=this.control.viewContext,n.parent=this.control,t.init(i,n)},i.disposeChildren=function(){var t=this.control.children.slice();e.each(t,function(e){e.dispose()}),this.children=[],this.childrenIndex={}},i.disableChildren=function(){e.each(this.control.children,function(e){e.dispose()})},i.enableChildren=function(){e.each(this.control.children,function(e){e.enable()})},i}),define("esui/helper/dom",["require","underscore","../lib","../main"],function(require){function e(e){var t=e.styleType||e.type;return t.toLowerCase()}function t(){return[].slice.call(arguments,0).join("-")}var i=require("underscore"),n=require("../lib"),r=require("../main"),o={};o.getPartClasses=function(i){if(i&&this.partClassCache&&this.partClassCache.hasOwnProperty(i))return this.partClassCache[i].slice();var n=e(this.control),o=this.control.skin,a=r.getConfig("uiClassPrefix"),s=r.getConfig("skinClassPrefix"),l=[];if(i){if(l.push(t(a,n,i)),o)l.push(t(s,o,n,i));if(!this.partClassCache)this.partClassCache={},this.partClassCache[i]=l.slice()}else if(l.push(t(a,"ctrl")),l.push(t(a,n)),o)l.push(t(s,o),t(s,o,n));return l},o.getPartClassName=function(e){return this.getPartClasses(e).join(" ")},o.getPrimaryClassName=function(i){var n=e(this.control);if(i)return t(r.getConfig("uiClassPrefix"),n,i);else return t(r.getConfig("uiClassPrefix"),n)},o.addPartClasses=function(e,t){if("string"==typeof t)t=this.getPart(t);if(t=t||this.control.main)n.addClasses(t,this.getPartClasses(e))},o.removePartClasses=function(e,t){if("string"==typeof t)t=this.getPart(t);if(t=t||this.control.main)n.removeClasses(t,this.getPartClasses(e))},o.getStateClasses=function(i){if(this.stateClassCache&&this.stateClassCache.hasOwnProperty(i))return this.stateClassCache[i].slice();var n=e(this.control),o=r.getConfig,a=[t(o("uiClassPrefix"),n,i),t(o("stateClassPrefix"),i)],s=this.control.skin;if(s){var l=o("skinClassPrefix");a.push(t(l,s,i),t(l,s,n,i))}if(!this.stateClassCache)this.stateClassCache={},this.stateClassCache[i]=a.slice();return a},o.addStateClasses=function(e){var t=this.control.main;if(t)n.addClasses(t,this.getStateClasses(e))},o.removeStateClasses=function(e){var t=this.control.main;if(t)n.removeClasses(t,this.getStateClasses(e))},o.getId=function(e){if(e=e?"-"+e:"",!this.control.domIDPrefix)this.control.domIDPrefix=this.control.viewContext&&this.control.viewContext.id;var t=this.control.domIDPrefix?this.control.domIDPrefix+"-":"";return"ctrl-"+t+this.control.id+e},o.createPart=function(e,t){t=t||"div";var i=document.createElement(t);return i.id=this.getId(e),this.addPartClasses(e,i),i},o.getPart=function(e){return n.g(this.getId(e))},o.isPart=function(e,t){var i=this.getPartClasses(t)[0];return n.hasClass(e,i)};var a={type:!0,name:!0,alt:!0,autocomplete:!0,autofocus:!0,checked:!0,dirname:!0,disabled:!0,form:!0,formaction:!0,formenctype:!0,formmethod:!0,formnovalidate:!0,formtarget:!0,width:!0,height:!0,inputmode:!0,list:!0,max:!0,maxlength:!0,min:!0,minlength:!0,multiple:!0,pattern:!0,placeholder:!0,readonly:!0,required:!0,size:!0,src:!0,step:!0,value:!0};o.replaceMain=function(e){e=e||this.control.createMain();var t=this.control.main;t.setAttribute(r.getConfig("instanceAttr"),n.getGUID());for(var i=t.attributes,o=0;o<i.length;o++){var s=i[o],l=s.name;if(n.hasAttribute(t,l)&&!a.hasOwnProperty(l))n.setAttribute(e,l,s.value)}return n.insertBefore(e,t),t.parentNode.removeChild(t),this.control.main=e,t};var s={name:{name:"name"},maxlength:{name:"maxLength",type:"number"},required:{name:"required",type:"boolean"},pattern:{name:"pattern"},min:{name:"min",type:"number"},max:{name:"max",type:"number"},autofocus:{name:"autoFocus",type:"boolean"},disabled:{name:"disabled",type:"boolean"},readonly:{name:"readOnly",type:"boolean"}};return o.extractOptionsFromInput=function(e,t){var r={};if(i.each(s,function(t,i){var o=n.hasAttribute(e,i);if(o){var a=n.getAttribute(e,i);switch(t.type){case"boolean":a=o;break;case"number":a=parseInt(a,10)}r[t.name]=a}}),n.hasAttribute(e,"value")||"select"!==e.nodeName.toLowerCase()&&e.value)r.value=e.value;return i.defaults(t||{},r)},o}),define("mini-event/EventQueue",["require","./lib"],function(require){function e(e,t,i){return e&&e.handler===t&&e.thisObject==i}function t(){this.queue=[]}var i=require("./lib");return t.prototype.add=function(t,n){if(t!==!1&&"function"!=typeof t)throw new Error("event handler must be a function or const false");var r={handler:t};i.extend(r,n);for(var o=0;o<this.queue.length;o++){var a=this.queue[o];if(e(a,t,r.thisObject))return}this.queue.push(r)},t.prototype.remove=function(t,i){if(!t)return void this.clear();for(var n=0;n<this.queue.length;n++){var r=this.queue[n];if(e(r,t,i))return void(this.queue[n]=null)}},t.prototype.clear=function(){this.queue.length=0},t.prototype.execute=function(e,t){for(var i=this.queue,n=0;n<i.length;n++){if("function"==typeof e.isImmediatePropagationStopped&&e.isImmediatePropagationStopped())return;var r=i[n];if(r){var o=r.handler;if(o===!1){if("function"==typeof e.preventDefault)e.preventDefault();if("function"==typeof e.stopPropagation)e.stopPropagation()}else o.call(r.thisObject||t,e);if(r.once)this.remove(r.handler)}else;}},t.prototype.getLength=function(){for(var e=0,t=0;t<this.queue.length;t++)if(this.queue[t])e++;return e},t.prototype.length=t.prototype.getLength,t.prototype.dispose=function(){this.clear(),this.queue=null},t}),define("mini-event/Event",["require","./lib"],function(require){function e(){return!0}function t(){return!1}function i(e,t){if("object"==typeof e)t=e,e=t.type;if("object"==typeof t)n.extend(this,t);else if(t)this.data=t;if(e)this.type=e}var n=require("./lib");i.prototype.isDefaultPrevented=t,i.prototype.preventDefault=function(){this.isDefaultPrevented=e},i.prototype.isPropagationStopped=t,i.prototype.stopPropagation=function(){this.isPropagationStopped=e},i.prototype.isImmediatePropagationStopped=t,i.prototype.stopImmediatePropagation=function(){this.isImmediatePropagationStopped=e,this.stopPropagation()};var r=function(){return this}();i.fromDOMEvent=function(e,t,n){e=e||r.event;var o=new i(t,n);return o.preventDefault=function(){if(e.preventDefault)e.preventDefault();else e.returnValue=!1;i.prototype.preventDefault.call(this)},o.stopPropagation=function(){if(e.stopPropagation)e.stopPropagation();else e.cancelBubble=!0;i.prototype.stopPropagation.call(this)},o.stopImmediatePropagation=function(){if(e.stopImmediatePropagation)e.stopImmediatePropagation();i.prototype.stopImmediatePropagation.call(this)},o};var o={type:!0,target:!0,preventDefault:!0,isDefaultPrevented:!0,stopPropagation:!0,isPropagationStopped:!0,stopImmediatePropagation:!0,isImmediatePropagationStopped:!0};return i.fromEvent=function(e,t){var r={type:e.type,preserveData:!1,syncState:!1};t=n.extend(r,t);var a=new i(t.type);if(t.preserveData)for(var s in e)if(e.hasOwnProperty(s)&&!o.hasOwnProperty(s))a[s]=e[s];if(t.extend)n.extend(a,t.extend);if(t.syncState)a.preventDefault=function(){e.preventDefault(),i.prototype.preventDefault.call(this)},a.stopPropagation=function(){e.stopPropagation(),i.prototype.stopPropagation.call(this)},a.stopImmediatePropagation=function(){e.stopImmediatePropagation(),i.prototype.stopImmediatePropagation.call(this)};return a},i.delegate=function(e,t,r,o,a){var s="string"==typeof t,l={object:e,type:s?t:r},u={object:s?r:t,type:s?o:r},c=s?a:o;if(c=n.extend({preserveData:!1},c),"function"==typeof l.object.on&&"function"==typeof u.object.on&&"function"==typeof u.object.fire){var d=function(e){var t=i.fromEvent(e,c);t.type=u.type,t.target=u.object,u.object.fire(u.type,t)};l.object.on(l.type,d)}},i}),define("mini-event/main",["require","./Event"],function(require){var e=require("./Event");return{version:"0.9.0",Event:e,fromDOMEvent:e.fromDOMEvent,fromEvent:e.fromEvent,delegate:e.delegate}}),define("mini-event",["mini-event/main"],function(e){return e}),define("esui/helper/event",["require","underscore","mini-event/EventQueue","../lib","mini-event"],function(require){function e(e){if(e===window)return s.window;if(e===document)return s.document;if(e===document.documentElement)return s.documentElement;if(e===document.body)return s.body;else return null}function t(t,i){var n=e(t);if(n){var r=n[i.type];if(r)l.each(r,function(e){o(e,t,i)})}}function i(e,t){t=t||150;var i=0;return function(n){clearTimeout(i);var r=this;n=n||window.event,n={type:n.type,srcElement:n.srcElement,target:n.target,currentTarget:n.currentTarget},i=setTimeout(function(){e.call(r,n)},t)}}function n(n,r,o){var a=e(o);if(!a)return!1;var s=a[r];if(!s){s=a[r]=[];var u=l.partial(t,o);if("resize"===r||"scroll"===r)u=i(u);s.handler=u,c.on(o,r,s.handler)}if(!(l.indexOf(s,n)>=0))return s.push(n),!0}function r(t,i,n){var r=e(n);if(!r)return!1;if(!r[i])return!0;for(var o=r[i],a=0;a<o.length;a++)if(o[a]===t){o.splice(a,1);break}if(!o.length){var s=o.handler;c.un(n,i,s),r[i]=null}return!0}function o(e,t,i){i=i||window.event;var n=l.any(e.ignoreStates,function(t){return e.hasState(t)});if(!n){if(!i.target)i.target=i.srcElement;if(!i.currentTarget)i.currentTarget=t;if(!i.preventDefault)i.preventDefault=function(){i.returnValue=!1};if(!i.stopPropagation)i.stopPropagation=function(){i.cancelBubble=!0};var r=e.domEvents[i.currentTarget[a]][i.type];if(r)r.execute(i,e)}}var a="_esuiDOMEvent",s={window:{},document:{},documentElement:{},body:{}},l=require("underscore"),u=require("mini-event/EventQueue"),c=require("../lib"),d={};return d.addDOMEvent=function(e,t,i){if("string"==typeof e)e=this.getPart(e);if(!this.control.domEvents)this.control.domEvents={};var r=e[a];if(!r)r=e[a]=c.getGUID();var s=this.control.domEvents[r];if(!s)s=this.control.domEvents[r]={element:e};var d=n(this.control,t,e),f=s[t];if(!f)if(f=s[t]=new u,!d)f.handler=l.partial(o,this.control,e),c.on(e,t,f.handler);f.add(i)},d.delegateDOMEvent=function(e,t,i){var n=function(e){var t=require("mini-event").fromDOMEvent(e);if(this.fire(i||e.type,t),t.isDefaultPrevented())c.event.preventDefault(e);if(t.isPropagationStopped())c.event.stopPropagation(e)};this.addDOMEvent(e,t,n)},d.removeDOMEvent=function(e,t,i){if("string"==typeof e)e=this.getPart(e);if(this.control.domEvents){var n=e[a],o=this.control.domEvents[n];if(o&&o[t])if(!i)o[t].clear();else{var s=o[t];if(s.remove(i),!s.getLength())r(this.control,t,e)}}},d.clearDOMEvents=function(e){if("string"==typeof e)e=this.getPart(e);if(this.control.domEvents){if(!e)return l.each(l.pluck(this.control.domEvents,"element"),this.clearDOMEvents,this),void(this.control.domEvents=null);var t=e[a],i=this.control.domEvents[t];delete i.element,l.each(i,function(t,i){var n=r(this.control,i,e);if(!n){var o=t.handler;t.dispose(),t.handler=null,c.un(e,i,o)}},this),delete this.control.domEvents[t]}},d}),define("esui/helper/html",["require"],function(require){var e={},t={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0};return e.getPartBeginTag=function(e,t){var i="<"+t+' id="'+this.getId(e)+'" class="'+this.getPartClassName(e)+'">';return i},e.getPartEndTag=function(e,i){var n=t.hasOwnProperty(i)?" />":"</"+i+">";return n},e.getPartHTML=function(e,t){return this.getPartBeginTag(e,t)+this.getPartEndTag(e,t)},e}),define("esui/helper/life",["require","underscore","../main"],function(require){var e={NEW:0,INITED:1,RENDERED:2,DISPOSED:4},t=require("underscore"),i=require("../main"),n={};return n.initViewContext=function(){var e=this.control.viewContext||i.getViewContext();this.control.viewContext=null,this.control.setViewContext(e)},n.initExtensions=function(){var e=this.control.extensions;if(!t.isArray(e))e=this.control.extensions=[];Array.prototype.push.apply(e,i.createGlobalExtensions());for(var n={},r=0;r<e.length;r++){var o=e[r];if(!n[o.type])o.attachTo(this.control),n[o.type]=!0}},n.isInStage=function(t){if(null==e[t])throw new Error("Invalid life cycle stage: "+t);return this.control.stage==e[t]},n.changeStage=function(t){if(null==e[t])throw new Error("Invalid life cycle stage: "+t);this.control.stage=e[t]},n.dispose=function(){if(this.control.disposeChildren(),this.control.children=null,this.control.childrenIndex=null,this.clearDOMEvents(),t.invoke(this.control.extensions,"dispose"),this.control.extensions=null,this.control.parent)this.control.parent.removeChild(this.control);if(this.control.viewContext)this.control.viewContext.remove(this.control);this.control.renderOptions=null},n.beforeDispose=function(){this.control.fire("beforedispose")},n.afterDispose=function(){this.changeStage("DISPOSED"),this.control.fire("afterdispose"),this.control.destroyEvents()},n}),define("esui/helper/template",["require","underscore"],function(require){var e=require("underscore"),t={id:function(e,t){return t.helper.getId(e)},"class":function(e,t){return t.helper.getPartClassName(e)},part:function(e,t,i){return i.helper.getPartHTML(e,t)}},i={};return i.setTemplateEngine=function(e){if(this.templateEngine=e,!e.esui)this.initializeTemplateEngineExtension()},i.initializeTemplateEngineExtension=function(){e.each(t,function(e,t){this.addFilter(t,e)},this.templateEngine)},i.renderTemplate=function(e,i){var n=this;i=i||{};var r={get:function(e){if("instance"===e)return n.control;if("function"==typeof i.get)return i.get(e);var r=e,o=null,a=e.lastIndexOf(".");if(a>=0){r=e.substring(0,a);var s=e.substring(a+1);if(s&&t.hasOwnProperty(s))o=t[s]}var l=i.hasOwnProperty(r)?i[r]:r;if(o)l=o(l,n.control);return l}};if(!this.templateEngine)throw new Error("No template engine attached to this control");return this.templateEngine.render(e,r)},i}),define("esui/Helper",["require","underscore","./helper/children","./helper/dom","./helper/event","./helper/html","./helper/life","./helper/template"],function(require){function e(e){this.control=e}var t=require("underscore");return t.extend(e.prototype,require("./helper/children"),require("./helper/dom"),require("./helper/event"),require("./helper/html"),require("./helper/life"),require("./helper/template")),e}),define("esui/Control",["require","./lib","underscore","./main","./Helper","./SafeWrapper","mini-event/EventTarget"],function(require){function e(e){if(e=e||{},this.helper=new r(this),this.helper.changeStage("NEW"),this.children=[],this.childrenIndex={},this.currentStates={},this.domEvents={},this.main=e.main?e.main:this.createMain(e),!this.id&&!e.id)this.id=t.getGUID();this.initOptions(e),this.helper.initViewContext(),this.helper.initExtensions(),this.helper.changeStage("INITED"),this.fire("init")}var t=require("./lib"),i=require("underscore"),n=require("./main"),r=require("./Helper");e.prototype={constructor:e,ignoreStates:["disabled"],getCategory:function(){return"control"},initOptions:function(e){e=e||{},this.setProperties(e)},createMain:function(){if(!this.type)return document.createElement("div");var e=this.type.replace(/([A-Z])/g,function(e,t){return"-"+t.toLowerCase()});return document.createElement(n.getConfig("customElementPrefix")+"-"+e.slice(1))},initStructure:function(){},initEvents:function(){},render:function(){if(this.helper.isInStage("INITED")){if(this.fire("beforerender"),this.domIDPrefix=this.viewContext.id,this.initStructure(),this.initEvents(),!this.main.id)this.main.id=this.helper.getId();if(this.main.setAttribute(n.getConfig("instanceAttr"),this.id),this.main.setAttribute(n.getConfig("viewContextAttr"),this.viewContext.id),this.helper.addPartClasses(),this.states)this.states="string"==typeof this.states?this.states.split(" "):this.states,i.each(this.states,this.addState,this)}if(this.repaint(),this.helper.isInStage("INITED"))this.helper.changeStage("RENDERED"),this.fire("afterrender")},repaint:function(e,t){if(!t||t.hasOwnProperty("disabled")){var i=this.disabled?"addState":"removeState";this[i]("disabled")}if(!t||t.hasOwnProperty("hidden")){var i=this.hidden?"addState":"removeState";this[i]("hidden")}},appendTo:function(t){if(t instanceof e)t=t.main;if(t.appendChild(this.main),this.helper.isInStage("NEW")||this.helper.isInStage("INITED"))this.render()},insertBefore:function(t){if(t instanceof e)t=t.main;if(t.parentNode.insertBefore(this.main,t),this.helper.isInStage("NEW")||this.helper.isInStage("INITED"))this.render()},dispose:function(){if(!this.helper.isInStage("DISPOSED"))this.helper.beforeDispose(),this.helper.dispose(),this.helper.afterDispose()},destroy:function(){var e=this.main;this.dispose(),t.removeNode(e)},get:function(e){var i=this["get"+t.pascalize(e)];if("function"==typeof i)return i.call(this);else return this[e]},set:function(e,i){var n=this["set"+t.pascalize(e)];if("function"==typeof n)return n.call(this,i);var r={};r[e]=i,this.setProperties(r)},isPropertyChanged:function(e,t,i){return i!==t},setProperties:function(e){if(!this.stage){if(e.hasOwnProperty("id"))this.id=e.id;if(e.hasOwnProperty("group"))this.group=e.group;if(e.hasOwnProperty("skin"))this.skin=e.skin}if(delete e.id,delete e.group,delete e.skin,e.hasOwnProperty("viewContext"))this.setViewContext(e.viewContext),delete e.viewContext;if(this.hasOwnProperty("disabled"))this.disabled=!!this.disabled;if(this.hasOwnProperty("hidden"))this.hidden=!!this.hidden;var i=[],n={};for(var r in e)if(e.hasOwnProperty(r)){var o=e[r],a="get"+t.pascalize(r)+"Property",s=this[a]?this[a]():this[r],l=this.isPropertyChanged(r,o,s);if(l){this[r]=o;var u={name:r,oldValue:s,newValue:o};i.push(u),n[r]=u}}if(i.length&&this.helper.isInStage("RENDERED"))this.repaint(i,n);return n},setViewContext:function(e){var t=this.viewContext;if(t!=e){if(t)this.viewContext=null,t.remove(this);this.viewContext=e,e&&e.add(this);var i=this.children;if(i)for(var r=0,o=i.length;o>r;r++)i[r].setViewContext(e);if(this.viewContext&&this.helper.isInStage("RENDERED"))this.main.setAttribute(n.getConfig("viewContextAttr"),this.viewContext.id)}},setDisabled:function(e){this[e?"disable":"enable"]()},disable:function(){this.addState("disabled")},enable:function(){this.removeState("disabled")},isDisabled:function(){return this.hasState("disabled")},show:function(){this.removeState("hidden")},hide:function(){this.addState("hidden")},toggle:function(){this[this.isHidden()?"show":"hide"]()},isHidden:function(){return this.hasState("hidden")},addState:function(e){if(!this.hasState(e)){this.currentStates[e]=!0,this.helper.addStateClasses(e);var t={},i=e.replace(/-(\w)/,function(e,t){return t.toUpperCase()});t[i]=!0,this.setProperties(t)}},removeState:function(e){if(this.hasState(e)){this.currentStates[e]=!1,this.helper.removeStateClasses(e);var t={},i=e.replace(/-(\w)/,function(e,t){return t.toUpperCase()});t[i]=!1,this.setProperties(t)}},toggleState:function(e){var t=this.hasState(e)?"removeState":"addState";this[t](e)},hasState:function(e){return!!this.currentStates[e]},addChild:function(e,t){if(t=t||e.childName,e.parent)e.parent.removeChild(e);if(this.children.push(e),e.parent=this,t)e.childName=t,this.childrenIndex[t]=e;if(this.viewContext!=e.viewContext)e.setViewContext(this.viewContext)},removeChild:function(e){for(var t=this.children,i=t.length;i--;)if(t[i]===e)t.splice(i,1);var n=e.childName;if(n)this.childrenIndex[n]=null;e.parent=null},disposeChildren:function(){for(var e=this.children.slice(),t=0;t<e.length;t++)e[t].dispose();this.children=[],this.childrenIndex={}},getChild:function(e){return this.childrenIndex[e]||null},getChildSafely:function(e){var t=this.getChild(e);if(!t){var i=require("./SafeWrapper");if(t=new i,t.childName=e,t.parent=this,this.viewContext)t.viewContext=this.viewContext}return t},initChildren:function(e,t){this.helper.initChildren(e,t)}};var o=require("mini-event/EventTarget");return t.inherits(e,o),e}),define("esui/Button",["require","underscore","./lib","./painters","./Control","./main"],function(require){function e(e){o.apply(this,arguments)}function t(e){var t={};return t.borderTop=parseInt(n.getComputedStyle(e,"borderTopWidth"),10),t.borderBottom=parseInt(n.getComputedStyle(e,"borderBottomWidth"),10),t}var i=require("underscore"),n=require("./lib"),r=require("./painters"),o=require("./Control");return e.prototype={type:"Button",initOptions:function(e){var t={content:"",disabled:!1};if(i.extend(t,e),t.tagName=this.main.nodeName.toLowerCase(),null==t.text)t.text=n.getText(this.main);var r=this.main.firstChild;if(!t.content&&r&&"div"!==r.nodeName.toLowerCase())t.content=this.main.innerHTML;this.setProperties(t)},createMain:function(){var e=document.createElement("div");return e.innerHTML='<button type="button"></button>',e.firstChild},initEvents:function(){this.helper.delegateDOMEvent(this.main,"click")},repaint:r.createRepaint(o.prototype.repaint,r.style("width"),{name:"height",paint:function(e,i){if(i){var n=e.main;n.style.height=i+"px";var r=i;n.style.lineHeight=r+"px";var o=n.offsetHeight;if(o===i){var a=t(n),s=i+a.borderTop+a.borderBottom;n.style.height=s+"px"}}}},{name:"btnSkin",paint:function(e,t){if(t){var i="skin-"+t+"-button",n=e.main.className,r=n.lastIndexOf(i);if(-1!=r)e.main.className=n.substring(0,r+i.length);else e.main.className+=" "+i}}},r.html("content"),{name:"disabled",paint:function(e,t){var i=e.main.nodeName.toLowerCase();if("button"===i||"input"===i)e.main.disabled=!!t}}),setContent:function(e){this.setProperties({content:e})}},n.inherits(e,o),require("./main").register(e),e}),define("esui/Panel",["require","underscore","./lib","./Control","./painters","./main"],function(require){function e(){r.apply(this,arguments)}function t(e){if(e.indexOf("-")>=0)e=e.replace(/-\w/g,function(e){return e.charAt(1).toUpperCase()});return e}var i=require("underscore"),n=require("./lib"),r=require("./Control");return e.prototype.type="Panel",e.prototype.getCategory=function(){return"container"},e.prototype.createMain=function(e){if(!e.tagName)return r.prototype.createMain.call(this);else return document.createElement(e.tagName)},e.prototype.initOptions=function(e){var t={};i.extend(t,e),t.tagName=this.main.nodeName.toLowerCase(),this.setProperties(t)},e.prototype.repaint=require("./painters").createRepaint(r.prototype.repaint,{name:"content",paint:function(e,t){if(null!=t)e.helper.disposeChildren(),e.main.innerHTML=t;e.helper.initChildren()}}),e.prototype.setContent=function(e){this.setProperties({content:e})},e.prototype.getStyle=function(e){return e=t(e),this.main?this.main.style[e]:""},e.prototype.setStyle=function(e,i){if(e=t(e),this.main)this.main.style[e]=i||""},n.inherits(e,r),require("./main").register(e),e}),define("esui/Layer",["require","underscore","./lib","./main"],function(require){function e(e){this.control=e}function t(e){var t=e.target,i=this.getElement(this),n=this.control.main;if(i){for(;t&&t!==i&&t!==n;)t=t.parentNode;if(t!==i&&t!==n)this.hide()}}function i(e){var t=e.control.helper.getPartClasses("layer-hidden");return t.unshift(a.getConfig("uiClassPrefix")+"-layer-hidden"),t}function n(e,t){var i=o.clone(t||{});if(i.hasOwnProperty("top")&&i.hasOwnProperty("bottom"))i.height=i.bottom-i.top,delete i.bottom;if(i.hasOwnProperty("left")&&i.hasOwnProperty("right"))i.width=i.right-i.left,
delete i.right;if(i.hasOwnProperty("top")||i.hasOwnProperty("bottom"))e.style.top="",e.style.bottom="";if(i.hasOwnProperty("left")||i.hasOwnProperty("right"))e.style.left="",e.style.right="";for(var n in i)if(i.hasOwnProperty(n))e.style[n]=i[n]+"px"}var r=require("underscore"),o=require("./lib"),a=require("./main");e.prototype.nodeName="div",e.prototype.create=function(){var e=this.control.helper.createPart("layer",this.nodeName);return o.addClass(e,a.getConfig("uiClassPrefix")+"-layer"),e},e.prototype.render=function(e){},e.prototype.syncState=function(e){},e.prototype.repaint=function(){var e=this.getElement(!1);if(e)this.render(e)},e.prototype.initBehavior=function(e){},e.prototype.getElement=function(e){var n=this.control.helper.getPart("layer");if(!n&&e!==!1)if(n=this.create(),this.render(n),o.addClasses(n,i(this)),this.initBehavior(n),this.control.helper.addDOMEvent(document,"mousedown",r.bind(t,this)),this.control.helper.addDOMEvent(n,"mousedown",function(e){e.stopPropagation()}),this.syncState(n),!n.parentElement)document.body.appendChild(n);return n},e.prototype.hide=function(){var e=i(this),t=this.getElement();o.addClasses(t,e),this.control.removeState("active")},e.prototype.show=function(){var e=this.getElement();e.style.zIndex=this.getZIndex(),this.position();var t=i(this);o.removeClasses(e,t),this.control.addState("active")},e.prototype.toggle=function(){var e=this.getElement();if(!e||this.control.helper.isPart(e,"layer-hidden"))this.show();else this.hide()},e.prototype.position=function(){var t=this.getElement();e.attachTo(t,this.control.main,this.dock)},e.prototype.getZIndex=function(){return e.getZIndex(this.control.main)},e.prototype.dispose=function(){var e=this.getElement(!1);if(e)e.innerHTML="",o.removeNode(e);this.control=null};var s=1e3;return e.create=function(e){var t=document.createElement(e||"div");return t.style.position="absolute",t},e.getZIndex=function(e){for(var t=0;!t&&e&&e!==document;)t=parseInt(o.getComputedStyle(e,"zIndex"),10),e=e.parentNode;return t=t||0,t+1},e.moveToTop=function(e){e.style.zIndex=++s},e.moveTo=function(e,t,i){n(e,{top:t,left:i})},e.resize=function(e,t,i){n(e,{width:t,height:i})},e.attachTo=function(e,t,i){i=i||{strictWidth:!1};var r=o.page.getViewWidth(),a=o.page.getViewHeight(),s=o.page.getScrollTop(),l=o.page.getScrollLeft(),u=o.getOffset(t),c=e.style.display;if(e.style.display="block",e.style.top="-5000px",e.style.left="-5000px",i.strictWidth)e.style.minWidth=u.width+"px";var d=o.getOffset(e);e.style.top="",e.style.left="",e.style.display=c;var f={},h=a-(u.bottom-s),p=u.top-s;if(h<=d.height&&p>d.height)f.top=u.top-d.height;else f.top=u.bottom;var g=r-(u.left-l),v=u.right-l;if(g<=d.width&&v>d.width)f.left=u.right-d.width;else f.left=u.left;n(e,f)},e.centerToView=function(e,t){var i=t?o.clone(t):{};if("number"!=typeof i.width)i.width=this.width;if("number"!=typeof i.height)i.height=this.height;i.left=(o.page.getViewWidth()-i.width)/2;var n=o.page.getViewHeight();if(i.height>=n&&t.hasOwnProperty("minTop"))i.top=t.minTop;else i.top=Math.floor((n-i.height)/2);var r=o.page.getViewWidth();if(i.height>=r&&t.hasOwnProperty("minLeft"))i.left=t.minLeft;else i.left=Math.floor((r-i.width)/2);i.top+=o.page.getScrollTop(),this.setProperties(i)},e}),define("esui/controlHelper",["require","./lib","./Helper","./painters","underscore","./Layer"],function(require){var e=require("./lib"),t=require("./Helper"),i={};i.getGUID=e.getGUID;var n=["initViewContext","initExtensions","isInStage","changeStage","dispose","beforeDispose","afterDispose","getPartClasses","addPartClasses","removePartClasses","getStateClasses","addStateClasses","removeStateClasses","getId","replaceMain","addDOMEvent","removeDOMEvent","clearDOMEvents"];i.createRepaint=require("./painters").createRepaint,require("underscore").each(n,function(e){i[e]=function(i){var n=i.helper||new t(i),r=[].slice.call(arguments,1);return n[e].apply(n,r)}}),i.extractValueFromInput=function(t,i){var n=t.main;if(e.isInput(n)){if(n.value&&!i.value)i.value=n.value;if(n.name&&!i.name)i.name=n.name;if(n.disabled&&(null===i.disabled||void 0===i.disabled))i.disabled=n.disabled;if(n.readOnly&&(null===i.readOnly||void 0===i.readOnly))i.readOnly=n.readonly||n.readOnly}};var r=i.layer={},o=require("./Layer");return r.create=o.create,r.getZIndex=o.getZIndex,r.moveToTop=o.moveToTop,r.moveTo=o.moveTo,r.resize=o.resize,r.attachTo=o.attachTo,r.centerToView=o.centerToView,i}),define("esui/Dialog",["require","./Button","./Panel","./lib","./controlHelper","./Control","./main"],function(require){function e(e){m.apply(this,arguments)}function t(e){var t=e.main;if(t){for(var i,n=g.getChildren(t),r=n.length,o={};r--;)if(i=n[r].getAttribute("data-role"))o[i]=n[r];e.roles=o}}function i(e,t){var i="title",n="close-icon",r='<div class="${clsClass}" id="${clsId}">&nbsp;</div>',o="";if(e.closeButton)o=g.format(r,{clsId:v.getId(e,n),clsClass:v.getPartClasses(e,n).join(" ")});var a='<div id="${titleId}" class="${titleClass}"></div>${closeIcon}',s=[].concat(v.getPartClasses(e,"head")),l={titleId:v.getId(e,i),titleClass:v.getPartClasses(e,i).join(" "),closeIcon:o},u=g.format(a,l);if(t)e.title=t.innerHTML;else if(t=document.createElement("div"),e.main.firstChild)g.insertBefore(t,e.main.firstChild);else e.main.appendChild(t);t.innerHTML=u,g.addClasses(t,s);var c={main:t,renderOptions:e.renderOptions},d=y.create("Panel",c);return d.render(),e.addChild(d,"head"),d}function n(){var e=this.fire("beforeclose");if(e.isDefaultPrevented())return!1;if(this.hide(),this.fire("close"),this.closeOnHide)this.dispose()}function r(){var e=g.page,t=this.main,i=this.left,n=this.top,r=this.right,o=this.bottom;if(void 0===i||null===i)i=(e.getViewWidth()-t.offsetWidth)/2;if(0>i)i=0;if(void 0===n||null===n)n=(e.getViewHeight()-t.offsetHeight)/2;if(n=Math.max(n,0),t.style.left=i+"px",t.style.top=e.getScrollTop()+n+"px",void 0!==r&&null!==r)t.style.right=r+"px";if(void 0!==o&&null!==o)t.style.bottom=o+"px";if("auto"===this.height){var a=e.getViewHeight()-n;t.style.height=a+"px";var s=this.getBody().main,l=this.getHead().main,u=parseInt(g.getStyle(l,"height"),10);s.style.height=a-u+"px"}}function o(e,t){var i=e,n=e.getChild("head").main;if(t===!0)v.removeDOMEvent(i,n,"mousedown",s);else v.addDOMEvent(i,n,"mousedown",s)}function a(e,t,i){if(i)v.addDOMEvent(e,t,"selectstart",function(e){e.preventDefault()});else v.removeDOMEvent(e,t,"selectstart")}function s(e){var t=e.button,i=!1;if(!e.which&&1===t||1===e.which)i=!0;if(i){var n=document;this.addState("dragging"),a(this,this.main,!0),v.addDOMEvent(this,n,"mousemove",l),v.addDOMEvent(this,n,"mouseup",u),g.event.getMousePosition(e),this.dragStartPos={x:e.pageX,y:e.pageY}}}function l(e){var t=this;g.event.getMousePosition(e);var i={x:e.pageX-t.dragStartPos.x,y:e.pageY-t.dragStartPos.y};t.dragStartPos={x:e.pageX,y:e.pageY};var n=t.main,r=g.getOffset(n),o=r.left+i.x,a=r.top+i.y,s=g.page.getWidth(),l=g.page.getHeight(),u=g.getOffset(n);if(0>a)a=0;else if(a>l-u.height)a=l-u.height;if(0>o)o=0;else if(o>s-u.width)o=s-u.width;n.style.left=o+"px",n.style.top=a+"px"}function u(e){v.removeDOMEvent(this,document,"mousemove",l),v.removeDOMEvent(this,document,"mouseup",u),this.removeState("dragging"),a(this,this.main,!1)}function c(e,t){var i=h(e),n=[],r=v.getPartClasses(e,"mask").join(" ");n.push(r),i.className=n.join(" "),i.style.display="block",i.style.zIndex=t}function d(e){var t=h(e);if("undefined"!=typeof t)g.removeNode(t)}function f(e){var t=document.createElement("div");t.id=e,document.body.appendChild(t)}function h(e){var t=v.getId(e),i=b+"-"+t,n=g.g(i);if(!n)f(i);return g.g(i)}require("./Button"),require("./Panel");var p,g=require("./lib"),v=require("./controlHelper"),m=require("./Control"),y=require("./main"),b="ctrl-mask";return e.OK_TEXT="",e.CANCEL_TEXT="",e.prototype={type:"Dialog",initOptions:function(e){t(e);var i={closeButton:!0,closeOnHide:!0,draggable:!1,mask:!0,title:"",content:"<p></p>",defaultFoot:'<div class="'+this.helper.getPartClassName("ok-btn")+' ui-button-active" data-ui="type:Button;id:btnFootOk;childName:btnOk;"></div><div class="'+this.helper.getPartClassName("cancel-btn")+'" data-ui="type:Button;id:btnFootCancel;childName:btnCancel;"></div>',needFoot:!0,roles:{}};if("false"===e.closeOnHide)e.closeOnHide=!1;if("false"===e.closeButton)e.closeButton=!1;if("false"===e.mask)e.mask=!1;if("false"===e.needFoot)e.needFoot=!1;if(g.extend(i,e),i.needFoot)if(!i.foot)i.foot=i.defaultFoot;this.setProperties(i)},initStructure:function(){var e=this.main;if(e.parentNode&&"body"!==e.parentNode.nodeName.toLowerCase())document.body.appendChild(e);if(this.addState("hidden"),i(this,this.roles.title),this.createBF("body",this.roles.content),this.needFoot)this.createBF("foot",this.roles.foot)},initEvents:function(){if(this.closeButton){var e=g.g(v.getId(this,"close-icon"));if(e)v.addDOMEvent(this,e,"click",g.curry(n,this))}},createBF:function(e,t){if(t)this.content=t.innerHTML;else if(t=document.createElement("div"),"body"==e){var i=this.getChild("head");if(i)g.insertAfter(t,i.main);else if(this.main.firstChild)g.insertBefore(t,i,this.main.firstChild);else this.main.appendChild(t)}else this.main.appendChild(t);g.addClasses(t,v.getPartClasses(this,e+"-panel"));var n={main:t,renderOptions:this.renderOptions},r=y.create("Panel",n);return r.render(),this.addChild(r,e),r},repaint:v.createRepaint(m.prototype.repaint,{name:"height",paint:function(e,t){if("auto"===t)e.main.style.height="auto";else if(t)e.main.style.height=t+"px";if(e.isShow)r.apply(e)}},{name:"width",paint:function(e,t){if("auto"===t)e.main.style.width="auto";else if(t)e.main.style.width=t+"px";if(e.isShow)r.apply(e)}},{name:"title",paint:function(e,t){var i=v.getId(e,"title");g.g(i).innerHTML=t}},{name:"content",paint:function(e,t){if(t){var i='<div class="${class}" id="${id}">${content}</div>',n=e.getBody(),r=v.getId(e,"body"),o=v.getPartClasses(e,"body"),a={"class":o.join(" "),id:r,content:t};n.setContent(g.format(i,a))}}},{name:"foot",paint:function(e,t){var i='<div class="${class}" id="${id}">${content}</div>',n=v.getId(e,"foot"),r=v.getPartClasses(e,"foot"),o=e.getFoot();if(null==t){if(e.needFoot=!1,o)e.removeChild(o)}else{e.needFoot=!0;var a={"class":r.join(" "),id:n,content:t};if(!o)o=e.createBF("foot");o.setContent(g.format(i,a))}}},{name:"draggable",paint:function(e,t){var i=!1;if(t)e.addState("draggable");else e.removeState("draggable"),i=!0;o(e,i)}}),getBody:function(){return this.getChild("body")},getHead:function(){return this.getChild("head")},getFoot:function(){return this.getChild("foot")},show:function(){var e=this.mask;if(v.isInStage(this,"INITED"))this.render();else if(v.isInStage(this,"DISPOSED"))return;p=g.curry(r,this),v.addDOMEvent(this,window,"resize",r),this.setWidth(this.width),this.removeState("hidden"),r.apply(this);for(var t=1203,i=document.body.children,n=0,o=0,a=i.length;a>o;o++)if(1===i[o].nodeType)if(g.hasClass(i[o],this.helper.getPrimaryClassName())&&!g.hasClass(i[o],this.helper.getPrimaryClassName("hidden")))n++;if(t+=10*n,this.main.style.zIndex=t,e)c(this,t-1);this.fire("show"),this.isShow=!0},hide:function(){if(this.isShow){v.removeDOMEvent(this,window,"resize",r);var e=this.mask;if(this.addState("hidden"),e)d(this)}this.fire("hide"),this.isShow=!1},setTitle:function(e){this.setProperties({title:e})},setContent:function(e){this.setProperties({content:e})},setFoot:function(e){this.setProperties({foot:e})},setHeight:function(e){this.setProperties({height:e})},setWidth:function(e){this.setProperties({width:e})},resize:function(){r.apply(this)},dispose:function(){if(!this.helper.isInStage("DISPOSED")){this.hide();var e=this.main.id;g.removeNode(e),m.prototype.dispose.apply(this,arguments)}}},e.confirm=function(t){function i(e,t){e.fire(t),e.dispose()}var n="dialog-confirm",r=g.encodeHTML(t.title)||"",o=t.content,a=g.encodeHTML(t.okText)||e.OK_TEXT,s=g.encodeHTML(t.cancelText)||e.CANCEL_TEXT,l={type:"confirm",skin:"confirm",title:""};g.extend(l,t);var u=['<div class="${prefix}-icon ${prefix}-icon-${type}"></div>','<div class="${prefix}-text">${content}</div>'].join("");l.id=v.getGUID(n),l.closeButton=!0,l.mask=!0,l.alwaysTop=!0;var c=l.type;l.type=null;var d=y.create("Dialog",l);d.appendTo(document.body),d.show();var f=d.getFoot().getChild("btnOk"),h=d.getFoot().getChild("btnCancel");if(f.setContent(a),h.setContent(s),d.setTitle(r),d.setContent(g.format(u,{type:c,content:o,prefix:d.helper.getPrimaryClassName()})),l.btnHeight)f.set("height",l.btnHeight),h.set("height",l.btnHeight);if(l.btnWidth)f.set("width",l.btnWidth),h.set("width",l.btnWidth);return f.on("click",g.curry(i,d,"ok")),h.on("click",g.curry(i,d,"cancel")),d},e.alert=function(t){function i(e,t){e.fire("ok"),t.dispose(),e.dispose()}var n="dialog-alert",r="dialog-alert-ok",o=g.encodeHTML(t.title)||"",a=g.encodeHTML(t.content)||"",s=g.encodeHTML(t.okText)||e.OK_TEXT,l={type:"warning",skin:"alert",title:""};g.extend(l,t);var u=['<div class="${prefix}-icon ${prefix}-icon-${type}"></div>','<div class="${prefix}-text">${content}</div>'].join(""),c=v.getGUID(n);l.id=c,l.closeButton=!1,l.mask=!0,l.alwaysTop=!0;var d=l.type;l.type=null;var f=y.create("Dialog",l);f.appendTo(document.body),f.setTitle(o),f.setContent(g.format(u,{type:d,content:a,prefix:f.helper.getPrimaryClassName()})),f.setFoot('<div class="'+f.helper.getPartClassName("ok-btn")+' ui-button-active" data-ui="type:Button;childName:okBtn;id:'+c+"-"+r+'; skin:spring;width:50;">'+s+"</div>"),f.show();var h=f.getFoot().getChild("okBtn");if(h.on("click",g.curry(i,f,h)),l.btnHeight)h.set("height",l.btnHeight);if(l.btnwidth)h.set("width",l.btnwidth);return f},g.inherits(e,m),y.register(e),e}),define("er/events",["require","./util","mini-event/EventTarget"],function(require){function e(){}var t=require("./util");t.inherits(e,require("mini-event/EventTarget")),e.prototype.notifyError=function(e){if("string"==typeof e)e=new Error(e);return this.fire("error",{error:e}),e};var i=new e;return i.EventBus=e,i}),define("ef/ActionPanel",["require","er/events","esui/Panel","mini-event","er/Deferred","esui/painters","er/controller","eoo","esui"],function(require){function e(e){var t=require("mini-event").fromEvent(e,{preserveData:!0,syncState:!0});t.type="action@"+e.type,this.fire(t)}function t(t){if(t.isChildAction&&t.container===this.main.id){if(this.action=t.action,"function"==typeof this.action.on)this.action.on("*",e,this);this.fire("actionattach")}}function i(e){if(e.isChildAction&&e.container===this.main.id)this.fire("actionloaded")}function n(e){if(e.isChildAction&&e.container===this.main.id)this.action=null,this.fire("actionloadfail",{failType:e.failType,reason:e.reason})}function r(e){if(e.isChildAction&&e.container===this.main.id)this.fire("actionloadabort")}var o=require("er/events"),a=require("esui/Panel"),exports={};exports.type="ActionPanel",exports.setContent=function(){},exports.actionType=null,exports.action=null,exports.initStructure=function(){o.on("enteraction",t,this),o.on("enteractioncomplete",i,this),o.on("actionnotfound",n,this),o.on("permissiondenied",n,this),o.on("actionfail",n,this),o.on("enteractionfail",n,this),o.on("actionabort",r,this)},exports.disposeAction=function(){var t=require("er/Deferred"),i=this.action;if(i){if(t.isPromise(i)&&"function"==typeof i.abort)i.abort();else{if("function"==typeof i.un)i.un("*",e,this);if("function"==typeof i.leave)i.leave()}this.action=null}},exports.repaint=require("esui/painters").createRepaint(a.prototype.repaint,{name:["url","actionOptions"],paint:function(e,t,i){if(e.disposeAction(),t)if(!e.lazy||!e.helper.isInStage("INITED")){var n=require("er/controller");if(e.action=n.renderChildAction(t,e.main.id,i),"function"!=typeof e.action.abort)e.action=null}}}),exports.dispose=function(){this.disposeAction(),o.un("enteraction",t,this),o.un("enteractioncomplete",i,this),o.un("actionnotfound",n,this),o.un("permissiondenied",n,this),o.un("actionfail",n,this),o.un("enteractionfail",n,this),o.un("actionabort",r,this),this.$super(arguments)},exports.reload=function(e){var t=this.url;this.url=null,this.setProperties({url:t,actionOptions:e})};var s=require("eoo").create(a,exports);return require("esui").register(s),s}),define("ef/ActionDialog",["require","esui/main","esui/Dialog","./ActionPanel","mini-event","esui/painters","eoo","esui"],function(require){var e=require("esui/main"),t=require("esui/Dialog");require("./ActionPanel");var exports={};exports.type="ActionDialog",exports.styleType="Dialog",exports.setContent=function(){},exports.createBF=function(t,i){if(i)this.content=i.innerHTML;else i=document.createElement("div"),this.main.appendChild(i);this.helper.addPartClasses(t+"-panel",i);var n={main:i},r="Panel";if("body"===t)n.url=this.url,n.actionOptions=this.actionOptions,r="ActionPanel";var o=e.create(r,n);if("body"===t){o.on("actionattach",function(){if(this.resize(),this.autoClose){var e=this.get("action");if("function"==typeof e.on)e.on("handlefinish",!1),e.on("handlefinish",this.dispose,this)}this.fire("actionattach")},this),o.on("*",function(e){if(0===e.type.indexOf("action@"))this.fire(e)},this);var a=require("mini-event");a.delegate(o,this,"actionloaded"),a.delegate(o,this,"actionloadfail"),a.delegate(o,this,"actionloadabort")}return o.render(),this.addChild(o,t),o},exports.repaint=require("esui/painters").createRepaint(t.prototype.repaint,{name:["url","actionOptions"],paint:function(e,t,i){var n=e.getBody(),r={url:t,actionOptions:i};n.setProperties(r)}}),exports.getAction=function(){var e=this.getBody();if(e)return e.get("action");else return null},exports.reload=function(){var e=this.getBody();if(e)e.reload()};var i=require("eoo").create(t,exports);return require("esui").register(i),i}),define("ef/UIView",["require","underscore","er/View","ef/ActionDialog","esui","esui/Dialog","esui/main","esui/ViewContext","eoo"],function(require){function e(e,t){for(var i=e,n=0;n<t.length;n++)i=i[t[n]];return i}function t(e,t,i,n){if("string"==typeof n)n=e[n];if("function"!=typeof n)return n;var r=e.get(t);if(r)r.on(i,n,e);return n}function i(){return"ef-"+o++}var n=require("underscore"),r=require("er/View");require("ef/ActionDialog");var exports={};exports.replaceValue=function(t){if("string"!=typeof t)return t;if("@@"===t||"**"===t)return this.model;var i=t.charAt(0),n=t.substring(1);if("@"===i||"*"===i){var r=n.split("."),t=this.model.get(r[0]);return r.length>1?e(t,r.slice(1)):t}else return t},exports.get=function(e){return this.viewContext.get(e)},exports.getSafely=function(e){return this.viewContext.getSafely(e)},exports.getGroup=function(e){return this.viewContext.getGroup(e)},exports.create=function(e,t){if(t=t||{},!t.viewContext)t.viewContext=this.viewContext;return require("esui").create(e,t)},exports.alert=function(e,t){var i="string"==typeof e?{title:t||document.title,content:e}:n.clone(e);if(!i.viewContext)i.viewContext=this.viewContext;var r=require("esui/Dialog");return r.alert(i)},exports.confirm=function(e,t){var i="string"==typeof e?{title:t||document.title,content:e}:n.clone(e);if(!i.viewContext)i.viewContext=this.viewContext;var r=require("esui/Dialog");return r.confirm(i)},exports.popActionDialog=function(e){var t=document.createElement("div");document.body.appendChild(t);var i={width:600,needFoot:!1,draggable:!0,closeOnHide:!0,autoClose:!0,main:t,viewContext:this.viewContext};e=n.defaults({},e,i);var r=require("esui/main"),o=r.create("ActionDialog",e);return o.render(),o.show(),o},exports.uiEvents=null,exports.getUIEvents=function(){return this.uiEvents||{}},exports.uiProperties=null,exports.getUIProperties=function(){return this.uiProperties},exports.bindEvents=function(){var e=this.getUIEvents();if(e)for(var i in e)if(e.hasOwnProperty(i)){var n=i.split(":");if(n.length>1){var r=n[0],o=n[1],a=e[i];t(this,r,o,a)}else{var s=e[i];if("object"!=typeof s)return;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];t(this,i,o,a)}}}else;};var o=8785925;exports.getViewName=function(){if(this.name)return this.name;var e=this.constructor&&this.constructor.name;if(!e&&this.constructor){var t=this.constructor.toString(),n=/function\s+([^\(]*)/.exec(t);e=n&&n[1].replace(/\s+$/g,"")}if(!e)e=i();if(e=e.replace(/View$/,""),e=e.replace(/[A-Z]{2,}/g,function(e){return e.charAt(0)+e.slice(1,-1).toLowerCase()+e.charAt(e.length-1)}),e=e.replace(/[A-Z]/g,function(e){return"-"+e.toLowerCase()}),"-"===e.charAt(0))e=e.substring(1);return e},exports.createViewContext=function(){var e=require("esui/ViewContext"),t=this.getViewName();return new e(t||null)},exports.enterDocument=function(){this.viewContext=this.createViewContext();var e=this.getContainerElement(),t={viewContext:this.viewContext,properties:this.getUIProperties(),valueReplacer:n.bind(this.replaceValue,this)};try{require("esui").init(e,t)}catch(i){var r=new Error("ESUI initialization error on view because: "+i.message);throw r.actualError=i,r}this.bindEvents()},exports.dispose=function(){if(this.viewContext)this.viewContext.dispose(),this.viewContext=null;this.$super(arguments)};var a=require("eoo").create(r,exports);return a}),define("newstyleManage/messageBoardCMS/main.tpl",[],function(){return'<!-- target: cf --><div id="message-boardCMS-modal" data-type="${type}"><div id="main-panel-container"><!-- if: ${type} === \'input\' --><div class="input-container"><span class="input-question-title"></span><label><input type="text"id="input-item-question"class="modal-input need-validate"maxlength="10"spellcheck="false"data-bind-with="question"value="${itemData.question}" /></label></div><!-- elif: ${type} === \'select\' --><div class="input-container"><span class="title"></span><label><input type="text"id="select-item-question"class="modal-input need-validate"maxlength="10"spellcheck="false"data-bind-with="question"value="${itemData.question}" /></label></div><!-- for: ${itemData.subItems} as ${answer}, ${index} --><div class="input-container"><span class="title">${index|addOne}</span><!-- if: ${answer} == null && ${index} !== 0 --><!-- // data-blank-index --><div class="blank-answer" data-blank-index="${index}"></div><!-- else --><label><input type="text"class="modal-input select-item-input"maxlength="20"spellcheck="false"data-option-index="${index}"value="${answer}" /></label><!-- if: ${index} > 1 --><div class="delete-answer" data-option-index="${index}">X</div><!-- /if --><!-- /if --></div><!-- /for --><!-- /if --><!-- if: ${type} === \'select\' --><div id="add-new-select-item"class="add-new-frame add-new-option ${validItemLen|getAddNewClass}"><span class="add-new-icon">+</span></div><!-- /if --><div class="msg-error-container"><div id="msg-board-CMS-error" class="error-tip"></div></div></div><div class="button-group"><div data-ui="type:Button;id:confirm" class="ui-button-ok"></div><div data-ui="type:Button;id:cancel" class="ui-button-circle"></div></div></div>'}),define("newstyleManage/messageBoardCMS/MessageBoardCMSView",["require","ef/UIView","er/util","etpl","jquery","underscore","esui/Button","./main.tpl"],function(require){function e(){t.apply(this,arguments)}var t=require("ef/UIView"),i=require("er/util"),n=require("etpl"),r=require("jquery"),o=require("underscore");require("esui/Button");var a=require("./main.tpl");return n.compile(a),e.prototype.template="cf",e.prototype.uiProperties={},e.prototype.uiEvents={confirm:{click:function(){this.fire("confirm")}},cancel:{click:function(){this.fire("cancel")}}},e.prototype.enterDocument=function(){t.prototype.enterDocument.call(this,arguments);var e=this,i=this.model,n="select"===i.get("type"),a=i.get("itemData"),s=a.subItems;if(r("input[data-bind-with]").on("input",function(e){var t=r(e.target),i=t.attr("data-bind-with");a[i]=t.val()}),n)r(".select-item-input").on("input",function(e){var t=r(e.target),i=+t.attr("data-option-index");s[i]=t.val()}),r("#add-new-select-item").on("click",function(t){var n=r("[data-blank-index]").first();if(n.length>0){var o=+n.attr("data-blank-index");s[o]="",i.set("validItemLen",i.getValidItemsLen()),e.render()}}),r(".delete-answer").on("click",function(t){var n=r(t.target),l=+n.attr("data-option-index");s[l]=null,s=s.filter(function(e){return null!==e}),i.set("itemData",o.extend(a,{subItems:s})),i.makePadding(),i.set("validItemLen",i.getValidItemsLen()),e.render()})},i.inherits(e,t),e}),define("newstyleManage/messageBoardCMS/MessageBoardCMSAction",["require","er/Action","er/util","jquery","underscore","./MessageBoardCMSModel","./MessageBoardCMSView"],function(require){function e(){t.apply(this,arguments)}var t=require("er/Action"),i=require("er/util"),n=require("jquery"),r=require("underscore");return e.prototype.modelType=require("./MessageBoardCMSModel"),e.prototype.viewType=require("./MessageBoardCMSView"),e.prototype.initBehavior=function(){function e(e){var t=n("#msg-board-CMS-error");t.text(e).css({display:"inline-block"})}t.prototype.initBehavior.apply(this,arguments);var i=this,o=this.view,a=this.model,s=function(){var t=a.get("type"),i=n("#input-item-question"),o=n("#select-item-question");if("input"===t){if(""===i.val())return e(""),!1}else if("select"===t)if(""===o.val())return e(""),!1;else if(r.compact(a.get("itemData").subItems).length<2)return e(""),!1;return!0};o.on("confirm",function(){if(s()){var e=a.get("itemData"),t=a.get("type");if("input"===t)delete e.subItems;else if("select"===t)e.subItems=r.compact(e.subItems);i.fire("confirm",{index:+a.get("index"),data:e})}}),o.on("cancel",function(){i.fire("cancel")})},i.inherits(e,t),e}),define("mini-event/lib",["require"],function(require){var e={};return e.extend=function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];if(i){for(var n in i)if(i.hasOwnProperty(n))e[n]=i[n]}else;}return e},e}),define("mini-event/EventTarget",["require","./lib","./Event","./EventQueue"],function(require){function e(){}var t=require("./lib"),i=require("./Event"),n=require("./EventQueue");return e.prototype.on=function(e,i,r,o){if(!this.miniEventPool)this.miniEventPool={};if(!this.miniEventPool.hasOwnProperty(e))this.miniEventPool[e]=new n;var a=this.miniEventPool[e];if(o=t.extend({},o),r)o.thisObject=r;a.add(i,o)},e.prototype.once=function(e,i,n,r){r=t.extend({},r),r.once=!0,this.on(e,i,n,r)},e.prototype.un=function(e,t,i){if(this.miniEventPool&&this.miniEventPool.hasOwnProperty(e)){var n=this.miniEventPool[e];n.remove(t,i)}},e.prototype.fire=function(e,t){if(1===arguments.length&&"object"==typeof e)t=e,e=t.type;if(!e)throw new Error("No event type specified");if("*"===e)throw new Error("Cannot fire global event");var n=t instanceof i?t:new i(e,t);n.target=this;var r=this["on"+e];if("function"==typeof r)r.call(this,n);if(this.miniEventPool&&this.miniEventPool.hasOwnProperty(e)){var o=this.miniEventPool[e];o.execute(n,this)}if(this.miniEventPool&&this.miniEventPool.hasOwnProperty("*")){var a=this.miniEventPool["*"];a.execute(n,this)}return n},e.prototype.destroyEvents=function(){if(this.miniEventPool){for(var e in this.miniEventPool)if(this.miniEventPool.hasOwnProperty(e))this.miniEventPool[e].dispose();this.miniEventPool=null}},e.enable=function(i){i.miniEventPool={},t.extend(i,e.prototype)},e}),define("er/config",[],{mainElement:"main",indexURL:"/",systemName:"",noAuthorityLocation:"/401",notFoundLocation:"/404"}),define("er/locator",["require","./config","./events","mini-event/EventTarget"],function(require){function e(){var e=location.href.indexOf("#"),t=-1===e?"":location.href.slice(e);return t}function t(){var t=e();o.redirect(t)}function i(e){if(window.addEventListener)window.addEventListener("hashchange",t,!1);else if("onhashchange"in window&&document.documentMode>7)window.attachEvent("onhashchange",t);else s=setInterval(t,100);if(e)l=setTimeout(t,0)}function n(){if(s)clearInterval(s),s=null;if(l)clearTimeout(l),l=null;if(window.removeEventListener)window.removeEventListener("hashchange",t,!1);else if("onhashchange"in window&&document.documentMode>7)window.detachEvent("onhashchange",t)}function r(t,r){var o=a!==t;if(o&&e()!==t)if(r.silent)n(),location.hash=t,i(!1);else location.hash=t;return a=t,o}var o={},a="",s=0,l=1;return o.start=function(){i(!0)},o.stop=n,o.resolveURL=function(e){if(e+="",0===e.indexOf("#"))e=e.slice(1);if(!e||"/"===e)e=require("./config").indexURL;return e},o.redirect=function(e,t){t=t||{},e=o.resolveURL(e);var i=a,n=r(e,t),s=n||t.force;if(s){if(!t.silent)o.fire("redirect",{url:e,referrer:i});require("./events").fire("redirect",{url:e,referrer:i})}return s},o.reload=function(){if(a)o.redirect(a,{force:!0})},require("mini-event/EventTarget").enable(o),o}),define("er/Action",["require","./util","mini-event/EventTarget","log/main","./Deferred","./events","./locator"],function(require){function e(){for(var e=[],t=0;t<arguments.length;t++){var i=arguments[t];if(!i.success)e.push(i)}return this.handleError(e)}function t(){this.disposed=!1,this.initialize(),this.name&&r.init(this.name)}var i=require("./util"),n=require("mini-event/EventTarget"),r=require("log/main");return t.prototype.initialize=i.noop,t.prototype.context=null,t.prototype.modelType=null,t.prototype.viewType=null,t.prototype.enter=function(t){this.context=t||{},this.fire("enter");var n=i.mix({},t&&t.args);if(this.model)this.model.fill(n);else this.model=this.createModel(n);if(this.fire("beforemodelload"),this.model&&"function"==typeof this.model.load){var r=this.model.load();return r.then(i.bind(this.forwardToView,this),i.bind(e,this))}else return this.forwardToView(),require("./Deferred").resolved(this)},t.prototype.handleError=function(e){throw e},t.prototype.createModel=function(e){if(this.modelType){var t=new this.modelType(e);return t}else return{}},t.prototype.forwardToView=function(){if(this.disposed)return this;if(this.fire("modelloaded"),!this.view)this.view=this.createView();if(this.view){if(this.view.model=this.model,!this.view.container)this.view.container=this.context.container;this.fire("beforerender"),this.view.render(),this.fire("rendered"),this.initBehavior(),this.fire("entercomplete")}else{var e=require("./events");e.notifyError("No view attached to this action")}return this},t.prototype.createView=function(){return this.viewType?new this.viewType:null},t.prototype.initBehavior=i.noop,t.prototype.filterRedirect=i.noop,t.prototype.leave=function(){if(this.disposed)return this;if(this.disposed=!0,this.fire("beforeleave"),this.model){if("function"==typeof this.model.dispose)this.model.dispose();this.model=null}if(this.view){if("function"==typeof this.view.dispose)this.view.dispose();this.view=null}this.fire("leave"),this.destroyEvents()},t.prototype.redirect=function(e,t){var i=require("./locator");i.redirect(e,t)},t.prototype.reload=function(){var e=require("./locator");e.reload()},t.prototype.back=function(e){var t=this.context&&this.context.referrer,i=t||e;if(i)this.redirect(i)},i.inherits(t,n),t}),define("common/esuix/CustomSelect",["require"],function(require){function e(){this.options={selectIndex:0,content:[],style:{}}}function t(e){return document.createElement(e)}function i(e,i){var n=t(e);return n.className="custom-select-"+i,n}function n(e,t){for(var i in t)if(t.hasOwnProperty(i))e[i]=t[i];return e}function r(e){for(;e.hasChildNodes();)e.removeChild(e.firstChild)}function o(e,t){for(;e;){if(e===t)return!0;e=e.parentNode}return!1}function a(e){var t=e||window.event;return t.target||t.srcElement}function s(e,t,i){if(e.addEventListener)e.addEventListener(t,i,!1);else if(e.attachEvent)e.attachEvent("on"+t,i);else e[t]=i}function l(e,t){return e[t]?e[t].split(":")[0]||"":""}function u(e,t){return e[t]?e[t].split(":")[1]||"":""}function c(e){var t=a(e);if(!o(t,this.main))this.hideLayer()}function d(e){var t=this.body;if("block"===t.style.display)this.hideLayer();else this.showLayer(),p.apply(this)}function f(e){var t=a(e);if(t.className.indexOf("custom-select-"+y)>-1)this.setProperties({selectIndex:t.index});this.hideLayer()}function h(e){var t=this.container.offsetWidth;this.options.style.width=t,this.setProperties({style:this.options}),this.hideLayer()}function p(){var e=this.title.getBoundingClientRect(),t=this.body.offsetHeight,i=this.title.offsetHeight,n=document.documentElement.clientHeight,r=n-(e.top+i),o=v(this.title,m(this.options.layerCont));
if(t>=r)g(this.body,{top:o.top-t+b+"px",left:o.left+"px"});else g(this.body,{top:o.top+i-b+"px",left:o.left+"px"})}function g(e,t){for(var i in t)if(t.hasOwnProperty(i))e.style[i]=t[i]}function v(e,t){for(var i=0,n=0;e;)if(e!==t)i+=e.offsetTop,n+=e.offsetLeft,e=e.offsetParent;else e=null;return{top:i,left:n}}function m(e){if("string"==typeof e)return document.getElementById(e);else return null}var y="list-item",b=1;return e.prototype.init=function(e){var t=this.container=m(e.id);if(t){if(e._self=this,this.options=n(this.options,e),!this.options.style.width)this.options.style.width=t.offsetWidth;this.initHtml(this.options),this.initEvent(),t.customSelect=this}},e.prototype.initHtml=function(e){if(this.container){this.main=i("ins","main"),this.title=i("ins","title"),this.titleContent=i("ins","title-content"),this.titleInput=i("input","title-input"),this.body=i("ins","body"),this.bodyContent=i("ins","body-content"),this.bodyList=i("ins","body-list"),this.title.appendChild(this.titleContent),this.title.appendChild(this.titleInput),this.bodyContent.appendChild(this.bodyList),this.body.appendChild(this.bodyContent),this.main.appendChild(this.title),g(this.titleInput,{display:"none"});var t=e.layerCont?m(e.layerCont):document.getElementsByTagName("body")[0];t.appendChild(this.body),this.setProperties(e),this.container.appendChild(this.main)}},e.prototype.initEvent=function(){var e=this;s(this.main,"click",function(t){d.call(e,t)}),s(this.body,"click",function(t){f.call(e,t)}),s(document,"click",function(t){c.call(e,t)}),s(window,"resize",function(t){h.call(e,t)}),s(window,"scroll",function(t){e.hideLayer()})},e.prototype.showLayer=function(){this.body.style.display="block"},e.prototype.hideLayer=function(){this.body.style.display="none"},e.prototype.setProperties=function(e){var t=[];for(var i in e)if(e.hasOwnProperty(i))t.push(i);e=this.options=n(this.options,e);for(var r=0,o=t.length;o>r;r++){var a=t[r];if("function"==typeof this.repaint[a])this.repaint[a](e)}},e.prototype.getSelectText=function(){return this.getText(this.options.selectIndex)},e.prototype.getSelectValue=function(){return this.getValue(this.options.selectIndex)},e.prototype.getText=function(e){return this.options.content[e]?this.options.content[e].split(":")[0]||"":""},e.prototype.getValue=function(e){return this.options.content[e]?this.options.content[e].split(":")[1]||"":""},e.prototype.repaint={name:function(e){var t=e._self;t.titleInput.setAttribute("name",e.name)},style:function(e){var t=e._self,i=e.style;for(var n in i)if(i.hasOwnProperty(n))switch(n){case"width":var r=parseInt(i.width,10);t.main.style.width=r+"px",t.title.style.width=r-2*b+"px",t.body.style.width=r-2*b+"px";break;case"maxHeight":t.bodyList.style.maxHeight=parseInt(i.maxHeight,10)+"px";break;case"zIndex":t.body.style.zIndex=i.zIndex}},title:function(e){var t=e._self,i=e.selectIndex,n=l(e.content,i);t.titleContent.innerHTML=n,t.titleInput.value=n;var r=t.bodyList.firstChild?t.bodyList.firstChild.childNodes:[];if(r.length){for(var o=0,a=r.length;a>o;o++)r[o].className="custom-select-list-item";r[i].className="custom-select-list-item active"}},content:function(e){for(var t=e._self,n=i("ins","body-list-cont"),o=e.content||[],a=0,s=o.length;s>a;a++){var c=i("ins",y);c.innerHTML=l(o,a),c.setAttribute("value",u(o,a)),c.index=a,n.appendChild(c)}r(t.bodyList),t.bodyList.appendChild(n)},selectIndex:function(e){this.title(e)}},e}),define("common/esuix/ImgSlider",["require","jquery"],function(require){function e(){this.now=0,this.auto=!1,this.options={style:{width:130,height:80},delay:5e3}}function t(e){var t=e.style,i=n("<img>").css({width:t.width,height:t.height});i.on("load",function(){var t=e.url;if(t){var r=n("<a>").attr({href:t,target:"_blank"});r.append(i),e.container.append(r)}else e.container.append(i)}),i.attr("src",e.src)}function i(e,t){return n(e).attr("class","img-slider-"+t)}var n=require("jquery");return e.prototype.init=function(e){if(this.container=n("#"+e.id),this.container.length)this.options=e=n.extend(this.options,e),this.initHtml(e),this.initEvent()},e.prototype.initHtml=function(e){if(this.main=i("<div>","main"),this.setProperties(e),this.container.children().remove(),this.container.append(this.main),this.imgCont)this.imgWidth=-this.imgCont.children().eq(0).width()},e.prototype.initEvent=function(){this.autoPlay(),this.handler()},e.prototype.autoPlay=function(){var e=this,t=e.options.delay;e.auto=!0,clearTimeout(e.timer),e.timer=setTimeout(function(){if(!e.auto)return void clearTimeout(e.timer);if(!e.imgCont.is(":animated"))e.now++,e.play();e.timer=setTimeout(arguments.callee,t)},t)},e.prototype.stopAutoPlay=function(){clearTimeout(self.timer),this.auto=!1},e.prototype.handler=function(){var e=this,t=e.main;t.on("mouseover",function(){e.stopAutoPlay()}),t.on("mouseout",function(){e.autoPlay()}),t.on("click",function(t){var i=n(t.target),r=i.parent();if(i.is("em")&&r.hasClass("dot-item"))i=r;if(i.hasClass("dot-item")){var o=i.attr("index");if(e.now===o)return;e.now=o,e.play()}})},e.prototype.play=function(){var e=this,t=e.imgWidth,i=e.options.content.length;if(!(1>=i)){var n=e.imgCont,r=e.dotCont.children();if(!n.is(":animated"))n.animate({left:t*e.now},function(){if(e.now>=i)e.now=0,n.css("left",0);r.removeClass("active"),r.eq(e.now).addClass("active")})}},e.prototype.setProperties=function(e){var t=this,i=[];n.each(e,function(e,t){i.push(e)}),e=t.options=n.extend(t.options,e),n.each(i,function(i,n){if("function"==typeof t.repaint[n])t.repaint[n].call(t,e)})},e.prototype.repaint={style:function(e){var t=e.style;this.main.css({width:t.width,height:t.height})},content:function(e){var r=this,o=e.style,a=e.content||[];a=a.concat(),a[0]&&a.push(a[0]),r.imgCont&&r.imgCont.remove(),r.imgCont=i("<ul>","content"),n.each(a,function(e,i){var a=n("<li>").css({width:o.width,height:o.height});t({container:a,src:i.img,url:i.url,style:r.options.style}),r.imgCont.append(a)}),r.main.append(r.imgCont),r.setProperties({dot:e})},dot:function(e){var t=this,r=e.content||[];if(t.dotCont&&t.dotCont.remove(),!(r.length<=1))t.dotCont=i("<div>","dot-content"),n.each(r,function(e,i){var r=n("<span>");if(r.addClass("dot-item"),r.attr("index",e),!e)r.addClass("active");r.append(n("<em>")),t.dotCont.append(r)}),t.main.append(t.dotCont)}},e}),define("newstyleManage/pretreat",["require","common/esuix/CustomSelect","common/esuix/ImgSlider"],function(require){function e(e){for(var t=e.itemsExt,n=0,r=t.length;r>n;n++){var o=t[n];if(o&&0!==+o.isShow){if(o.subItems){var a=new i;a.init({id:"node_select_wrap_"+n,layerCont:"nb-nodeboard",name:o.name,content:o.subItems,readonly:"readonly",selectIndex:0,style:{width:220,maxHeight:300,zIndex:99}})}}else;}}function t(e){for(var t=[],i=e.webim,o=new n,a=0,s=i.banners.length;s>a;a++){var l={};if(l.img=i.banners[a].img,l.url="",""===l.img)l.img=r+"webim-skin-logo-"+i.skinIndex+".png";t.push(l)}o.init({id:"bannerContainer",content:t})}var i=require("common/esuix/CustomSelect"),n=require("common/esuix/ImgSlider"),exports={},r="http://s.goutong.baidu.com/settings/resource/styleManageBg/";return exports.init=function(i,n){if(n)switch(n){case"pcmessageboard":e(i);break;case"pcwebim":t(i)}},exports}),define("er/URL",["require","./util"],function(require){function e(i,n,r){i=i||"/",n=n||"",r=r||"~",this.toString=function(){return n?i+r+n:i},this.getPath=function(){return i},this.getSearch=function(){return n};var o=null;this.getQuery=function(i){if(!o)o=e.parseQuery(n);return i?o[i]:t.mix({},o)}}var t=require("./util");return e.prototype.compare=function(t){if("string"==typeof t)t=e.parse(t);var i={},n=this.getPath(),r=t.getPath();if(n===r)i.path=!1;else i.path={key:"path",self:n,other:r};var o=this.getQuery(),a=t.getQuery(),s={},l=[],u=!1;for(var c in o)if(o.hasOwnProperty(c)){var d=o[c],f=a[c];if(d!==f){u=!0;var h={key:c,self:d,other:f};l.push(h),s[c]=h}}for(var c in a)if(a.hasOwnProperty(c)&&!o.hasOwnProperty(c)){u=!0;var h={key:c,self:void 0,other:a[c]};l.push(h),s[c]=h}return i.queryDifference=l,i.query=u?s:!1,i},e.parse=function(i,n){var r={querySeparator:"~"};n=t.mix(r,n);var o=i.indexOf(n.querySeparator);if(o>=0)return new e(i.slice(0,o),i.slice(o+1),n.querySeparator);else return new e(i,"",n.querySeparator)},e.withQuery=function(i,n,r){i+="";var o={querySeparator:"~"};r=t.mix(o,r);var a=i.indexOf(r.querySeparator)<0?r.querySeparator:"&",s=e.serialize(n),l=i+a+s;return e.parse(l,r)},e.parseQuery=function(e){for(var t=e.split("&"),i={},n=0;n<t.length;n++){var r=t[n];if(r){var o=r.indexOf("="),a=0>o?decodeURIComponent(r):decodeURIComponent(r.slice(0,o)),s=0>o?!0:decodeURIComponent(r.slice(o+1));if(i.hasOwnProperty(a)){if(s!==!0)i[a]=[].concat(i[a],s)}else i[a]=s}else;}return i},e.serialize=function(e){if(!e)return"";var t="";for(var i in e)if(e.hasOwnProperty(i)){var n=e[i];t+="&"+encodeURIComponent(i)+"="+encodeURIComponent(n)}return t.slice(1)},e.empty=new e,e}),define("common/esuix/Dialog",["require","esui/Button","esui/Panel","esui/lib","esui/controlHelper","esui/Control","esui/main","esui/Dialog"],function(require){function e(){r.apply(this,arguments)}require("esui/Button"),require("esui/Panel");var t=require("esui/lib"),i=require("esui/controlHelper"),n=(require("esui/Control"),require("esui/main")),r=require("esui/Dialog");return e.prototype.type="DialogConfirm",e.confirm=function(e,o){function a(e,t){e.fire(t),e.dispose()}var s=o||"dialog-confirm",l=t.encodeHTML(e.title)||document.title,u=e.content,c=t.encodeHTML(e.okText)||r.OK_TEXT,d=t.encodeHTML(e.cancelText)||r.CANCEL_TEXT,f={type:"confirm",skin:"warn",dialogType:"confirm",title:l};t.extend(f,e);var h=['<div class="${prefix}-icon ${prefix}-icon-${type}"></div>','<div class="${prefix}-cont"><div class="${prefix}-text">${content}</div>','<div class="${prefix}-btn-con">${footHtml}</div></div>'].join("");f.id=i.getGUID(s),f.closeButton=!0,f.mask=!0,f.alwaysTop=!0;var p=f.type;f.type=null,f.needFoot=!1;var g=n.create("Dialog",f);g.appendTo(document.body),g.show();var v="",m=[{name:"btnOk",content:c,handler:"ok"},{name:"btnCancel",content:d,cancelBtn:!0,handler:"cancel"}];f.btnSet=f.btnSet?f.btnSet:m;for(var y="alert"===f.dialogType?1:f.btnSet.length,b=0,w=y;w>b;b++)v+='<div data-ui="type:Button;id:'+f.btnSet[b].name+";childName:"+f.btnSet[b].name+';" class="'+(f.btnSet[b].cancelBtn?"ui-button-circle":"ui-button-ok")+'">'+f.btnSet[b].content+"</div>";g.setTitle(l),g.setContent(t.format(h,{type:p,content:u,prefix:g.helper.getPrimaryClassName(),footHtml:v}));for(var b=0,w=y;w>b;b++)g.getBody().getChild(f.btnSet[b].name).on("click",t.curry(a,g,f.btnSet[b].handler||"btnClickHandler"+b+1));return g},e.alert=function(i){var n={skin:"warn",type:"alert",dialogType:"alert"},r=t.extend(n,i);return e.confirm(r,"dialog-alert")},t.inherits(e,r),require("esui/main").register(e),e}),define("er/assert",[],function(){if(window.DEBUG){var e=function(e,t){if(!e)throw new Error(t)};return e.has=function(t,i){e(null!=t,i)},e.equals=function(t,i,n){e(t===i,n)},e.hasProperty=function(t,i,n){e(null!=t[i],n)},e.lessThan=function(t,i,n){e(i>t,n)},e.greaterThan=function(t,i,n){e(t>i,n)},e.lessThanOrEquals=function(t,i,n){e(i>=t,n)},e.greaterThanOrEquals=function(t,i,n){e(t>=i,n)},e}else{var e=function(){};return e.has=e,e.equals=e,e.hasProperty=e,e.lessThan=e,e.greaterThan=e,e.lessThanOrEquals=e,e.greaterThanOrEquals=e,e}}),define("er/ajax",["require","./util","mini-event/EventTarget","./assert","./Deferred"],function(require){function e(e,t){for(var i=e?encodeURIComponent(e):"",n=[],r=0;r<t.length;r++){var o=t[r];n[r]=this.serializeData("",o)}return i?i+"="+n.join(","):n.join(",")}function t(e,t){if(1===arguments.length)t=e,e="";if(null==t)t="";var i=this.serializeData.getKey,n=e?encodeURIComponent(e):"",r=Object.prototype.toString.call(t);switch(r){case"[object Array]":return this.serializeArray(e,t);case"[object Object]":var o=[];for(var a in t){var s=i(a,e),l=this.serializeData(s,t[a]);o.push(l)}return o.join("&");default:return n?n+"="+encodeURIComponent(t):encodeURIComponent(t)}}function i(){this.hooks={serializeData:t,serializeArray:e},this.config={cache:!1,timeout:0,charset:""}}var n=require("./util"),r="_";t.getKey=function(e,t){return t?t+"."+e:e},n.inherits(i,require("mini-event/EventTarget")),i.prototype.request=function(e){if("function"==typeof this.hooks.beforeExecute)this.hooks.beforeExecute(e);var t=require("./assert");t.hasProperty(e,"url","url property is required");var i={method:"POST",data:{},cache:this.config.cache,timeout:this.config.timeout,charset:this.config.charset},n=require("./util");e=n.mix(i,e);var o=require("./Deferred"),a=new o;if("function"==typeof this.hooks.beforeCreate){var s=this.hooks.beforeCreate(e,a);if(s===!0){var l=a.promise;return l.abort=function(){},l.setRequestHeader=function(){},l}}var u=window.XMLHttpRequest?new XMLHttpRequest:new window.ActiveXObject("Microsoft.XMLHTTP");n.mix(u,e.xhrFields);var l=a.promise,c={abort:function(){u.onreadystatechange=null;try{u.abort()}catch(e){}if(!l.status)l.status=0;l.readyState=u.readyState,l.responseText="",l.responseXML="",a.reject(l)},setRequestHeader:function(e,t){u.setRequestHeader(e,t)},getAllResponseHeaders:function(){return u.getAllResponseHeaders()},getResponseHeader:function(e){return u.getResponseHeader(e)},getRequestOption:function(t){return e[t]}};n.mix(l,c);var d={xhr:l,options:e};l.then(n.bind(this.fire,this,"done",d),n.bind(this.fire,this,"fail",d));var f=function(){if(4===u.readyState){var t=l.status||u.status;if(1223===t)t=204;if(l.status=l.status||t,l.readyState=u.readyState,l.responseText=u.responseText,l.responseXML=u.responseXML,"function"==typeof this.hooks.afterReceive)this.hooks.afterReceive(l,e);if(200>t||t>=300&&304!==t)return void a.reject(l);var i=u.responseText;if("json"===e.dataType)try{i=n.parseJSON(i)}catch(r){return l.error=r,void a.reject(l)}if("function"==typeof this.hooks.afterParse)try{i=this.hooks.afterParse(i,l,e)}catch(r){return l.error=r,void a.reject(l)}a.resolve(i)}};u.onreadystatechange=n.bind(f,this);var h=e.method.toUpperCase(),p={};if("GET"===h)n.mix(p,e.data);if(e.cache===!1)p[r]=+new Date;var g=this.hooks.serializeData("",p,"application/x-www-form-urlencoded"),v=e.url;if(g){var m=v.indexOf("?")>=0?"&":"?";v+=m+g}if(u.open(h,v,!0),"function"==typeof this.hooks.beforeSend)this.hooks.beforeSend(l,e);if("GET"===h)u.send();else{var y=e.contentType||"application/x-www-form-urlencoded",g=this.hooks.serializeData("",e.data,y,l);if(e.charset)y+=";charset="+e.charset;u.setRequestHeader("Content-Type",y),u.send(g)}if(e.timeout>0){var b=function(){this.fire("timeout",{xhr:l,options:e}),l.status=408,l.abort()},w=setTimeout(n.bind(b,this),e.timeout);l.ensure(function(){clearTimeout(w)})}return l},i.prototype.get=function(e,t,i){var n={method:"GET",url:e,data:t,cache:i||this.config.cache};return this.request(n)},i.prototype.getJSON=function(e,t,i){var n={method:"GET",url:e,data:t,dataType:"json",cache:i||this.config.cache};return this.request(n)},i.prototype.post=function(e,t,i){var n={method:"POST",url:e,data:t,dataType:i||"json"};return this.request(n)},i.prototype.log=function(e,t){var i=new Image,n=window.ER_LOG_POOL||(window.ER_LOG_POOL={}),r=+new Date;n[r]=i,i.onload=i.onerror=i.onabort=function(){i.onload=i.onerror=i.onabort=null,n[r]=null,i=null};var o=this.hooks.serializeData("",t,"application/x-www-form-urlencoded");if(o){var a=e.indexOf("?")>=0?":":"?";e+=a+o}i.src=e};var o=new i;return o.Ajax=i,o}),define("common/util/ejson",["require","er/Deferred","er/ajax","er/util","common/esuix/Dialog"],function(require){function e(e,t){var n,r=this.getEjsonStatus(t);if(!r)return void e.resolve("object"==typeof t.data?t.data:{});if(r>0&&"function"!=typeof a.sysErrHandler)return n=t.statusInfo?t.statusInfo:this.BIZ_STATUS_TEXT[r],i(r,n),void e.reject(r,n);else if(r>0&&"function"==typeof a.sysErrHandler)return a.sysErrHandler("object"==typeof t?t:{}),void e.abort();n=t.statusInfo,e.resolve({hasBizError:!0,status:r,statusInfo:n})}function t(e,t){var n,r;switch(t.status){case 500:n=1003,r=this.BIZ_STATUS_TEXT[1003];break;case 408:n=1002,r=this.BIZ_STATUS_TEXT[1002]}if(n>999)i(n,r);e.resolve({hasBizError:!0,status:n,statusInfo:r})}function i(e,t){var i=require("common/esuix/Dialog"),n={title:"",content:'<p class="info-title">'+t+"</p>",width:400,skin:"warn"};switch(e){case 1007:n.onok=function(){window.location.reload()};break;case 1006:n.onok=function(){window.location.href="admin.html"};break;case 1004:return void(window.location.href="error/1004.html");case 1005:return void(window.location.href=t);case 1e3:case 1001:return void(window.location.href=t);case 1003:case 1002:}i.alert(n)}var n=require("er/Deferred"),r=require("er/ajax"),o=require("er/util"),a={get:function(e,t,i,n,a,s){var l={method:"GET",url:e,data:t,component:n,cache:i||r.config.cache,sysErrHandler:a};return s&&o.mix(l,s),this.request(l)},post:function(e,t,i,n,r,a){var s={method:"POST",url:e,component:n,data:t,sysErrHandler:r};return a&&o.mix(s,a),this.request(s)},request:function(i){var a=this;this.sysErrHandler=i.sysErrHandler||!1,i.dataType="json";var s=r.request(i),l=new n;s.then(o.bind(e,a,l),o.bind(t,a,l)),l.abort=o.bind(s.abort,s);var u=i.component;if(u)u.setDisabled(!0),l.then(function(){u.setDisabled(!1)},function(){u.setDisabled(!1)});return l},getEjsonStatus:function(e){var t=this,i=0;if(!e)i=t.BIZ_STATUS_CODE.EMPTY_RESPONSE;else if("undefined"==typeof e.status)i=t.BIZ_STATUS_CODE.NO_STATUS;else if(isNaN(e.status-0))i=t.BIZ_STATUS_CODE.NAN_STATUS;else if(e.status>0)i=e.status;return i},BIZ_STATUS_CODE:{UNAUTHERIZED:1e3,UNAUTHORIZED:1001,TIMEOUT:1002,SYSTEM_FATAL:1003,REQURET_FATAL:1004,UNAUTHERIZED_DIRECT_JUMP:1005,EJSON_EMPTY_RESPONSE:1100,EJSON_NO_STATUS:1101,EJSON_NAN_STATUS:1102},BIZ_STATUS_TEXT:{1e3:"",1001:"",1002:"",1003:"",1004:"",1100:"",1101:"",1102:""},isFatalError:function(e){return e>999}};return a}),define("common/util/clientInterface",["require","common/util/ejson","jquery"],function(require){function e(){for(var e="clientCallback";;){var t=e+parseInt(1e4*Math.random(),10);if(!window[t])return t;else;}}var exports={},t=require("common/util/ejson"),i=require("jquery"),n=!!window.BDHScript,r=!1;try{r=!(!process||!process.__node_webkit)}catch(o){r=!1}return exports.clientData=function(o,a){if("object"!=typeof a)a={reqParam:a};if(n||r){var s=e(),l=i.Deferred,u=l();if(window[s]=function(e){u.resolve(e)},a.callbackName=s,n)window.BDHScript.throwEvent(o,JSON.stringify(a));else if(r){var c=nwDispatcher.requireNwGui(),d=c.Window.get().id;a.window=window,global.rainbowNativeCore.emit(d+":"+o,a)}return function(){return u.promise()}}return function(){var e="/settings_src/src/client/mock/"+o+".json";return t.post(e,a)}},exports.notify=function(e,t){if("object"!=typeof t)t={reqParam:t};if(n)console.log("notify name: "+e+", param:"+JSON.stringify(t)),window.BDHScript.throwEvent(e,JSON.stringify(t));else if(r){var i=nwDispatcher.requireNwGui(),o=i.Window.get().id;t.window=window,global.rainbowNativeCore.emit(o+":"+e,t)}},exports}),define("newstyleManage/lib",["require","er/URL"],function(require){var exports={},e=require("er/URL");return exports.getHashSearchObj=function(){var t=e.parse(location.href).getSearch();return e.parseQuery(t)},exports.postForm=function(e,t){if("[object Object]"===Object.prototype.toString.call(e)){var i=document.createElement("form");i.action=t,i.target="_blank",i.method="post";new FormData;for(var n in e)if(e.hasOwnProperty(n)){var r=document.createElement("input");r.type="hidden",r.name=n,r.value=e[n],i.appendChild(r)}i.submit()}else return e},exports}),define("newstyleManage/config",[],function(){var e=["","","","","","","","","",""];return{availableTarget:["icon","invite","webim","messageboard"],availableDevice:["pc","mobile"],targetNameCN:["","","",""],pc:{icon:{defaultSkins:e,sizeRange:{width:{max:350,min:0},height:{max:600,min:0}},pos:["left-top","left-center","left-bottom","right-top","right-center","right-bottom"],hasPreview:!0,editorConfig:{}},invite:{defaultSkins:e,sizeRange:{width:{max:680,min:290},height:{max:320,min:125}},pos:["left-bottom","middle","right-bottom"],hasPreview:!0,buttonTypes:[{name:"",value:1},{name:"",value:0},{name:"",value:2}],editorConfig:{}},webim:{defaultSkins:e,editorConfig:{initialStyle:"p{font: 13px 'Microsoft YaHei';font-weight: normal;font-style: normal;color: '#000'}"}},messageboard:{defaultSkins:e,pos:["left-bottom","right-bottom"],hasPreview:!0,editorConfig:{}}},mobile:{icon:{defaultSkins:["","","","","",""],pos:["left-center","right-center","right-top","left-top","left-bottom","right-bottom"],sizeRange:{height:{unit:"%",max:30,min:10},width:{unit:"%",max:30,min:10}},editorConfig:{}},invite:{defaultSkins:["","",""],pos:["middle","bottom"],sizeRange:{height:{unit:"%",max:50,min:20},width:{unit:"%",max:100,min:70}},editorConfig:{}},webim:{defaultSkins:e,editorConfig:{}},messageboard:{defaultSkins:e,editorConfig:{}}},URLRule:"^((https|http|ftp|rtsp|mms)?://)?(([0-9a-z_!~*'().&=+$%-]+: )?[0-9a-z_!~*'().&=+$%-]+@)?(([0-9]{1,3}\\.){3}[0-9]{1,3}|([0-9a-z_!~*'()-]+\\.)*([%0-9a-z][%0-9A-Za-z-]{0,61})?[0-9a-z]\\.[a-z]{2,6})(:[0-9]{1,4})?((/?)|(/[-%A-Z0-9a-z_!~*'().;?:@&=+$,%#-]+)+/?)$",alertDialogParam:{title:document.title,skin:"warn",width:500},confirmDialogParam:{title:document.title,width:500,skin:"warn"},errorTipMap:{"webim.logoURL":"","invite-img-upload":"","icon-img-upload":"",richGreetings:"50",bannerCtrl:""},resource:"http://s.goutong.baidu.com/settings/resource/styleManageBg/"}}),define("newstyleManage/tips",["require","jquery","./config"],function(require){var e=require("jquery"),t=require("./config"),exports={};return exports.showToast=function(t,i,n){var r=e(".toast-tip").filter("#"+t);r.stop(!0,!0).hide().text(i).show().fadeOut(n)},exports.hideAllErrorTip=function(){e(".error-tip").hide()},exports.hideErrorTip=function(t){e('[data-tip-for="'+t+'"]').hide()},exports.showAllErrorTip=function(i){i.forEach(function(i){e('[data-tip-for="'+i+'"]').text(t.errorTipMap[i]).show()})},exports}),define("newstyleManage/validate",["require","jquery"],function(require){var e=require("jquery"),exports={};return exports.validate=function(t){var i=e("[data-validate]").not("[disabled]");i=i.filter(function(){var t=e(this),i=t.closest(".radio-tab-page");if(i.length<1)return!0;else return"block"===i.css("display")});var n=[];return i.each(function(){var i,r,o=e(this),a=o.attr("data-validate-type");switch(a){case"img":if(r=o.attr("id"),i=t.get(r),!i.getValidity())n.push(r);break;case"banner":if(r=o.attr("id"),i=t.get(r),!i.getValidity().pass)n.push(r);break;case"form":if(!o[0].checkValidity())n.push(o.attr("name"));break;case"ueditor":var s=o.attr("data-ueditor-id"),l=UE.getEditor(s),u=+o.attr("data-max-length"),c=o.attr("data-error-tip-id");if(l.getContentLength(!0)>u)n.push(c)}}),{result:0===n.length,errorTipIDCollection:n}},exports}),define("common/util/datasource",["require","common/util/ejson","er/util","esui/Dialog"],function(require){var e=require("common/util/ejson"),t={constant:function(e){return function(){return e}},remote:function(t,i){return function(n){return i=require("er/util").mix({url:t,dataType:"json"},i),e.request(i)}},jsonp:function(e){return function(t){var i=new $.Deferred,n={dataType:"jsonp",jsonp:"callback",data:e.params||{}};return $.ajax(e.url,n).then(function(e){if(200!==e.status)require("esui/Dialog").alert({type:"warning",content:""});var e=e.data;t.set("data",e||{}),i.resolve()},function(){require("esui/Dialog").alert({type:"warning",content:""}),i.reject()}),i}}};return t}),define("newstyleManage/ajaxURL",[],function(){var e=window.nbcps.root;return{getStyleURL:e+"/styleManage/findStyleContent.action",saveStyleURL:e+"/styleManage/updateStyle.action",resetStyleURL:e+"/styleManage/resetDefaultStyle.action"}}),define("newstyleManage/StyleManageModel",["require","er/util","ef/UIModel","../common/util/datasource","underscore","jquery","./ajaxURL","./config","common/util/ejson"],function(require){function e(e){i.apply(this,arguments);var t=this,r={"reqParam.styleId":+t.get("styleId"),"reqParam.type":+t.get("typeIndex")+1},o=e.isReset?a.resetStyleURL:a.getStyleURL;this.datasource={styleContent:n.remote(o,{method:"GET",data:r})}}var t=require("er/util"),i=require("ef/UIModel"),n=require("../common/util/datasource"),r=require("underscore"),o=require("jquery"),a=require("./ajaxURL"),s=require("./config"),l=require("common/util/ejson");return e.prototype.prepare=function(){var e=this,t=e.get("device"),i=e.get("typeIndex"),n=s.availableTarget[i];e.set("target",n);var r=JSON.parse(e.get("styleContent").styleContent);e.fill(r),e.set("styleContentBackUp",o.extend(!0,{},r)),e.set("unsavedStyleContent",{});var a,l=[];for(a in r)l.push(a);e.set("styleItemList",l),e.set("defaultSkins",s[t][n].defaultSkins),e.set("posConfig",s[t][n].pos),e.set("buttonTypes",s[t][n].buttonTypes),e.set("URLRule",s.URLRule),e.set("hasChange",!1),e.set("resource",s.resource),e.set("hasPreview",s[t][n].hasPreview);var u=s[t][n].sizeRange;if(u)for(a in u){var c="min"+a,d="max"+a,f=a+"Unit",h=u[a].max,p=u[a].min,g=u[a].unit||"px";e.set(c,p),e.set(d,h),e.set(f,g)}},e.prototype.getStyleContent=function(){var e,t=this.get("styleItemList"),i={},n=t.length;for(e=0;n>e;e++)i[t[e]]=this.get(t[e]);return i=this.styleContentProcess(i),this.set("unsavedStyleContent",o.extend(!0,{},i)),JSON.stringify(i)},e.prototype.saveStyle=function(e){var t={},i=this.get("target");return"messageboard"===i?i="messageBoard":"",this.set("hasChange",!1),t["reqParam.styleId"]=this.get("styleId"),t["reqParam."+i+"Setting"]=this.getStyleContent(),l.post(a.saveStyleURL,t,"json",e.get("save"))},e.prototype.savePreviewStyle=function(e,t,i){return l.post(e,t,"json",i)},e.prototype.styleContentProcess=function(e){var t=this,i=t.get("device")+t.get("target"),n=t.get("styleContentBackUp");switch(i){case"pcwebim":if(1===+e.isWebim)delete e.webimLight;else delete e.webim,delete e.slogan;e=r.extend(n,e)}return e},t.inherits(e,i),e}),define("esui/Tab",["require","underscore","./lib","./Control","./painters","./main"],function(require){function e(){s.apply(this,arguments)}function t(e){for(var t=e.target,i=t;i&&"li"!==i.nodeName.toLowerCase();)i=i.parentNode;if(i&&"li"===i.nodeName.toLowerCase())for(var n=i.parentNode,r=a.getChildren(n),o=0;o<r.length;o++)if(r[o]===i){if(this.helper.isPart(t,"close"))this.removeAt(o);else this.set("activeIndex",o);return}}function i(e,t,i,n){var r=document.createElement("li");if(e.helper.addPartClasses("item",r),i)e.helper.addPartClasses("item-active",r);return r.innerHTML=e.getContentHTML(t,n),r}function n(e){var t=e.helper.getPart("navigator"),n=t.parentNode,r=t.nextSibling;t.innerHTML="",t.parentNode.removeChild(t);for(var o=0;o<e.tabs.length;o++){var a=e.tabs[o],s=e.activeIndex===o,l=i(e,a,s,e.allowClose);t.appendChild(l)}n.insertBefore(t,r)}function r(e,t){for(var i=0;i<e.tabs.length;i++){var n=e.tabs[i];if(n.panel){var r=a.g(n.panel);if(r)r.style.display=i===t?"":"none"}var o=e.helper.getPart("navigator"),s=a.getChildren(o),l=s[i],u=i===t?"addPartClasses":"removePartClasses";e.helper[u]("item-active",l)}var c={activeIndex:t,tab:e.tabs[t]};e.fire("activate",c)}var o=require("underscore"),a=require("./lib"),s=require("./Control");return e.prototype.type="Tab",e.prototype.initOptions=function(e){var t={tabs:[],activeIndex:0,allowClose:!1,orientation:"horizontal"};o.extend(t,e),t.activeIndex=t.activeIndex||0;var i=a.getChildren(this.main);if(i.length){for(var n=[],r=0;r<i.length;r++){var s=i[r];if("navigator"===s.getAttribute("data-role")){t.tabs=[],this.navigatorElement=s;for(var i=a.getChildren(s),r=0;r<i.length;r++){var l=i[r],u={title:a.getText(l),panel:l.getAttribute("data-for")};t.tabs.push(u)}break}else{var u={title:s.getAttribute("title"),panel:s.id};n.push(u)}}if(!t.tabs.length)t.tabs=n}if("string"==typeof t.activeIndex)t.activeIndex=+t.activeIndex;this.setProperties(t)},e.prototype.initStructure=function(){var e=this.navigatorElement;if(this.navigatorElement=null,!e)e=document.createElement("ul"),this.main.insertBefore(e,this.main.firstChild||null);e.id=this.helper.getId("navigator"),this.helper.addPartClasses("navigator",e)},e.prototype.initEvents=function(){this.helper.addDOMEvent("navigator","click",t)},e.prototype.contentTemplate="<span>${title}</span>",e.prototype.getContentHTML=function(e,t){var i=a.format(this.contentTemplate,{title:o.escape(e.title)});if(t)i+='<span class="'+this.helper.getPartClassName("close")+'"></span>';return i},e.prototype.setProperties=function(e){if(e.tabs){if(null==e.activeIndex){for(var t=this.tabs[this.activeIndex],i=-1,n=0;n<e.tabs.length;n++)if(e.tabs[n]===t){i=n;break}if(-1===i)this.activeIndex=-1,e.activeIndex=0;else this.activeIndex=i}if(null!=e.allowClose)this.allowClose=e.allowClose,delete e.allowClose}s.prototype.setProperties.apply(this,arguments)},e.prototype.repaint=require("./painters").createRepaint(s.prototype.repaint,{name:["tabs","allowClose"],paint:n},{name:"activeIndex",paint:r},{name:"orientation",paint:function(e,t){e.removeState("vertical"),e.removeState("horizontal"),e.addState(t)}}),e.prototype.activate=function(e){for(var t=0;t<this.tabs.length;t++)if(this.tabs[t]===e)this.set("activeIndex",t)},e.prototype.add=function(e){this.insert(e,this.tabs.length)},e.prototype.insert=function(e,t){t=Math.min(t,this.tabs.length),t=Math.max(t,0),this.tabs.splice(t,0,e);var n=i(this,e,!1,this.allowClose),o=this.helper.getPart("navigator"),s=a.getChildren(o);if(o.insertBefore(n,s[t]||null),1===this.tabs.length)this.activeIndex=0,r(this,0);else{if(t<=this.activeIndex)this.activeIndex++;if(e.panel){var l=a.g(e.panel);if(l)l.style.display="none"}}this.fire("add",{tab:e,index:t})},e.prototype.remove=function(e){for(var t=0;(t=o.indexOf(this.tabs,e,t))>=0;)this.removeAt(t)},e.prototype.removeAt=function(e){var t=this.tabs.splice(e,1)[0],i=this.helper.getPart("navigator");if(t){var n=a.getChildren(i),o=n[e];if(o.parentNode.removeChild(o),e<this.activeIndex)this.activeIndex--;else if(e===this.activeIndex)this.activeIndex=Math.min(this.activeIndex,this.tabs.length-1),r(this,this.activeIndex);if(t.panel){var s=a.g(t.panel);if(s)s.style.display="none"}this.fire("remove",{tab:t,index:e})}},e.prototype.getActiveTab=function(){return this.get("tabs")[this.get("activeIndex")]},a.inherits(e,s),require("./main").register(e),e}),define("esui/Validity",["require","underscore","./lib","./Control","./Helper","./painters","./main"],function(require){function e(){r.apply(this,arguments)}function t(e,t){var i=e.target,n=null;if(i||e.targetType){var r={type:e.targetType||i.type,skin:i&&i.skin};n=new o(r)}var a=e.helper.getPartClasses();if(n)a.push.apply(a,n.getPartClasses("validity-label"));if(t)if(a.push.apply(a,e.helper.getPartClasses(t)),n)a.push.apply(a,n.getPartClasses("validity-label-"+t));if(i&&i.isHidden()||e.isHidden())if(a.push.apply(a,e.helper.getStateClasses("hidden")),i)a.push.apply(a,i.helper.getPartClasses("validity-label-hidden"));return a}var i=require("underscore"),n=require("./lib"),r=require("./Control"),o=require("./Helper");return e.prototype.type="Validity",e.prototype.createMain=function(){return document.createElement("label")},e.prototype.initOptions=function(t){var n=i.extend({},e.defaultProperties,t);r.prototype.initOptions.call(this,n)},e.prototype.display=function(e,t,i){this.main.innerHTML=t},e.prototype.repaint=require("./painters").createRepaint(r.prototype.repaint,{name:["target","targetType"],paint:function(e){var i=e.validity?e.validity.getValidState():"",n=t(e,i);e.main.className=n.join(" ")}},{name:"focusTarget",paint:function(e,t){if("label"===e.main.nodeName.toLowerCase())if(t&&t.id)n.setAttribute(e.main,"for",t.id);else n.removeAttribute(e.main,"for")}},{name:"validity",paint:function(e,n){var r=n&&n.getValidState(),o=t(e,r);if(e.main.className=o.join(" "),e.disposeChildren(),
n){var a=n.getCustomMessage();if(!a){var s=i.find(n.getStates(),function(e){return!e.getState()});a=s&&s.getMessage()}if(e.display(r,a||"",n),e.helper.initChildren(),a)e.show();else e.hide()}else e.main.innerHTML="",e.hide()}}),e.prototype.dispose=function(){if(!this.helper.isInStage("DISPOSED")){if(this.target)this.target.validityLabel=null,this.target=null;if(this.focusTarget=null,this.main.parentNode)this.main.parentNode.removeChild(this.main);r.prototype.dispose.apply(this,arguments)}},n.inherits(e,r),require("./main").register(e),e}),define("esui/validator/Validity",["require","underscore"],function(require){function e(){this.states=[],this.stateIndex={},this.customMessage="",this.customValidState=null}var t=require("underscore");return e.prototype.addState=function(e,t){if(this.stateIndex[e]){if(this.stateIndex[e]===t)return;for(var i=0;i<this.states.length;i++)if(this.states[i]===this.stateIndex[e]){this.states.splice(i,1);break}}this.states.push(t),this.stateIndex[e]=t},e.prototype.getState=function(e){return this.stateIndex[e]||null},e.prototype.getStates=function(){return this.states.slice()},e.prototype.getCustomMessage=function(){return this.customMessage},e.prototype.setCustomMessage=function(e){this.customMessage=e},e.prototype.setCustomValidState=function(e){this.customValidState=e},e.prototype.isValid=function(){return t.all(this.getStates(),function(e){return e.getState()})},e.prototype.getValidState=function(){return this.customValidState||(this.isValid()?"valid":"invalid")},e}),define("esui/InputControl",["require","./lib","./controlHelper","./Control","./Validity","./validator/Validity","./main"],function(require){function e(e){if(e=e?t.extend({},e):{},e.main&&!e.name)e.name=e.main.getAttribute("name");n.call(this,e)}var t=require("./lib"),i=require("./controlHelper"),n=require("./Control"),r=require("./Validity"),o=require("./validator/Validity"),a=require("./main");return e.prototype={constructor:e,ignoreStates:n.prototype.ignoreStates.concat("read-only"),getCategory:function(){return"input"},getFocusTarget:function(){return null},getValue:function(){return this.stringifyValue(this.getRawValue())},setValue:function(e){var t=this.parseValue(e);this.setRawValue(t)},getRawValue:function(){return this.rawValue},setRawValue:function(e){this.setProperties({rawValue:e})},setProperties:function(e){var t=e.value;if(delete e.value,null!=t&&null==e.rawValue)e.rawValue=this.parseValue(t);if(this.hasOwnProperty("readOnly"))this.readOnly=!!this.readOnly;return n.prototype.setProperties.call(this,e)},repaint:i.createRepaint(n.prototype.repaint,{name:"disabled",paint:function(e,t){var i=e.main.nodeName.toLowerCase();if("input"===i||"select"===i||"textarea"===i)e.main.disabled=t}},{name:"readOnly",paint:function(e,t){var i=t?"addState":"removeState";e[i]("read-only");var n=e.main.nodeName.toLowerCase();if("input"===n||"select"===n||"textarea"===n)e.main.readOnly=t}},{name:"hidden",paint:function(e,n){var r=e.getValidityLabel(!0);if(r){var o=a.getConfig("uiClassPrefix"),s=[].concat(o+"-hidden",o+"-validity-hidden",i.getPartClasses(e,"validity-hidden")),l=e.isHidden()?"addClasses":"removeClasses";t[l](r,s)}}}),stringifyValue:function(e){return null!=e?e+"":""},parseValue:function(e){return e},setReadOnly:function(e){e=!!e,this[e?"addState":"removeState"]("read-only")},isReadOnly:function(){return this.hasState("read-only")},getValidationResult:function(){var e=new o,t={validity:e};t=this.fire("beforevalidate",t);for(var i=a.createRulesByControl(this),n=0,r=i.length;r>n;n++){var s=i[n];e.addState(s.getName(),s.check(this.getValue(),this))}if(!e.isValid())t=this.fire("invalid",t);return this.fire("aftervalidate",t),e},checkValidity:function(){var e=this.getValidationResult();return e.isValid()},validate:function(){var e=this.getValidationResult();return this.showValidity(e),e.isValid()},getValidityLabel:function(e){if(!i.isInStage(this,"RENDERED"))return null;var t=this.validityLabel&&this.viewContext.get(this.validityLabel);if(!t&&!e){var n={id:this.id+"-validity",viewContext:this.viewContext};if(t=new r(n),this.main.nextSibling)t.insertBefore(this.main.nextSibling);else t.appendTo(this.main.parentNode);this.validityLabel=t.id}return t},removeValidity:function(){if(this.validity)this.removeState("validity-"+this.validity.getValidState())},showValidity:function(e){if(this.validity)this.removeState("validity-"+this.validity.getValidState());this.validity=e,this.addState("validity-"+e.getValidState());var t=this.getValidityLabel();if(t){var i={target:this,focusTarget:this.getFocusTarget(),validity:e};t.setProperties(i)}},showValidationMessage:function(e,t){t=t||"";var i=new o;i.setCustomValidState(e),i.setCustomMessage(t),this.showValidity(i)},dispose:function(){if(!i.isInStage(this,"DISPOSED")){var e=this.getValidityLabel(!0);if(e)e.dispose();n.prototype.dispose.apply(this,arguments)}}},t.inherits(e,n),e}),define("common/esuix/RangeInput",["require","underscore","esui/lib","esui/main","esui/InputControl","esui/painters"],function(require){function e(e){u.apply(this,arguments)}function t(e){var t=[48,49,50,51,52,53,54,55,56,57,96,97,98,99,100,101,102,103,104,105],i=[8];if(t.indexOf(+e.keyCode)<0&&i.indexOf(+e.keyCode)<0)e.preventDefault()}function i(e){var t=e.target,i=parseInt(t.value,10);if(!a.isNumber(i)||isNaN(i))t.value=t.value.replace(/\D/,"");if(isNaN(i))t.value="";else if(t.value=i,this.maximum&&i>this.maximum)t.value=+this.maximum,this.fire("change");else if(this.minimum&&i<this.minimum)t.value=+this.minimum,this.fire("change")}function n(e,t){var i=s.g(e.inputId);if(!c){var n=e.helper.getPart("placeholder");if("boolean"!=typeof t)t=document.activeElement===i;if(!t&&!e.getRawValue())e.helper.removePartClasses("placeholder-hidden",n);else e.helper.addPartClasses("placeholder-hidden",n)}}function r(e){if(n(this,!0),this.autoSelect){var t=s.g(this.inputId);t.select()}this.fire("focus")}function o(e){n(this,!1),this.fire("blur")}var a=require("underscore"),s=require("esui/lib"),l=require("esui/main"),u=require("esui/InputControl"),c="placeholder"in document.createElement("input");return e.defaultProperties={width:200,step:1},e.prototype.type="RangeInput",e.prototype.initOptions=function(t){var i={mode:"text",placeholder:"",autoSelect:!1};if(a.extend(i,e.defaultProperties),!i.name)i.name=this.main.getAttribute("name");if(s.isInput(this.main)){var n=this.main.nodeName.toLowerCase();if("textarea"===n)i.mode="textarea";else{var r=this.main.type;i.mode="password"===r?"password":"text"}if(!i.placeholder)i.placeholder=this.main.getAttribute("placeholder");this.helper.extractOptionsFromInput(this.main,i)}if(!a.isNumber(+t.maximum)||isNaN(+t.maximum))t.maximum=null;if(!a.isNumber(+t.minimum)||isNaN(+t.minimum))t.minimum=null;var o=parseInt(t.value,10);if(!a.isNumber(o)||isNaN(o))t.value="";else{if(null!==t.minimum)t.value=+t.value<+t.minimum?+t.minimum:+t.value;if(null!==t.maximum)t.value=+t.value>+t.maximum?+t.maximum:+t.value}if(a.extend(i,t),!i.hasOwnProperty("title")&&this.main.title)i.title=this.main.title;this.setProperties(i)},e.prototype.getFocusTarget=function(){return s.g(this.inputId)},e.prototype.initStructure=function(){if(s.isInput(this.main)){var e=this.helper.replaceMain();if(s.removeAttribute(this.main,"tabindex"),this.inputId=e.id||this.helper.getId("input"),this.main.id)this.main.id=this.helper.getId();var t=e.cloneNode(!1);s.removeAttribute(t,l.getConfig("instanceAttr")),t.id=this.inputId,this.main.appendChild(t)}else{this.inputId=this.helper.getId("input");var i='<input type="number" placeholder="'+this.placeholder+'" id="'+this.inputId+'" step="'+this.step+'"';if(this.name)i+=' name="'+a.escape(this.name)+'"';if(i+=" />",this.main.innerHTML=i,this.unit){var n=document.createElement("div");if(n.className="unit",n.textContent=this.unit,this.height)n.style.height=+this.height+"px",n.style.lineHeight=+this.height+"px";this.main.appendChild(n)}}if(!c){var t=s.g(this.inputId),r=document.createElement("label");r.id=this.helper.getId("placeholder"),s.setAttribute(r,"for",t.id),this.helper.addPartClasses("placeholder",r),s.insertAfter(r,t)}},e.prototype.initEvents=function(){var e=s.g(this.inputId);this.helper.addDOMEvent(e,"keypress",t),this.helper.addDOMEvent(e,"keydown",t),this.helper.addDOMEvent(e,"focus",r),this.helper.addDOMEvent(e,"blur",o);var n="oninput"in e?"input":"propertychange";this.helper.addDOMEvent(e,n,i),this.helper.delegateDOMEvent(e,"change")},e.prototype.repaint=require("esui/painters").createRepaint(u.prototype.repaint,{name:"rawValue",paint:function(e,t){var r=s.g(e.inputId),o="oninput"in r?"input":"propertychange";e.helper.removeDOMEvent(r,o),r.value=e.stringifyValue(t),e.helper.addDOMEvent(r,o,i),n(e)}},{name:"title",paint:function(e,t){var i=s.g(e.inputId),n=e.helper.getPart("placeholder");if(t){if(s.setAttribute(e.main,"title",t),s.setAttribute(i,"title",t),n)s.setAttribute(n,"title",t)}else if(s.removeAttribute(e.main,"title"),s.removeAttribute(i,"title"),n)s.removeAttribute(n,"title")}},{name:"maxLength",paint:function(e,t){var i=s.g(e.inputId);if(t=parseInt(t,10),!t||0>=t){try{i.maxLength=void 0,delete i.maxLength}catch(n){}s.removeAttribute(i,"maxlength"),s.removeAttribute(i,"maxLength")}else i.maxLength=t,s.setAttribute(i,"maxlength",t)}},{name:["disabled","readOnly"],paint:function(e,t,i){var n=s.g(e.inputId);n.disabled=t,n.readOnly=i}},{name:"placeholder",paint:function(e,t){var i=s.g(e.inputId);if(c)if(t)s.setAttribute(i,"placeholder",t);else s.removeAttribute(i,"placeholder");else{var r=e.helper.getPart("placeholder");r.innerHTML=a.escape(t||"")}n(e)}},{name:["hint","hintType"],paint:function(e,t,i){var n=e.helper.getPart("hint");if(e.removeState("hint-prefix"),e.removeState("hint-suffix"),!t&&n)s.removeNode(n);if(t){if(!n)n=document.createElement("label"),n.id=e.helper.getId("hint"),e.helper.addPartClasses("hint",n),s.setAttribute(n,"for",e.inputId);n.innerHTML=a.escape(t),i="prefix"===i?"prefix":"suffix";var r="prefix"===i?"insertBefore":"insertAfter",o=s.g(e.inputId);s[r](n,o),e.addState("hint-"+i)}}},{name:["width","hint","hidden"],paint:function(e,t,i,n){if(!n&&!isNaN(t)){if(i){var r=e.helper.getPart("hint");if(r)t-=r.offsetWidth}var o=s.g(e.inputId);o.style.width=t+"px";var a=e.helper.getPart("placeholder");if(a)a.style.maxWidth=t+"px"}}},{name:"height",paint:function(e,t){if(!isNaN(t)){var i=e.helper.getPart("hint"),n=t+"px";if(i)i.style.height=n,i.style.lineHeight=n;var r=s.g(e.inputId);r.style.height=n;var o=e.helper.getPart("placeholder");if(o)o.style.height=n,o.style.lineHeight=n}}}),e.prototype.getValidityLabel=function(){var e=u.prototype.getValidityLabel.apply(this,arguments);if(e)e.set("targetType","textarea"===this.mode?"TextArea":"RangeInput");return e},e.prototype.getRawValue=function(){var e=s.g(this.inputId);return e?e.value:this.rawValue||this.value||""},e.prototype.getRawValueProperty=e.prototype.getRawValue,s.inherits(e,u),l.register(e),e}),define("common/esuix/drag",["require","esui/lib","esui/controlHelper"],function(require){function e(e,t,i){if(i)a.addDOMEvent(e,t,"selectstart",function(e){e.preventDefault()});else a.removeDOMEvent(e,t,"selectstart")}function t(e,t){for(var i=1,n=arguments.length;n>i;i++)if(t=arguments[i]){for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r))e[r]=t[r]}else;return e}function i(e,i){return i.moveHandler=function(n){o.event.getMousePosition(n);var r=(n.pageX-i.x)/i.width+i.offsetX,a=(n.pageY-i.y)/i.height+i.offsetY,s=t({},n);if(s.left=r=Math.min(Math.max(0,r),1),s.top=a=Math.min(Math.max(0,a),1),s.x=n.pageX-i.x,s.y=n.pageY-i.y,s.width=i.width,s.height=i.height,!e.ondragmove||e.ondragmove.call(this,s)!==!1){var l=i.target;l.style.left=100*r+"%",l.style.top=100*a+"%"}},i.moveHandler}function n(t,i){return i.endHandler=function(n){if(a.removeDOMEvent(this,document,"mousemove",i.moveHandler),a.removeDOMEvent(this,document,"mouseup",i.endHandler),e(this,document,!1),i.target=null,t.ondragend)t.ondragend.call(this,n)},i.endHandler}function r(r){return function(s){if(1===s.button||1===s.which){e(this,document,!0);var l=s.target||s.srcElement,u=l.offsetParent.clientWidth,c=l.offsetParent.clientHeight,d=l.offsetLeft;if(!isNaN(parseFloat(o.getStyle(l,"margin-left"))))d-=parseFloat(o.getStyle(l,"margin-left"));var f=l.offsetTop;if(!isNaN(parseFloat(o.getStyle(l,"margin-top"))))f-=parseFloat(o.getStyle(l,"margin-top"));o.event.getMousePosition(s);var h={x:s.pageX,y:s.pageY,offsetX:d/u,offsetY:f/c,target:l,width:u,height:c};if(a.addDOMEvent(this,document,"mousemove",i(r,h)),a.addDOMEvent(this,document,"mouseup",n(r,h)),r.ondragstart)r.ondragstart.call(this,t({},s,h))}}}var o=require("esui/lib"),a=require("esui/controlHelper");return function(e,t,i){a.addDOMEvent(e,t,"mousedown",r(i))}}),define("common/esuix/Scroll",["require","esui/lib","esui/controlHelper","esui/Control","./drag","esui"],function(require){function e(e){var t;if(this.orientation==a.HORIZONTAL)t=this.min+e.left*(this.max-this.min);else t=this.min+e.top*(this.max-this.min);if(this.setValue(t))this.fire("change",{value:this.value});return!1}function t(e){r.call(this,e)}var i=require("esui/lib"),n=require("esui/controlHelper"),r=require("esui/Control"),o=require("./drag"),a={VERTICAL:"vertical",HORIZONTAL:"horizontal"};return t.ORIENTATION=a,t.prototype.type="Scroll",t.prototype.initOptions=function(e){if(e.value=isNaN(+e.value)?0:+e.value,e.max=isNaN(+e.max)?100:+e.max,e.min=isNaN(+e.min)?0:+e.min,e.orientation=e.orientation||a.HORIZONTAL,e.orientation==a.VERTICAL)this.addState("vertical");r.prototype.initOptions.call(this,e)},t.prototype.initStructure=function(){var t=this.main;t.innerHTML='<div class="'+n.getPartClasses(this,"range")+'"><div class="'+n.getPartClasses(this,"progress")+'"></div><span id="'+n.getId(this,"bar")+'" class="'+n.getPartClasses(this,"bar")+'"></span><div class="'+n.getPartClasses(this,"tip")+'"></div></div>',this._eProgress=t.firstChild.firstChild;var r=i.dom.next(this._eProgress);this._eTip=i.dom.next(r),o(this,r,{ondragmove:e})},t.prototype.setValue=function(e){var t=!0;if(e=Math.round(+e),e<this.min)e=this.min;else if(e>this.max)e=this.max;if(this.value===e)t=!1;else this.setProperties({value:e});return t},t.prototype.getValue=function(){return this.value},t.prototype.repaint=n.createRepaint(r.prototype.repaint,[{name:"value",paint:function(e,t){var r=i.g(n.getId(e,"bar"));if(t=(t-e.min)/(e.max-e.min)*100,!(isNaN(t)||0>t))if(e.orientation==a.HORIZONTAL)r.style.left=t+"%",e._eProgress.style.width=t+"%";else r.style.top=t+"%",e._eProgress.style.height=t+"%"}}]),i.inherits(t,r),require("esui").register(t),t}),define("common/esuix/Slider",["require","esui/controlHelper","esui/lib","./Scroll","esui"],function(require){function e(t,i){var n=t.target||t.srcElement,o=n.className.indexOf("btn-prev")>=0?-1:1;i=i||1;var a=this.value;if(this.setValue(a+o*i))this.fire("change",{value:this.value});this.btnTimer=setTimeout(r.bind(e,this,t,i+1),100)}function t(){if(this.btnTimer)clearTimeout(this.btnTimer),this.btnTimer=null}function i(e){o.call(this,e)}var n=require("esui/controlHelper"),r=require("esui/lib"),o=require("./Scroll");return i.prototype.type="Slider",i.prototype.initStructure=function(){o.prototype.initStructure.call(this);var i=this.main,r=n.getPartClasses,a=document.createElement("span");a.className=r(this,"btn")+" "+r(this,"btn-prev"),i.insertBefore(a,i.firstChild),a=document.createElement("span"),a.className=r(this,"btn")+" "+r(this,"btn-next"),i.appendChild(a);var s=n.addDOMEvent;s(this,i.firstChild,"mousedown",e),s(this,i.firstChild,"mouseup",t),s(this,i.lastChild,"mousedown",e),s(this,i.lastChild,"mouseup",t)},r.inherits(i,o),require("esui").register(i),i}),define("common/ueditorx/util",["require"],function(exports){var exports={},e=document;return exports.getPosition=function(t){var i={},n=t.getBoundingClientRect(),r=Math.max(e.documentElement.scrollLeft,e.body.scrollLeft),o=Math.max(e.documentElement.scrollTop,e.body.scrollTop);return i.left=Math.floor(n.left)+r,i.top=Math.floor(n.top)+o,i.height=n.height,i.width=n.width,i},exports}),define("common/ueditorx/ColorPicker",["require","./util"],function(require){function e(){var e=["<ul>"];return n.forEach(function(t,i){e.push("<li",0===i?' class="color-selected" style="border-color: '+t+'"':"",">","<span",' style="background: '+t+'"',' data-color="'+t+'"></span>',"</li>")}),e.push("</ul>",'<div class="colorpicker-arrow"></div>'),e.join("")}function t(e){var t=e.container;t.addEventListener("click",function(i){var n=i.target;if(i.stopPropagation(),"SPAN"===n.tagName){var r=n.getAttribute("data-color"),o=t.querySelector(".color-selected"),a=n.parentNode;o.className="",o.style.borderColor="#fff",a.className="color-selected",a.style.borderColor="#000",e.editor.execCommand("forecolor",r)}},!1),document.addEventListener("click",function(t){e.hide()},!1)}function i(i){var n=this,r=n.container=document.createElement("div");return r.className="ueditor-x-colorpicker",r.innerHTML=e(),document.body.appendChild(r),n.arrow=r.querySelector(".colorpicker-arrow"),n.editor=i,t(n),n}var n=["#000000","#7f8003","#808080","#408082","#420140","#efefef","#3f0100","#814000","#004300","#010576","#00003f","#40027e","#7c0200","#fd8100","#00ff04","#02fffb","#7e81bf","#ff01fa","#fe0100","#feff00","#0085da","#ffffff"],r=i.prototype,o=require("./util");return r.show=function(e){var t=this.container;t.style.display="block";var i=t.getBoundingClientRect(),n=o.getPosition(e),r=i.height+6,a=Math.floor(i.width/2)-6,s=n.top>r?n.top-r:n.top+n.height+6;this.arrow.className=n.top>r?"colorpicker-arrow colorpicker-arrow-down":"colorpicker-arrow colorpicker-arrow-up",t.style.top=s+"px",t.style.left=n.left-a+"px"},r.hide=function(){this.container.style.display="none"},i}),define("common/ueditorx/Fontbar",["require","./ColorPicker","./util"],function(require){function e(e){var t=this,i=e.target,n=t.editor;if("SPAN"===i.tagName){for(var r=i.className,o=["bold","italic","underline"],a=o.length;a>=0;a--)if(r.indexOf(o[a])>-1)return void n.execCommand(o[a]);if(r.indexOf("color")>-1)e.stopPropagation(),t.colorPicker.show(i)}}function t(t){var i=t.container;i.addEventListener("click",function(i){e.call(t,i)},!1),i.querySelector(".family").addEventListener("change",function(e){t.editor.execCommand("fontfamily",e.target.value)},!1),i.querySelector(".size").addEventListener("change",function(e){t.editor.execCommand("fontsize",e.target.value)},!1)}function i(e){var i=this,l=i.container=document.createElement("div");return l.className="ueditor-x-fontbar",l.innerHTML=n+r+o+a,document.body.appendChild(l),i.editor=e,i.colorPicker=new s(e),t(i),i}var n='<select class="family"><option value="" data-name="" data-engname="SimSun"></option><option value="" data-name="" data-engname="Microsoft YaHei" selected></option><option value="" data-name="" data-engname="KaiTi"></option><option value="" data-name="" data-engname="SimHei"></option><option value="" data-name=""></option><option value="Arial" data-name="Arial">Arial</option><option value="Roman" data-name="Roman">Roman</option></select>',r='<select class="size"><option value="8pt">8</option><option value="9pt" selected>9</option><option value="10pt">10</option><option value="11pt">11</option><option value="12pt">12</option><option value="13pt">13</option><option value="14pt">14</option><option value="16pt">16</option><option value="18pt">18</option><option value="24pt">24</option></select>',o='<span class="bold"></span><span class="italic"></span><span class="underline"></span><span class="color"></span>',a="",s=require("./ColorPicker"),l=i.prototype,u=require("./util");return l.show=function(e){var t=this,i=t.container,n=u.getPosition(e);i.style.display="block";var r=i.getBoundingClientRect(),o=n.top>r.height?n.top-r.height-5:n.top+n.height+5;i.style.top=o+"px",i.style.left=n.left-5+"px";var a=document.getElementById(t.editor.key);if(a)i.style.width=a.offsetWidth+2+"px"},l.hide=function(){this.container.style.display="none",this.colorPicker.hide()},l.isShow=function(){return"none"!==getComputedStyle(this.container,null).display},l.fontChange=function(e,t){if(e&&t){var i,n=this,r=n.container;e=e.toLowerCase().replace(/^\'|\'$/g,"");for(var o,a=r.querySelector(".family"),s=a.length,o=0;s>o;o++){var l=a[o].getAttribute("data-engname"),u=a[o].getAttribute("data-name");if(u)u=u.toLowerCase();if(l)l=l.toLowerCase();if(e===l||e===u){i=a[o];break}}i?i.selected=!0:0;var c={"11px":"8pt","12px":"9pt","13px":"10pt","15px":"11pt","16px":"12pt","17px":"13pt","19px":"14pt","21px":"16pt","24px":"18pt","32px":"24pt"};t=c[t];var d=r.querySelector('.size option[value="'+t+'"]');!!d&&(d.selected=!0)}},i}),define("common/ueditorx/fontbarAutoHide",["require","jquery"],function(require){var exports={},e=require("jquery");return exports.init=function(t,i){e(function(){e(window).click(function(n){var r,o=!1,a=e(n.target);if(a.hasClass("ueditor-x-fontbar")||a.hasClass("ueditor-x-font"))o=!0;else r=a.parents(),r.each(function(){var t=e(this);if(t.hasClass("ueditor-x-fontbar")||t.hasClass("ueditor-x-font"))return o=!0,!1;else return void 0});if(o===!1)i.hide();else if(a.hasClass("edui-box"))t.focus()}),e(window).on("resize",function(){i.hide()}),e(document).on("scroll",function(){i.hide()})})},exports}),define("common/ueditorx/font",["require","./Fontbar","./fontbarAutoHide"],function(require){var e=require("./Fontbar"),t=require("./fontbarAutoHide");UE.registerUI("xfont",function(i,n){var r=new e(i);t.init(i,r);var o=new UE.ui.Button({name:n,title:"",className:"ueditor-x-font",onclick:function(){if(r.isShow())return void r.hide();else return void r.show(o.getDom())}});return i.addListener("selectionchange",function(){var e=-1===i.queryCommandState("fontfamily"),t=i.queryCommandValue("fontfamily"),n=i.queryCommandValue("fontsize");o.setDisabled(!!e),r.fontChange(t,n)}),i.addListener("hideFontBar",function(){r.hide()}),o},0)}),define("newstyleManage/widget/Position",["require","underscore","esui/lib","esui/Control","esui/controlHelper","mini-event","esui/painters","esui/main"],function(require){function e(e){l.apply(this,arguments)}function t(e){for(var t,i=e.helper,n=['<label id="${posIdPrefix}-${id}" class="${posItemClass} ${posClassPrefix}-${id} ${posChecked}" >',"<div>${name}</div>",'<input type="radio" value="${id}" name="${posId}" ${checked} />',"</label>"],r="",o=0;t=e.pos[o];o++)r+=s.format(n.join(""),{id:t,name:d[t],posId:e.posId,checked:t===e.checked?"checked":"",posIdPrefix:i.getId("pos"),posItemClass:i.getPartClassName("pos-item"),posClassPrefix:i.getPartClassName("pos"),posChecked:t===e.checked?i.getPartClassName("checked"):""});var l=a.contains(e.pos,"middle")?"":'<div class="${siteBoxInClass}"></div>',u=['<div id="${positionWrapperId}" class="${positionWrapperClass}">','<div class="${siteBoxClass}">',l,"</div>",r,"</div>"];return s.format(u.join(""),{positionWrapperId:i.getId("position-wrapper"),positionWrapperClass:i.getPartClassName("wrapper"),siteBoxClass:i.getPartClassName("site-box"),siteBoxInClass:i.getPartClassName("site-box-in")})}function i(e,t){return s.g(u.getId(e,"pos-"+t))}function n(e,t){var n=i(e,t);u.removePartClasses(e,"checked",n)}function r(e,t){var n=i(e,t);u.addPartClasses(e,"checked",n)}function o(e,t){var i=s.event.getTarget(t),n=require("mini-event").fromDOMEvent(t);if(n.isDefaultPrevented())s.event.preventDefault(t);if(n.isPropagationStopped())s.event.stopPropagation(t);e.set("checked",i.value),e.fire("change",{name:e.name,value:e.checked})}var a=require("underscore"),s=require("esui/lib"),l=require("esui/Control"),u=require("esui/controlHelper");e.prototype.type="Position";var c=8587523;e.prototype.initOptions=function(e){var t={pos:["left-top","left-center","left-bottom","right-top","right-center","right-bottom","middle","bottom"],checked:"middle",name:"position"};if(a.extend(t,e),!a.contains(t.pos,t.checked))t.checked=t.pos[0];t.posId="uiPosition"+c++,this.setProperties(t)};var d={"left-top":"","left-center":"","left-bottom":"","right-top":"","right-center":"","right-bottom":"",middle:"",bottom:""};return e.prototype.initStructure=function(){var e=this,i=t(e);e.main.innerHTML=i},e.prototype.initEvents=function(){this.helper.addDOMEvent(this.main,"change",s.bind(o,null,this))},e.prototype.repaint=require("esui/painters").createRepaint(l.prototype.repaint,{name:"checked",paint:function(e,t){r(e,t)}}),e.prototype.setChecked=function(e){var t=this;if(a.contains(t.pos,e))n(t,t.checked),t.setProperties({checked:e})},e.prototype.getChecked=function(){return this.checked},s.inherits(e,l),require("esui/main").register(e),e}),define("newstyleManage/widget/Group",["require","underscore","esui/lib","esui/Control","esui/controlHelper","esui/painters","esui/main"],function(require){function e(e){var t={handlers:[]};$.call(this,B.extend({},e,t))}function t(e){e.groupLength++;var t={};return t[e.groupName]=""+e.groupLength,t}function i(e,t){return e.helper.getPartClassName(t)}function n(e,t){return e.helper.getId(t)}function r(e,t){return V.getAttribute(e,"data-"+t)}function o(e,t){return V.g(n(e,"row")+"-"+t)}function a(e){return parseInt(r(e,"index"),10)}function s(e,t,r,o){return{rowId:n(e,"row"),rowClass:i(e,"row"),index:r,indexClass:i(e,"index"),nameBox:i(e,"name-box"),nameClass:i(e,"name"),name:t,maxlength:e.maxLength,inputClass:i(e,"input"),inputId:n(e,"input"),iconBox:i(e,"icon-box"),icon:i(e,"icon"),disableUp:o.up?i(e,"icon-disable")+"-up":"",disableDown:o.down?i(e,"icon-disable")+"-down":"",disableDel:o.del?i(e,"icon-disable")+"-del":""}}function l(e,t,i,n){var r=['<li id="${rowId}-${index}" class="${rowClass}" data-index="${index}">','<span class="${indexClass}">${index}</span>','<div class="${nameBox}">','<div class="${nameClass}">${name}</div>','<input type="text" class="${inputClass}" maxlength="${maxlength}"',' id="${inputId}-${index}" data-index="${index}"/>',"</div>",'<div class="${iconBox}">','<span data-index="${index}" class="${icon} ${icon}-upper ${disableUp}"></span>','<span data-index="${index}" class="${icon} ${icon}-down ${disableDown}"></span>','<span data-index="${index}" class="${icon} ${icon}-delete ${disableDel}"></span>',"</div>","</li>"],o=s(e,t[e.groupName],i,n);return V.format(r.join(""),o)}function u(e){for(var t,i=[],n=e.fields.length,r=0;t=e.fields[r];r++){var o={up:0===r,down:r===n-1,del:n===e.min};i.push(l(e,t,r+1,o))}e.main.innerHTML=i.join("")}function c(e,t){e.selectedIndex=t;for(var i={},n=t.length-1;n>=0;n--)i[t[n]]=1;e.selectedIndexMap=i}function d(e,t){var i=V.g(n(e,"input")+"-"+t);i.value=e.fields[t-1][e.groupName],i.focus()}function f(e,t,i){var n=e.selectedIndex;if(n&&n.length)H.removePartClasses(e,"row-selected",o(e,n[0]));t=Math.min(t,e.fields.length),c(e,[t]),d(e,t),H.addPartClasses(e,"row-selected",o(e,t))}function h(e,t){if(e.selectedIndexMap)return!!e.selectedIndexMap[t];else return!1}function p(e){var t=" "+e+" ";return function(e){var i=" "+e.className+" ";return i.replace(j," ").indexOf(t)>=0}}function g(e,t){var i=null;if(t)i="function"==typeof t?t:p(t);return{handler:e,matchFn:i}}function v(e,t,i){var n=t.id,r=e.handlers[n];if(!r)r=e.handlers[n]={};if(i)if(r=e.handlers[i],!r)r=e.handlers[i]=[];return r}function m(e,t,i,n){var r=v(e,t,i),o=[];if(!r.length)b(e,t,i);for(var a=0,s=n.length;s>a;a++){var l=n[a],u=g(l.handler,l.matchFn);r.push(u),o.push(u)}return o}function y(e,t,i){return function(n){n=n||window.event;for(var r=n.target;r;){if(1===r.nodeType)for(var o=t.length-1;o>=0;o--){var a=t[o];if(!a.matchFn||a.matchFn(r))a.handler.call(i,r,n)}if(r===e)break;r=r.parentNode}}}function b(e,t,i){var n=v(e,t,i);H.addDOMEvent(e,t,i,y(t,n,e))}function w(e,t){if(!h(this,a(e)))H.addPartClasses(this,"row-hover",e)}function x(e,t){H.removePartClasses(this,"row-hover",e)}function C(e,t){return e.className.indexOf(t)>=0}function E(e,t){var i=this;if(!C(e,"row-selected")){var n=a(e);f(i,n,!0)}}function P(e){e.parentNode.removeChild(e)}function T(e,t,i){var n=e.fields.slice(0),r=n[t+i];n[t+i]=n[t],n[t]=r,e.setProperties({fields:n})}function S(e,t){var i=this;if(!C(e,"icon-disable")){var n=a(e)-1;P(e),T(i,n,-1),f(i,n,!0),i.fire("change",{name:i.groupListName,value:i.fields.slice(0)})}}function I(e,t){var i=this;if(!C(e,"icon-disable")){var n=a(e);P(e),T(this,n-1,1),f(i,n+1,!0),i.fire("change",{name:i.groupListName,value:i.fields.slice(0)})}}function D(e,t){var i=this;if(!(i.fields.length<=i.min)){if(i.fields.length===i.max)i.fire("lessThanMax");var n=a(e);P(e),c(i,[]);var r=i.fields.slice(0);r.splice(n-1,1),i.setProperties({fields:r}),i.fire("change",{name:i.groupListName,value:i.fields.slice(0)})}}function O(e,t){var i=this;if(""!==V.trim(e.value))k(i,e,a(e));else{var n=a(e);i.fields[n-1][i.groupName]=e.previousSibling.innerHTML,i.fire("change",{name:i.groupListName,value:i.fields})}}function A(e,t){var i=this,n=a(e),r=i.fields;r[n-1][i.groupName]=e.value,i.fire("change",{name:i.groupListName,value:r})}function k(e,t,i){var n=t.value;e.fields[i-1][e.groupName]=n,t.previousSibling.innerHTML=n,e.fire("change",{name:e.groupListName,value:e.fields.slice(0)})}function L(e,t){var i=V.event.getTarget(t);if(i.className.indexOf("ui-group")<0&&i.id.indexOf(e.addBtn)<0){var n=e.selectedIndex;if(n&&n.length)H.removePartClasses(e,"row-selected",o(e,n[0])),c(e,[])}}function M(e){e.helper.addDOMEvent(document,"click",V.bind(L,null,e))}function N(e,t){V.event.stopPropagation(t),V.event.preventDefault(t)}function R(e){var t=e.helper,i=t.getPartClasses("row")[0],n=t.getPartClasses("icon-upper")[0],r=t.getPartClasses("icon-down")[0],o=t.getPartClasses("icon-delete")[0],a=t.getPartClasses("input")[0];m(e,e.main,"mouseover",[{handler:w,matchFn:i}]),m(e,e.main,"mouseout",[{handler:x,matchFn:i}]),m(e,e.main,"click",[{handler:E,matchFn:i},{handler:S,matchFn:n},{handler:I,matchFn:r},{handler:D,matchFn:o}]),m(e,e.main,"focusout",[{handler:O,matchFn:a}]),m(e,e.main,"input",[{handler:A,matchFn:a}]);for(var s,l=["input","change"],u=0;s=l[u];u++)t.addDOMEvent(e.main,s,V.bind(N,null,e))}var B=require("underscore"),V=require("esui/lib"),$=require("esui/Control"),H=require("esui/controlHelper");e.prototype.type="Group",e.defaultProperties={fields:[],groupListName:"groups",groupName:"groupName",max:10,min:1,maxLength:8,addBtn:"addGroup"},e.prototype.initOptions=function(i){var n={};if(B.extend(n,e.defaultProperties,i),n.groupLength=n.fields.length,0===n.groupLength)n.fields.push(t(n));if(this.setProperties(n),this.groupLength>=this.max)this.viewContext.get(this.addBtn).set("disabled",!0)},e.prototype.initEvents=function(){M(this),R(this)},e.prototype.repaint=require("esui/painters").createRepaint($.prototype.repaint,{name:"fields",paint:function(e,t){u(e)}}),e.prototype.addGroup=function(){var e=this;if(!(e.fields.length+1>e.max)){if(e.fields.length+1===e.max)e.fire("equalToMax");var i=e.fields.slice(0);i.push(t(e)),e.setProperties({fields:i}),f(e,e.fields.length,!0),e.fire("change",{name:e.groupListName,value:e.fields.slice(0)})}},e.prototype.setDatasource=function(e){this.setProperties({fields:e}),this.repaint(),this.fire("change",{name:this.groupListName,value:e})},e.prototype.getGroupList=function(){return this.fields.slice(0)};var j=/[\t\r\n]/g;return V.inherits(e,$),require("esui/main").register(e),e}),define("newstyleManage/widget/Uploader",["require","underscore","esui/lib","esui/Control","webuploader","common/esuix/Dialog","esui/main"],function(require){function e(e){var t={loadingURL:"http://s.goutong.baidu.com/settings/resource/styleManageBg/uploading.gif",defaultSrc:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA",webuploader:null,ifAppendRender:!1};S.call(this,P.extend({},e,t))}function t(e,t){return e.helper.getPartClassName(t)}function i(e,t){return e.helper.getId(t)}function n(e,n){var r=['<ul class="${appendBtn}">','<li id="${reUpload}">${btnName}</li>','<li id="${revert}" class="webuploader-pick webuploader-pick-grey"></li>',"</ul>"];return T.format(r.join(""),{appendBtn:t(e,"append-btn"),btnName:n||O,reUpload:i(e,"re-upload"),
revert:i(e,"revert")})}function r(e){var n='<div id="${filePickId}" class="${filePickClass}"></div>';return T.format(n,{filePickId:i(e,"file-pick"),filePickClass:t(e,"file-pick")})}function o(e){if("background"===e.mode&&e.imgUrl)return n(e,A);else return r(e)}function a(e){var i=['<div class="${loading}">','<img src="${url}" width="130" height="80"/>',"</div>"];return T.format(i.join(""),{loading:t(e,"loading"),url:e.loadingURL})}function s(e){var n=['<div class="${uploadError}">',"<p></p>",'<div class="${retryClass}" id="${retryId}"></div>',"</div>"];return T.format(n.join(""),{uploadError:t(e,"file-error"),retryClass:t(e,"retry"),retryId:i(e,"retry")})}function l(e){var n=['<div class="${imgPrevClass}">','<div id="${bgId}" class="${defaultImg}" style="background-image: url(${bgUrl})"></div>','<img id="${imgId}" src="${imgUrl}" width="130" height="80"/>','<div id="${mask}" class="${maskClass}"></div>',"</div>",'<div class="${uploadBtn}" id="${uploadBtnId}">',"${btnArea}","</div>"];return T.format(n.join(""),{imgPrevClass:t(e,"img-prev"),imgId:i(e,"img"),imgUrl:e.imgUrl?e.imgUrl:e.defaultSrc,defaultImg:t(e,"default-img"),bgId:i(e,"bg"),bgUrl:""===e.imgUrl?e.bgUrl:"",mask:i(e,"mask"),maskClass:t(e,"mask"),uploadBtn:t(e,"upload-btn"),uploadBtnId:i(e,"upload-btn"),btnArea:o(e)})}function u(e){e.main.innerHTML=l(e),e.domMask=T.g(i(e,"mask")),e.domImg=T.g(i(e,"img")),e.domBg=T.g(i(e,"bg"))}function c(e){var t="background"===e.mode&&e.imgUrl?i(e,"re-upload"):i(e,"file-pick");k.pick=T.g(t),e.webuploader=I.create(k)}function d(e,t){D.alert({title:e,content:'<p class="info-title">'+t+"</p>",width:400})}function f(e,t){if(!/(jpg|gif|png|bmp|jpeg)$/i.test(t.ext))t.setStatus("invalid"),d("","jpgjpegpnggifbmp");e.fire("beforeFileQueued",{file:t})}function h(e,t){var i=(t.size/1024).toFixed(2);if(i>e.fileSize)t.setStatus("invalid"),d("","500Kb");e.fire("fileQueued",{file:t})}function p(e,t){e.domMask.innerHTML=a(e),e.fire("uploadStart",{file:t})}function g(e,t){if(e.domMask.innerHTML=s(e),"background"===e.mode&&e.ifAppendRender){var n=T.g(i(e,"upload-btn"));n.innerHTML=r(e),e.webuploader.addButton({id:"#"+i(e,"file-pick")}),e.ifAppendRender=!1}e.fire("uploadError",{file:t})}function v(e,t){if(e.domMask.innerHTML="",e.domImg.src=t.url||e.defaultSrc,e.domBg.style.backgroundImage="none","background"===e.mode)if(!e.ifAppendRender){var r=T.g(i(e,"upload-btn"));r.innerHTML=n(e),e.webuploader.addButton({id:"#"+i(e,"re-upload")}),e.ifAppendRender=!0}}function m(e,t){e.webuploader.reset(),e.imgUrl=t.url||"",e.bgUrl="",v(e,t),e.fire("uploadSuccess",{name:e.name,value:t.url,width:+t.width,height:+t.height})}function y(e,t){var i=e.webuploader.getFiles(),n=0;for(n=0;n<i.length;n++)i[n].setStatus("error");g(e)}function b(e,t){e.domMask.innerHTML="",d("",t.state)}function w(e,t){e.fire("uploadComplete",{file:t})}function x(e){var t=e.webuploader;t.on("beforeFileQueued",function(i){t.reset(),f(e,i)}),t.on("fileQueued",function(t){h(e,t)}),t.on("uploadStart",function(t){p(e,t)}),t.on("uploadSuccess",function(t,i){if("SUCCESS"===i.state)m(e,i);else if("UPLOAD_FAIL"===i.state)y(e,i);else b(e,i)}),t.on("uploadError",function(t){g(e,t)}),t.on("uploadComplete",function(t){w(e,t)})}function C(e,t){var n=T.event.getTarget(t),r=n.id;switch(r){case i(e,"retry"):e.webuploader.retry();break;case i(e,"revert"):e.imgUrl="",e.domImg.src=e.defaultSrc,e.fire("requireBg",{name:e.name,value:""})}}function E(e){e.helper.addDOMEvent(e.main,"click",T.bind(C,null,e))}var P=require("underscore"),T=require("esui/lib"),S=require("esui/Control"),I=require("webuploader"),D=require("common/esuix/Dialog"),O="",A="";e.prototype.type="Uploader",e.defaultProperties={imgUrl:"",bgUrl:"",fileSize:500,name:"img",required:"true",mode:"default"};var k={auto:!0,swf:"../../dep/webuploader/Uploader.swf",server:window.nbcps.root+"/styleManage/uploadImage.action",accept:{title:"Images",extensions:"gif,jpg,jpeg,bmp,png",mimeTypes:"image/*"},chunked:!1};return e.prototype.initOptions=function(t){var i={};P.extend(i,e.defaultProperties,t),this.setProperties(i)},e.prototype.initStructure=function(){u(this),c(this)},e.prototype.initEvents=function(){x(this),E(this)},e.prototype.setBgImg=function(e){this.domBg.style.backgroundImage="url("+e+")",this.domImg.src=this.defaultSrc,this.imgUrl="",this.bgUrl=e},e.prototype.getBgImg=function(){return this.bgUrl},e.prototype.getValidity=function(){if("true"===this.required)return""!==this.imgUrl;else return!0},T.inherits(e,S),require("esui/main").register(e),e}),define("newstyleManage/widget/messageBoardCMS/main.tpl",[],function(){return'<!-- target: messageBoardCMS --><div id="message-board-CMS-container"><div class="message-default-item-container"><!-- for: ${defaultMessageItems} as ${defaultItem}, ${index} --><div class="item"><input name="${defaultItem.name}"id="checkbox-${defaultItem.name}"type="checkbox"data-default-item="true"data-checkbox-type="isShow"data-item-index="${index}"${defaultItem.isShow|checkboxChecked} /><label for="checkbox-${defaultItem.name}"><span class="question">${defaultItem.name|defaultNameTranslate}</span></label><div class="right"><div class="required-container"><label><!-- // data-checkbox-typecheckbox --><input name="${defaultItem.name}-required"type="checkbox"data-checkbox-type="required"data-item-index="${index}"data-default-item="true"${defaultItem.required|checkboxChecked} /></label></div></div></div><!-- /for --></div><div class="message-custom-items-container"><!-- for: ${customMessageItems} as ${customMessageItem}, ${index} --><!-- // subItems0 --><!-- if: !!${customMessageItem.subItems} --><div class="item select-item"><label class="tree-view-checkbox-container"><input name="${customMessageItem.text}"type="checkbox"data-checkbox-type="isShow"data-item-index="${index}"${customMessageItem.isShow|checkboxChecked} /></label><div class="tree-view"><div class="root"><span class="question">${customMessageItem.question}</span></div><div class="leaves"><!-- for: ${customMessageItem.subItems} as ${subItem} --><div class="leaf"><span class="answer">${subItem}</span></div><!-- /for --></div></div><div class="right"><!-- use: messageItemCtrl(index = ${index},itemType = \'select\') --><div class="required-container"><label><!-- // data-checkbox-typecheckbox --><input name="${customMessageItem.name}-required"type="checkbox"data-checkbox-type="required"data-item-index="${index}"${customMessageItem.required|checkboxChecked} /><span class="label"></span></label></div></div></div><!-- // subItems0 --><!-- else --><div class="item input-item"><input name="${customMessageItem.name}"id="${customMessageItem.name}"type="checkbox"data-checkbox-type="isShow"data-item-index="${index}"${customMessageItem.isShow|checkboxChecked} /><label for="${customMessageItem.name}"><span class="question">${customMessageItem.question}</span></label><div class="right"><!-- use: messageItemCtrl(index = ${index},itemType = \'input\') --><div class="required-container"><label><!-- // data-checkbox-typecheckbox --><input name="${customMessageItem.name}-required"type="checkbox"data-checkbox-type="required"data-item-index="${index}"${customMessageItem.required|checkboxChecked} /></label></div></div></div><!-- /if --><!-- /for --></div><div class="add-input-item add-new-frame add-new-item ${customItemsLen|getAddNewClass}"><span class="add-new-icon add-select-item">+</span></div><div class="add-select-item add-new-frame add-new-item ${customItemsLen|getAddNewClass}"><span class="add-new-icon add-select-item">+</span></div><div class="gray max-tip">(4)</div></div><!-- target: messageItemCtrl --><div class="message-item-ctrl"><i class="ctrl-item move-up"data-item-index="${index}"data-item-type="${itemType}"></i><i class="ctrl-item move-down"data-item-index="${index}"data-item-type="${itemType}"></i><i class="ctrl-item edit-item"data-item-index="${index}"data-item-type="${itemType}"></i><i class="ctrl-item delete-item"data-item-index="${index}"data-item-type="${itemType}"></i></div>'}),define("newstyleManage/widget/messageBoardCMS/MessageBoardCMS",["require","esui/lib","esui/Control","esui/main","etpl","er/URL","common/esuix/Dialog","jquery","underscore","../../config","./main.tpl"],function(require){function e(e){o.apply(this,arguments)}function t(e,t,i,n){var r=document.createElement("div");document.body.appendChild(r);var o={id:"messageBoardCMSModal",needFoot:!1,draggable:!0,closeOnHide:!0,autoClose:!0,main:r,viewContext:null,url:"/messageBoardCMS~"},s={};if("add"===t)s.title="";else if("edit"===t)s.title="";if("input"===e)s.title+="";else if("select"===e)s.title+="";var u=n.itemsExt[i],c={index:i,type:e,itemData:"undefined"==typeof u?"":JSON.stringify(u)};if("input"===e)s.height=188,s.width=402;else if("select"===e)s.height=390,s.width=450;o.url+=l.serialize(c),s=d.extend(o,s);var f=a.create("ActionDialog",s);f.render(),f.show(),f.on("action@cancel",function(){f.dispose()}),f.on("action@confirm",function(e){var r=e.data;n.editDatasource(i,{question:r.question,required:"add"===t?0:r.required,subItems:r.subItems,isShow:"add"===t?0:r.isShow}),f.dispose()})}function i(e,t,i){var n=e.itemsExt,r=n[t];if("down"===i)n[t]=n[t+1],n[t+1]=r;else if("up"===i)n[t]=n[t-1],n[t-1]=r;e.initStructure(),e.fire("change")}function n(e,t){e.itemsExt.splice(t,1),e.initStructure(),e.fire("change")}var r=require("esui/lib"),o=require("esui/Control"),a=require("esui/main"),s=require("etpl"),l=require("er/URL"),u=require("common/esuix/Dialog"),c=require("jquery"),d=require("underscore"),f=require("../../config");s.parse(require("./main.tpl"));var h="messageBoardCMS";return e.prototype.type="messageBoardCMS",e.prototype.initOptions=function(e){var t={items:[],itemsExt:[]};e=d.extend({},t,e),this.setProperties(e)},e.prototype.initStructure=function(){var e=s.getRenderer(h);this.main.innerHTML=e({defaultMessageItems:this.items,customMessageItems:this.itemsExt,customItemsLen:this.itemsExt.length});var t=c('[data-checkbox-type="isShow"]'),i=t.filter(":checked").length;if(i>=4)t.not(":checked").prop("disabled",!0)},e.prototype.initEvents=function(){var e,r,o=this,a=c(this.main);a.on("click",function(a){var s,l=c(a.target);if(l.is(".add-input-item")||l.is(".add-select-item")){if(s=o.itemsExt.length,4>s){if(l.is(".add-input-item"))t("input","add",s,o);if(l.is(".add-select-item"))t("select","add",s,o)}}else if(l.is(".edit-item"))e=l.attr("data-item-type"),r=+l.attr("data-item-index"),t(e,"edit",r,o);else if(l.is(".move-down")){if(s=o.itemsExt.length,r=+l.attr("data-item-index"),s>r+1)i(o,r,"down")}else if(l.is(".move-up")){if(r=+l.attr("data-item-index"),r>0)i(o,r,"up")}else if(l.is(".delete-item")){var d=f.confirmDialogParam;d.content='<p class="info-title"></p>';var h=u.confirm(d);h.on("ok",function(){r=+l.attr("data-item-index"),n(o,r)})}}),a.on("change",function(e){var t=c(e.target);if(t.is('[data-checkbox-type="isShow"]')){var i=c('[data-checkbox-type="isShow"]'),n=i.filter(":checked").length,r=i.not(":checked");r.prop("disabled",n>=4)}var a=t.attr("data-checkbox-type"),s=+t.attr("data-item-index"),l=t.prop("checked");if(t.attr("data-default-item"))o.items[s][a]=l?1:0;else o.itemsExt[s][a]=l?1:0;e.stopPropagation(),o.fire("change")})},e.prototype.editDatasource=function(e,t){this.itemsExt[e]=t,this.itemsExt.forEach(function(e,t){e.name="item"+t}),this.fire("change"),this.initStructure()},e.prototype.getValue=function(){return{items:this.items,itemsExt:this.itemsExt}},r.inherits(e,o),a.register(e),e}),define("esui/TextBox",["require","underscore","./lib","./main","./InputControl","mini-event","./painters"],function(require){function e(e){u.apply(this,arguments)}function t(e){var t=e.which||e.keyCode;if(13===t)this.fire("enter");var i={keyCode:t,key:String.fromCharCode(t),ctrlKey:e.ctrlKey,altKey:e.altKey},n=require("mini-event").fromDOMEvent(e,"keypress",i);this.fire("keypress",n)}function i(e,t){var i=s.g(e.inputId);if(!c){var n=e.helper.getPart("placeholder");if("boolean"!=typeof t)t=document.activeElement===i;if(!t&&!e.getRawValue())e.helper.removePartClasses("placeholder-hidden",n);else e.helper.addPartClasses("placeholder-hidden",n)}}function n(e){if(i(this,!0),this.autoSelect){var t=s.g(this.inputId);t.select()}this.fire("focus")}function r(e){i(this,!1),this.fire("blur")}function o(e){if("input"===e.type||"value"===e.propertyName)this.fire("input")}var a=require("underscore"),s=require("./lib"),l=require("./main"),u=require("./InputControl"),c="placeholder"in document.createElement("input");return e.defaultProperties={width:200},e.prototype.type="TextBox",e.prototype.initOptions=function(t){var i={mode:"text",placeholder:"",autoSelect:!1};if(a.extend(i,e.defaultProperties),!i.name)i.name=this.main.getAttribute("name");if(s.isInput(this.main)){var n=this.main.nodeName.toLowerCase();if("textarea"===n)i.mode="textarea";else{var r=this.main.type;i.mode="password"===r?"password":"text"}if(!i.placeholder)i.placeholder=this.main.getAttribute("placeholder");this.helper.extractOptionsFromInput(this.main,i)}if(a.extend(i,t),!i.hasOwnProperty("title")&&this.main.title)i.title=this.main.title;this.setProperties(i)},e.prototype.getFocusTarget=function(){return s.g(this.inputId)},e.prototype.initStructure=function(){if(s.isInput(this.main)){var e=this.helper.replaceMain();if(s.removeAttribute(this.main,"tabindex"),this.inputId=e.id||this.helper.getId("input"),this.main.id)this.main.id=this.helper.getId();var t=e.cloneNode(!1);s.removeAttribute(t,l.getConfig("instanceAttr")),t.id=this.inputId,this.main.appendChild(t)}else{this.inputId=this.helper.getId("input");var i="textarea"===this.mode?'<textarea id="'+this.inputId+'"':'<input type="'+this.mode+'" placeholder="'+this.placeholder+'" id="'+this.inputId+'"';if(this.name)i+=' name="'+a.escape(this.name)+'"';i+="textarea"===this.mode?"></textarea>":" />",this.main.innerHTML=i}if(!c){var t=s.g(this.inputId),n=document.createElement("label");n.id=this.helper.getId("placeholder"),s.setAttribute(n,"for",t.id),this.helper.addPartClasses("placeholder",n),s.insertAfter(n,t)}},e.prototype.initEvents=function(){var e=s.g(this.inputId);this.helper.addDOMEvent(e,"keypress",t),this.helper.addDOMEvent(e,"focus",n),this.helper.addDOMEvent(e,"blur",r);var i="oninput"in e?"input":"propertychange";this.helper.addDOMEvent(e,i,o),this.helper.delegateDOMEvent(e,"change")},e.prototype.repaint=require("./painters").createRepaint(u.prototype.repaint,{name:"rawValue",paint:function(e,t){var n=s.g(e.inputId),r="oninput"in n?"input":"propertychange";e.helper.removeDOMEvent(n,r),n.value=e.stringifyValue(t),e.helper.addDOMEvent(n,r,o),i(e)}},{name:"title",paint:function(e,t){var i=s.g(e.inputId),n=e.helper.getPart("placeholder");if(t){if(s.setAttribute(e.main,"title",t),s.setAttribute(i,"title",t),n)s.setAttribute(n,"title",t)}else if(s.removeAttribute(e.main,"title"),s.removeAttribute(i,"title"),n)s.removeAttribute(n,"title")}},{name:"maxLength",paint:function(e,t){var i=s.g(e.inputId);if(t=parseInt(t,10),!t||0>=t){try{i.maxLength=void 0,delete i.maxLength}catch(n){}s.removeAttribute(i,"maxlength"),s.removeAttribute(i,"maxLength")}else i.maxLength=t,s.setAttribute(i,"maxlength",t)}},{name:["disabled","readOnly"],paint:function(e,t,i){var n=s.g(e.inputId);n.disabled=t,n.readOnly=i}},{name:"placeholder",paint:function(e,t){var n=s.g(e.inputId);if(c)if(t)s.setAttribute(n,"placeholder",t);else s.removeAttribute(n,"placeholder");else{var r=e.helper.getPart("placeholder");r.innerHTML=a.escape(t||"")}i(e)}},{name:["hint","hintType"],paint:function(e,t,i){var n=e.helper.getPart("hint");if(e.removeState("hint-prefix"),e.removeState("hint-suffix"),!t&&n)s.removeNode(n);if(t){if(!n)n=document.createElement("label"),n.id=e.helper.getId("hint"),e.helper.addPartClasses("hint",n),s.setAttribute(n,"for",e.inputId);n.innerHTML=a.escape(t),i="prefix"===i?"prefix":"suffix";var r="prefix"===i?"insertBefore":"insertAfter",o=s.g(e.inputId);s[r](n,o),e.addState("hint-"+i)}}},{name:["width","hint","hidden"],paint:function(e,t,i,n){if(!n&&!isNaN(t)){if(i){var r=e.helper.getPart("hint");if(r)t-=r.offsetWidth}var o=s.g(e.inputId);o.style.width=t+"px";var a=e.helper.getPart("placeholder");if(a)a.style.maxWidth=t+"px"}}},{name:"height",paint:function(e,t){if(!isNaN(t)){var i=e.helper.getPart("hint"),n=t+"px";if(i)i.style.height=n,i.style.lineHeight=n;var r=s.g(e.inputId);r.style.height=n;var o=e.helper.getPart("placeholder");if(o)o.style.height=n,o.style.lineHeight=n}}}),e.prototype.getValidityLabel=function(){var e=u.prototype.getValidityLabel.apply(this,arguments);if(e)e.set("targetType","textarea"===this.mode?"TextArea":"TextBox");return e},e.prototype.getRawValue=function(){var e=s.g(this.inputId);return e?e.value:this.rawValue||this.value||""},e.prototype.getRawValueProperty=e.prototype.getRawValue,s.inherits(e,u),l.register(e),e}),define("newstyleManage/widget/BannerUpload",["require","esui/lib","esui/Control","esui/controlHelper","jquery","esui/Button","esui/TextBox","common/esuix/Dialog","esui/main"],function(require){function e(e){P.apply(this,arguments)}function t(e){var t=e.helper,i=['<div class="${imgClass}">','<div class="${prevClass}">','<img src="${bgUrl}" width="130" height="80" id="${imgId}" />','<div id="${maskId}" class="${uploadPre}-mask"></div>',"</div>",'<div class="${uploadClass}">','<div class="${uploadPre}-button" data-ui="type:Button;childName:upload;"></div>','<div class="${uploadPre}-button ${uploadPre}-button-grey" ','data-ui="type:Button;childName:${btnId};">${btnName}</div>','<form name="${uploadFormId}" enctype="multipart/form-data">','<input type="file" id="${fileId}" name="file" ','accept="image/*">',"</form>","</div>","</div>","<div>",'<input class="${uploadPre}-input" ','data-ui="type:TextBox;value:${linkUrl};childName:linkUrl;mode:text;','width:279;height:26;placeholder:${ph}">',"</div>",'<div id="${validityId}" class="${uploadPre}-validity-bg"></div>'];return E.format(i.join(""),{bgUrl:e.img,linkUrl:e.url,ph:D.placeholder,prevClass:t.getPartClassName("prev"),uploadClass:t.getPartClassName("btn-box"),imgClass:t.getPartClassName("img-box"),uploadPre:t.getPartClassName(""),uploadFormId:t.getId("form"),fileId:t.getId("file"),imgId:t.getId("img"),maskId:t.getId("mask"),btnId:"reset"===e.btnType?"reset":"delete",btnName:"reset"===e.btnType?"":"",validityId:t.getId("validity")})}function i(e){var t=e.helper;e._file="#"+t.getId("file"),e._mask=t.getPart("mask"),e._img=t.getPart("img"),e._validity=t.getPart("validity")}function n(e){var t='<input type="file" name="file" id="${fileId}" accept="image/*">';S(e._file).change(function(){if(o(e,this))y(e);S(this).replaceWith(E.format(t,{fileId:e.helper.getId("file")})),n(e)})}function r(e){for(var t,i=0;t=e[i++];)if(t.size>D.fileSize)return!0;return!1}function o(e,t){var i=t.value;if(""===S.trim(i))return!1;var n=i.substr(i.lastIndexOf("."));if(!/(jpg|gif|png|bmp|jpeg)$/i.test(n))return p("",D.errorExt),!1;if(r(t.files))return p("",D.errorSize),!1;else return!0}function a(e){var t="^((https|http|ftp|rtsp|mms)?://)?(([0-9a-z_!~*'().&=+$%-]+: )?[0-9a-z_!~*'().&=+$%-]+@)?(([0-9]{1,3}\\.){3}[0-9]{1,3}|([0-9a-z_!~*'()-]+\\.)*([%0-9a-z][%0-9A-Za-z-]{0,61})?[0-9a-z]\\.[a-z]{2,6})(:[0-9]{1,4})?((/?)|(/[-%A-Z0-9a-z_!~*'().;?:@&=+$,%#-]+)+/?)$",i=new RegExp(t,"i");if(i.test(e)||""===S.trim(e))return!0;else return!1}function s(e){if(e=S.trim(e),""!==e){var t=/^(?:f|ht)tps?:\/\//;if(0!==e.search(t))e="http://"+e}return e}function l(e){var t=['<img src="${url}" width="130" height="80"/>'];return E.format(t.join(""),{url:D.loading})}function u(e){var t=e.helper,i=['<div class="${uploadError}">',"<p></p>",'<div class="${retryClass}" id="${retryId}"></div>',"</div>"];e._mask.innerHTML=E.format(i.join(""),{uploadError:t.getPartClassName("file-error"),retryClass:t.getPartClassName("retry"),retryId:t.getId("retry")});var n=E.g(t.getId("retry"));n.onclick=function(){y(e)}}function c(e,t){var i=new Image;i.onload=function(){e._img.src=t.url,v(e)},i.onerror=function(){e._img.src=D.failure,v(e)},i.src=e.rawValue.img=t.url,e.fire("change",{img:e.rawValue.img,url:e.rawValue.url,index:e.index})}function d(e,t){p("",t.state)}function f(e,t,i){var n="#"+e._validity.id+' p[data-for="validity-'+t+'"]';if(!(S(n).size()>0)){var r=['<p data-for="${id}" class="${errorClass}">${msg}</p>'],o=document.createElement("div");o.innerHTML=E.format(r.join(""),{id:"validity-"+t,errorClass:e.helper.getPartClassName("error-tip"),msg:i}),e._validity.appendChild(o.firstChild)}}function h(e,t){if(t){var i="#"+e._validity.id+' p[data-for="validity-'+t+'"]';S(i).remove()}else e._validity.innerHTML=""}function p(e,t){I.alert({title:e,content:'<p class="info-title">'+t+"</p>",width:400})}function g(e){var t=document.forms[e.helper.getId("form")];return new FormData(t)}function v(e){e._mask.innerHTML=""}function m(e,t){if(!t.status)switch(t.data.state){case"SUCCESS":c(e,t.data);break;case"UPLOAD_FAIL":u(e);break;default:v(e),d(e,t.data)}else v(e),p("",t.statusInfo||"")}function y(e){e._mask.innerHTML=l(e),S.ajax({url:D.sendUrl,type:"POST",dataType:"json",data:g(e),processData:!1,contentType:!1,success:function(t){m(e,t)},error:function(t){e._mask.innerHTML="",p("",t.statusInfo||"")}})}function b(e){S(e._file).click()}function w(e){if(e._mask.innerHTML="",""!==e.rawValue.img)e._img.src=e.defaultImg,e.rawValue.img="",e.fire("change",{img:e.rawValue.img,url:e.rawValue.url,index:e.index})}function x(e){var t=I.confirm({title:"",content:'<p class="info-title"></p>',width:450,skin:"warn"});t.on("ok",function(){e.fire("delete",{index:e.index}),e.helper.dispose(),e.dispose()})}function C(e,t){var i=t.target.getRawValue();if(a(i))e.rawValue.url=s(i),t.target.setRawValue(e.rawValue.url),h(e,"url");else e.rawValue.url=i;e.fire("updateUrl",{img:e.rawValue.img,url:e.rawValue.url,index:e.index})}var E=require("esui/lib"),P=require("esui/Control"),T=require("esui/controlHelper"),S=require("jquery");require("esui/Button"),require("esui/TextBox");var I=require("common/esuix/Dialog"),D={fileSize:512e3,defaultSrc:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA",placeholder:"",sendUrl:window.nbcps.root+"/styleManage/upload.action",loading:"http://s.goutong.baidu.com/settings/resource/styleManageBg/uploading.gif",failure:"http://s.goutong.baidu.com/settings/resource/styleManageBg/fileuploadFail.png",errorImg:"",errorUrl:"",errorExt:"jpgjpegpnggifbmp",errorSize:"500Kb"};return e.prototype={type:"BannerUpload",initOptions:function(e){var t={index:0,btnType:"reset",defaultImg:D.defaultSrc,img:"",url:""};if(E.extend(t,e),t.rawValue={img:t.img,url:t.url},""===t.img)t.img=t.defaultImg;this.setProperties(t)},initStructure:function(){var e=this;e.main.innerHTML=t(e),e.helper.initChildren(e.main),i(e)},initEvents:function(){var e=this,t=e.getChild("upload");if(t.on("click",E.curry(b,e)),"reset"===e.btnType){var i=e.getChild("reset");i.on("click",E.curry(w,e))}else{var r=e.getChild("delete");r.on("click",E.curry(x,e))}var o=e.getChild("linkUrl");o.on("blur",E.curry(C,e)),n(e)},repaint:T.createRepaint(P.prototype.repaint,{name:"rawValue",paint:function(e,t){}}),getRawValue:function(){return this.rawValue},setDefaultImg:function(e){if(this.defaultImg=e,""===this.rawValue.img)this._img.src=e},setIndex:function(e){this.index=e},getValidity:function(){var e={pass:!0,errors:[]},t=this.getChild("linkUrl");if(!a(t.getRawValue()))e.pass=!1,e.errors.push(D.errorUrl),f(this,"url",D.errorUrl);return e},dispose:function(){S(this.main).remove(),delete this}},E.inherits(e,P),require("esui/main").register(e),e}),define("newstyleManage/widget/Banner",["require","underscore","esui/lib","esui/Control","esui/Button","./BannerUpload","esui/controlHelper","esui/main"],function(require){function e(e){p.apply(this,arguments)}function t(e){return e.helper.getId("upload")+v++}function i(e){var i=t(e);e._itemIndex.push(i),l(e,{childName:i,img:"",url:"",defaultImg:e.bgUrl,index:e.rawValue.length,btnType:"delete"}),e.rawValue.push({img:"",url:""}),r(e),s(e)}function n(e,t){t.on("change",function(t){o(e,t)}),t.on("delete",function(t){a(e,t.index)}),t.on("updateUrl",function(t){o(e,t,"updateUrl")})}function r(e){e.getChild("addBtn").set("disabled",e.rawValue.length>=e.max)}function o(e,t,i){e.rawValue[t.index]={img:t.img,url:t.url},s(e,i)}function a(e,t){for(var i,n=t+1;i=e._itemIndex[n];n++)e.getChild(i).setIndex(n-1);e.rawValue.splice(t,1),e._itemIndex.splice(t,1),r(e),s(e)}function s(e,t){t=t||"change",e.fire(t,{name:e.name,value:e.rawValue})}function l(e,t){var i=new g(t);i.appendTo(e.bannerBox),e.addChild(i),n(e,i)}function u(e){f.each(e.rawValue,function(i,n){var r=t(e);e._itemIndex.push(r),l(e,{childName:r,img:i.img,url:i.url,defaultImg:e.bgUrl,index:n,btnType:n?"delete":"reset"})})}function c(e){var t=e.helper,i=['<div class="${bannerPre}-box" id="${bannerId}"></div>',"<div>",'<div class="ui-button-ok ui-button-new ${bannerPre}-button" data-ui="type:Button;childName:addBtn;"></div>',"</div>"];return h.format(i.join(""),{bannerPre:t.getPartClassName(""),bannerId:t.getId("box")})}function d(e){h.event.stopPropagation(e),h.event.preventDefault(e)}var f=require("underscore"),h=require("esui/lib"),p=require("esui/Control");require("esui/Button");var g=require("./BannerUpload"),v=0;return e.prototype={type:"Banner",initOptions:function(e){var t={name:"banners",max:3,value:[],bgUrl:""};e.rawValue=[],h.extend(t,e),f.each(t.value,function(e){t.rawValue.push({img:e.img,url:e.url})}),t._itemIndex=[],this.setProperties(t)},initStructure:function(){var e=this;e.main.innerHTML=c(e),e.helper.initChildren(e.main),r(this),e.bannerBox=e.helper.getPart("box"),u(e)},initEvents:function(){var e=this,t=e.getChild("addBtn");t.on("click",h.curry(i,e)),f.each(["input","change"],function(t){e.helper.addDOMEvent(e.main,t,d)})},repaint:require("esui/controlHelper").createRepaint(p.prototype.repaint,{name:"rawValue",paint:function(e,t){}}),getRawValue:function(){return this.rawValue},setBgImg:function(e){var t=this;t.bgUrl=e,f.each(t._itemIndex,function(i){t.getChild(i).setDefaultImg(e)})},getValidity:function(){var e=this,t={pass:!0,errors:[]};return f.each(e._itemIndex,function(i){var n=e.getChild(i).getValidity();if(!n.pass)t.pass=!1,t.errors.push(n.errors.join(""))}),t}},h.inherits(e,p),require("esui/main").register(e),e}),define("newstyleManage/main.tpl",[],function(){return'<!-- target: main --><header><!-- // styleNameurl hash --><div id="theme-description">${styleName}</div><div data-ui="type:Tab;id:typeTab;" id="type-tab" class="main-tab"><ul data-role="navigator" class="tab-title"><li></li><li></li><li></li><li></li></ul></div></header><div class="toolbar"><div class="toast-tip" id="top-toast"></div><div data-ui="type:Button;id:save" class="btn-save" id="save">&nbsp;&nbsp;</div><!-- if: ${default} == \'1\' --><div data-ui="type:Button;id:reset" class="btn-reset" id="reset"></div><!-- /if --><!-- if: ${hasPreview} == true --><div data-ui="type:Button;id:preview" class="btn-preview" id="preview">&nbsp;&nbsp;</div><input pattern="${URLRule}" id="preview-site" spellcheck="false" type="text" /><!-- /if --></div><div id="style-manage-main"><div id="previewer"></div><div class="main-right"><div id="style-controller"><!-- if: ${target} == \'icon\' --><!-- if: ${device} == \'pc\' --><!-- import: pcicon --><!-- elif: ${device} == \'mobile\' --><!-- import: mobileicon --><!-- /if --><!-- elif: ${target} == \'invite\' --><!-- if: ${device} == \'pc\' --><!-- import: pcinvite --><!-- elif: ${device} == \'mobile\' --><!-- import: mobileinvite --><!-- /if --><!-- elif: ${target} == \'webim\' --><!-- if: ${device} == \'pc\' --><!-- import: pcwebim --><!-- elif: ${device} == \'mobile\' --><!-- import: mobilewebim --><!-- /if --><!-- elif: ${target} == \'messageboard\' --><!-- if: ${device} == \'pc\' --><!-- import: pcmessageboard --><!-- elif: ${device} == \'mobile\' --><!-- import: mobilemessageboard --><!-- /if --><!-- /if --></div></div></div>'}),define("newstyleManage/filters",["require","etpl"],function(require){var e=require("etpl");e.addFilter("checkboxChecked",function(e){return 1===+e||e===!0?'checked="checked"':""}),e.addFilter("radioChecked",function(e,t){return+e===+t?'checked="checked"':""}),e.addFilter("isDisabled",function(e){return 0===+e||e===!1?'disabled="disabled"':""}),e.addFilter("disableSwitch",function(e,t){t.push(e);var i=t.some(function(e){return 1!==+e&&e!==!0});return i?"disabled: true":""}),e.addFilter("tabVisibility",function(e,t){return+e===+t?"tab-show":"tab-hide"}),e.addFilter("addOne",function(e){return+e+1}),e.addFilter("getDriectStyle",function(e){return 2===+e?"driect-talk-style":""}),e.addFilter("defaultNameTranslate",function(e){switch(e){case"visitorName":return"";case"visitorPhone":return"";case"visitorAddress":return"";case"visitorEmail":return""}}),e.addFilter("isRequire",function(e){return["",""][+e]}),e.addFilter("getDIndex",function(e,t,i){return t.length+i.length-e}),e.addFilter("getAddNewClass",function(e){return+e>=4?"add-new-disabled":""}),e.addFilter("isCustomerCheck",function(e,t,i){return 1===t?"customer-"+i+"-style":""}),e.addFilter("showCustomerImg",function(e,t){var i="";if(1===+e&&""!==t)i="background:url("+t+")";return i}),e.addFilter("customerGroup",function(e){return 1===+e?"group-customer-item":""}),e.addFilter("getIconPosition",function(e,t,i,n,r){var o=43*t.length+10,a="",s=location.href.indexOf("styleIndex");if(-1===s){if(1===+e)if("left-center"===r||"right-center"===r)a="margin-top:-"+Math.ceil((o+i)/2)+"px;";else if("left-bottom"===r||"right-bottom"===r)a="bottom:20px;"}else if(1===+e)a="margin-top:-"+Math.ceil((o+i)/2)+"px;margin-left:-"+Math.ceil(n/2)+"px;";else a="transform: translate(-50%, -50%)";return a}),e.addFilter("getMarginP",function(e,t,i){var n="",r=location.href.indexOf("styleIndex");if(-1!==r)n="-"+Math.ceil(t/2)+"px 0 0 -"+Math.ceil(i/2)+"px";return n}),e.addFilter("isShowBgImg",function(e,t){return 1===t&&""!==e?"background:url("+e+")":""}),e.addFilter("getFlagBorderWidth",function(e){var t=242;return Math.ceil(t/100*(+e/2))}),e.addFilter("getFlagPosition",function(e,t){var i=0;if("left-center"===t||"right-center"===t)i=Math.floor(+e/2)+10-50;else i=+e+63;return"margin-top:"+i+"px"}),e.addFilter("getIconType",function(e,t){if(1===+e)return"wrapType"===t?"group":"show";else return"wrapType"===t?"icon":"hide"}),e.addFilter("getCustomerGroupsStyle",function(e,t,i){var n="";if(1===+e)if(n="background-color:"+t+";",1===+i)n+="margin-left:0;";return n}),e.addFilter("showMobileBgImg",function(e,t){var i="";if(1===+e&&""!==t)i="background-image:url("+t+")";return i}),e.addFilter("getInviteStyle",function(e,t){var i="nb-inviteWrap-";return 1===+e?"nb-customer-invite":i+t}),e.addFilter("getCustomerStyle",function(e){return 1===+e?"nb-icon-custom-defalut":""})}),define("newstyleManage/imgUpload",["require","jquery","./config","./tips"],function(require){function e(e,t){var i,n={};for(i in t)n[i]=e[i]>t[i].max?t[i].max:e[i],n[i]=e[i]<t[i].min?t[i].min:n[i];return n}function t(e){return e.replace(/\S+/g,function(e){return e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()})}var i=require("jquery"),n=require("./config"),exports={},r=require("./tips");return exports.init=function(o,a){var s=[];i(".img-upload").each(function(){s.push(o.get(i(this).attr("id")))}),s.forEach(function(s){s.on("uploadSuccess",function(s){if(s.name.indexOf(".")>0){var l=s.name.split("."),u=l[0],c=l[1];a.get(u)[c]=s.value}else a.set(s.name,s.value);var d=s.target.get("id");r.hideErrorTip(d);var f,h=a.get("target"),p=a.get("device"),g=e({width:s.width,height:s.height},n[p][h].sizeRange);for(f in g)a.set(f,g[f]),o.get("slider"+t(f)).set("value",g[f]),i("#"+f+"-num").html(g[f]);a.set("hasChange",!0),o.fire("refreshPreview")}),s.on("requireBg",function(e){var t=e.target,i=t.get("bgPrefix");
if(t.setBgImg(n.resource+i+a.get("webim").skinIndex+".png"),e.name.indexOf(".")>0){var r=e.name.split("."),s=r[0],l=r[1];a.get(s)[l]=e.value}else a.set(e.name,e.value);a.set("hasChange",!0),o.fire("refreshPreview")})})},exports}),define("newstyleManage/ueditorConfig",[],function(){return{toolbars:[""],wordCount:!0,maximumWords:50,initialStyle:"p{font: 17px 'Microsoft YaHei';font-weight: normal;font-style: normal;color: #fff;font-variant: normal;text-shadow:1px 1px 1px #000000;}",wordCountMsg:"{#count}&nbsp;/&nbsp;50&nbsp;&nbsp;&nbsp;",wordOverFlowMsg:'<span style="color: #ff0000;">50</span>',initialContent:"<p></p>",pasteplain:!0,UEDITOR_HOME_URL:"../output/asset/ueditor/"}}),define("newstyleManage/ueditorCtrl",["require","jquery","common/ueditorx/font","./ueditorConfig","./tips","./config"],function(require){var e=require("jquery");require("common/ueditorx/font");var t=require("./ueditorConfig"),i=require("./tips"),n=require("./config"),exports={},r=[];return exports.extractID=function(e){var t=[];return e.forEach(function(e){t.push(e.id)}),t},exports.getConfigInfoByID=function(e,t,i){var n="";return e.forEach(function(e){if(e.id===t)n=e[i]}),n},exports.init=function(o,a){var s=[],l=a.get("device"),u=a.get("target"),c=n[l][u].editorConfig,d=e.extend({},t,c),f=0,h=r.length;for(f=0;h>f;f++)try{r[f].destroy()}catch(p){}r=[],e("script[data-ueditor-id]").each(function(){var t=e(this),n=t.data(),o=n.ueditorId,a=n.maxLength,l=n.model,u=n.errorTipId;s.push(n);var c=t.parent(),f=UE.getEditor(o,d),h=!0;f.addListener("contentChange",function(){var e=this;if(e.getContentLength(!0)<=a&&!h)c.trigger("dataChange",{name:l,value:e.getContent(),type:"str"}),i.hideErrorTip(u);h=!1}),r.push(f)}),e("#style-manage-main").scroll(function(){r.forEach(function(e){try{e.fireEvent("hideFontBar")}catch(t){}})})},exports.editorHandlers=r,exports}),define("newstyleManage/skinGallery",["require","jquery","./config"],function(require){var e=require("jquery"),t=require("./config"),exports={};return exports.init=function(i,n){e(".skin-radios").on("change",function(r){var o=e(r.target),a=+o.val(),s=o.closest(".skin-gallery"),l=s.attr("data-gallery-id"),u=o.attr("data-skin-name-model");if(u)if(1===+n.get("isCustomerStyle"))o.trigger("dataChange",{name:u,value:o.attr("")});else o.trigger("dataChange",{name:u,value:o.attr("data-skin-name"),preventRefresh:!0});var c=[];e(".img-upload").each(function(){c.push(i.get(e(this).attr("id")))}),c.forEach(function(e){var i=e.get("bgPrefix");if(l===e.get("relateWith"))e.setBgImg(t.resource+i+a+".png")})})},exports}),define("newstyleManage/modelBind",["require","jquery"],function(require){var e=require("jquery"),exports={};return exports.init=function(t,i){e(".model-bind").on("change input dataChange",function(t,n){var r=e(t.target),o=(n?n.name:"")||r.attr("name"),a=r.val(),s=t.type;if("change"===s||"input"===s)var l=r.get(0).type.toLowerCase();if("change"===s)if("checkbox"===l)a=r.prop("checked")===!0?1:0;else if("textarea"===l||"text"===l)return!1;else a=+a;else if("dataChange"===s)if("num"===n.type)a=+n.value;else a=n.value;if("text"===l&&r.filter("[pattern-url]").length>0)if(""!==a){var u=/^(?:f|ht)tps?:\/\//;if(0!==a.search(u))a="http://"+a}if(t.stopPropagation(),o.indexOf(".")>0){var c=o.split("."),d=c[0],f=c[1];i.get(d)[f]=a}else i.set(o,a);i.set("hasChange",!0)})},exports}),define("newstyleManage/switch",["require","jquery"],function(require){var exports={},e=require("jquery");return exports.init=function(t){e("[data-switch-for]").on("change",function(i){var n,r=e(i.target),o=e(i.target).attr("data-switch-for").split(","),a=0,s=r.prop("checked");for(a=0;a<o.length;a++){var l;if(n=e('[name="'+o[a]+'"]'),n.length>0){if(n.prop("disabled",!s),l=t.get(o[a]))s?l.enable():l.disable();var u=n.attr("data-switch-for");if(u){var c=n.prop("checked");if(n=e('[name="'+u+'"]'),!s){if(n.prop("disabled",!0),l=t.get(u))l.disable()}else if(n.prop("disabled",!c),l=t.get(u))c?l.enable():l.disable()}}}}),e("[data-switch-position-for]").on("mouseup",function(i){var n=e(i.target),r=t.get("sliderWidth"),o=e(r.main).parent();if(""===n.text())o.hide();else o.show()})},exports}),define("newstyleManage/radioTab",["require","jquery"],function(require){var e=require("jquery"),exports={};return exports.init=function(){e(".radio-tab").on("change",function(t){var i=e(t.target),n=i.attr("data-for");n=n.split(".");var r=n[0],o=n[1],a=e("."+r);a.find(">.radio-tab-page").hide(),a.find("."+o).show()})},exports}),define("newstyleManage/saveConfirmation",["require","jquery","common/esuix/Dialog","./config"],function(require){var e=require("jquery"),t=require("common/esuix/Dialog"),i=require("./config"),exports={};return exports.init=function(n){var r=n.model;e("#type-tab .ui-tab-item").on("click",function(o){var a=e(o.target);if(e(o.currentTarget).hasClass("ui-tab-item-active"))return!1;if(r.get("hasChange")){var s=i.confirmDialogParam;s.content='<p class="info-title">'+i.targetNameCN[r.get("typeIndex")]+",</p>";var l=t.confirm(s);return l.on("ok",function(){n.fire("tryToSave",{successCallback:function(){a.trigger("click.escapeLoop")}})}),l.on("cancel",function(){a.trigger("click.escapeLoop")}),!1}})},exports}),define("newstyleManage/preview.tpl",[],function(){return"<!-- //  --><!-- target: pcinvitePreview --><!-- import: pcinviteDataPreview --><!-- target: pciconPreview --><!-- import: pciconDataPreview --><!-- target: pcwebimPreview --><!-- import: pcwebimDataPreview --><!-- target: pcmessageboardPreview --><!-- import: pcboardPreview --><!-- target: mobileiconPreview --><!-- import: mobileiconDataPreview --><!-- target: mobileinvitePreview --><!-- import: mobileinviteDataPreview --><!-- target: mobilewebimPreview --><!-- import: mobilewebimDataPreview --><!-- target: mobilemessageboardPreview --><!-- import: mobileboardDataPreview -->"}),define("newstyleManage/tpls/pc-preview/invite.tpl",[],function(){return'<!-- target: pcinviteDataPreview --><ins id="newBridge"><ins class="nb-invite-wrap nb-invite-wrap-base nb-position-base nb-middle ${isCustomer|isCustomerCheck(${isCustomerStyle}, \'invite\')} ${buttonType|getDriectStyle()}" id="nb-invite-wrap-js" style="width:${width}px;margin:${marginPosition|getMarginP(${height}, ${width})};"><ins class="nb-invite-body nb-invite-skin-${skinIndex}" style="height:${height}px;${isCustomerStyle|showCustomerImg(${customerStyle.backImg})}"><ins class="nb-invite-tool nb-invite-tool-base" id="nb-invite-tool-js" style=""></ins><ins class="nb-invite-text nb-invite-text-base"><!-- if: ${isShowText} == 1 --><ins class="nb-invite-welcome nb-invite-welcome-base" id="nb_invite_welcome">${welcome|\'\'}</ins><!-- /if --></ins><!-- if: ${buttonType} == 1 --><ins class="nb-invite-btn nb-invite-btn-base nb-invte-btns-${skinIndex}"><ins class="nb-invite-cancel nb-invite-cancel-base" id="nb-invite-cancel-js"></ins><!-- if: ${isCustomerStyle} == 1 --><ins class="nb-invite-ok nb-invite-ok-base" id="nb-invite-ok-js" style="background-color:${customerStyle.acceptBgColor};color:${customerStyle.acceptFontColor};"></ins><!-- else --><ins class="nb-invite-ok nb-invite-ok-base" id="nb-invite-ok-js"></ins><!-- /if --></ins><!-- /if --></ins><!-- if: ${buttonType} == 2 --><ins class="nb-invite-btn nb-invite-btn-skin-${skinIndex} nb-invte-btns-${buttonType}"><!-- if: ${isCustomerStyle} == 1 --><ins class="nb-invite-ok nb-invite-ok-base nb-direct-send-btn" id="nb-invite-ok-js" style="background-color:${sendButton.bgColor};color:${sendButton.fontColor};"></ins><!-- else --><ins class="nb-invite-ok nb-invite-ok-base nb-direct-send-btn" id="nb-invite-ok-js"></ins><!-- /if --><ins class="nb-invite-input-wrap"><input type="text" class="nb-invite-input invite-placeholder" id="nb_invite_input" maxlength="200" placeholder="" data-ph=""></ins></ins><!-- /if --></ins></ins>'}),define("newstyleManage/tpls/pc-preview/icon.tpl",[],function(){return'<!-- target: pciconDataPreview --><ins id="newBridge"><!-- if: ${width} != 0 --><ins class="nb-seek-wrap nb-seek-base seek-center nb-seek-${iconType|getIconType(\'wrapType\')} nb-seek-skin-${skinIndex} ${customerStyle|isCustomerCheck(${isCustomerStyle}, \'icon\')}" id="nb-seek-wrap" style="width:${width}px;${iconType|getIconPosition(${groups}, ${height}, ${width}, ${position})}"><ins class="nb-seek-icon" style="height:${height}px;width:${width}px;${backImg};${customerStyle.backImg|isShowBgImg(${isCustomerStyle})};"><ins class="nb-seek-bridge0 nb-seek-bridge-base" data-type="seekInvite" style=""></ins></ins><!-- if: ${iconType} == 1 --><!-- if: ${isCustomerStyle} == 1 --><ins class="nb-icon-groups show" style="background-color:${groupStyle.bgColor};${groupsMargin};" id="nb_icon_groups"><!-- else --><ins class="nb-icon-groups show" style="${groupsMargin};" id="nb_icon_groups"><!-- /if --><!-- for: ${groups} as ${group} --><!-- if: ${isCustomerStyle} == 1 --><ins class="icon-groups-item clearfix" data-id="${group.groupId}" style="background-color:${groupStyle.buttonColor};"><ins class="group-icon"></ins><ins class="group-text" style="color:${groupStyle.fontColor}">${group.groupName}</ins></ins><!-- else --><ins class="icon-groups-item clearfix" data-id="${group.groupId}"><ins class="group-icon"></ins><ins class="group-text">${group.groupName}</ins></ins><!-- /if --><!-- /for --><!-- /if --></ins><!-- /if --></ins><!-- /if --></ins>'}),define("newstyleManage/tpls/pc-preview/webim.tpl",[],function(){return'<!-- target: pcwebimDataPreview --><!-- if: ${isWebim} == 1--><div class="qiao-webim webim-${webim.skinIndex}"><div class="companyInfo"><div class="companyInfo-body"><!-- if: ${webim.displayCompany} == 1--><h3>${webim.cpyInfo}</h3><h4>${webim.cpyTel}</h4><!-- else --><h3></h3><!-- /if --></div></div><div class="business-info"><div id="bannerContainer"></div><div class="slogan-cont">${webim.slogan|}</div></div></div><!-- else --><div class="qiao-webimLight webimLight-${webimLight.skinIndex}"></div><!-- /if -->'}),define("newstyleManage/tpls/pc-preview/board.tpl",[],function(){return'<!-- target: pcboardPreview --><ins id="newBridge"><ins class="nb-nodeboard-base nb-nodeboard-position-base nb-nodeboard-center" id="nb-nodeboard"><ins class="nb-nodeboard-contain-base nb-nodeboard-contain"><ins class="nb-nodeboard-top nb-nodeboard-top-${skinIndex}"><span></span><ins class="nb-nodeboard-close" id="nb-nodeboard-close-js" data-type="min"></ins></ins><!-- if: ${displayCompany} == 1 --><ins id="nb-nodeboard-text-js" class="nb-nodeboard-text" style="display:${companyStyle};"><p class="nb-nodeboard-company">${cpyInfo}</p><p class="nb-nodeboard-link">${cpyTel}</p></ins><!-- /if --><form id="nb-board-form-js" class="nb-board-form" action="${domain}/bookmanage/saveBook.action" method="post" accept-charset="utf-8"><ins id="nb-nodeboard-set-js" class="nb-nodeboard-set"><ins class="nb-nodeboard-content"><textarea id="nb-nodeboard-set-content-js" name="content" data-ph="" placeholder="" class="nb-nodeboard-set-content" cols="30" disabled="disabled" maxLength="200">${content}</textarea></ins><!-- for: ${items} as ${item} --><!-- if: ${item.isShow} == 1 --><!-- if: ${item.name} == \'visitorName\' --><ins class="nb-nodeboard-name" style="z-index:${item.index};"><span class="title nodeName"></span><input id="nb-nodeboard-set-name-js" name="visitorName" maxlength="30" class="input" type="text" data-ph="${item.required|isRequire()}" placeholder="${item.required|isRequire()}" disabled="disabled"></ins><!-- /if --><!-- /if --><!-- if: ${item.isShow} == 1 --><!-- if: ${item.name} == \'visitorPhone\' --><ins class="nb-nodeboard-name" id="nb-nodeboard-phone-js" style="z-index:${item.index};"><span class="title nodePhone"></span><input id="nb-nodeboard-set-phone-js" name="visitorPhone" maxlength="30" class="input"  type="text" data-ph="${item.required|isRequire()}" placeholder="${item.required|isRequire()}" disabled="disabled"></ins><!-- /if --><!-- /if --><!-- if: ${item.isShow} == 1 --><!-- if: ${item.name} == \'visitorEmail\' --><ins class="nb-nodeboard-name" id="nb-nodeboard-mail-js" style="z-index:${item.index};"><span class="title nodeMail"></span><input id="nb-nodeboard-set-email-js" name="visitorEmail" maxlength="50" class="input" type="text" data-ph="${item.required|isRequire()}" placeholder="${item.required|isRequire()}" disabled="disabled"></ins><!-- /if --><!-- /if --><!-- if: ${item.isShow} == 1 --><!-- if: ${item.name} == \'visitorAddress\' --><ins class="nb-nodeboard-name" style="z-index:${item.index};"><span class="title nodeAddress"></span><input id="nb-nodeboard-set-address-js" name="visitorAddress" class="input" maxlength="50" type="text" data-ph="${item.required|isRequire()}" placeholder="${item.required|isRequire()}" disabled="disabled"></ins><!-- /if --><!-- /if --><!-- /for --><!-- for: ${itemsExt} as ${itemExt}, ${index} --><!-- if: ${itemExt}.subItems --><!-- if: ${itemExt.isShow} --><ins class="nb-nodeboard-ext-select" style="z-index:${itemExt.index}"><ins class="nb-nodeboard-select-title">${itemExt.question}</ins><ins class="nb-nodeboard-select-wrap" id="node_select_wrap_${index}"></ins></ins><!-- /if --><!-- else --><!-- if: ${itemExt.isShow} --><ins class="nb-nodeboard-name nb-nodeboard-ext-input" style="z-index:${itemExt.index};"><span class="icon"></span><input id="nb_nodeboard__ext_${index}" name="itemExt-${index}" class="input" maxlength="50" type="text" data-write="${itemExt.required}" data-ph="${itemExt.question}${itemExt.required|isRequire()}" placeholder="${itemExt.question}${itemExt.required|isRequire()}" disabled="disabled"></ins><!-- /if --><!-- /if --><!-- /for --></ins></form><ins class="nb-nodeboard-success" id="nb-nodeboard-success-js"><ins class="success-box"><ins class="success-icon"></ins><ins class="success-title" id="nb-node-messagetitle-js"></ins><ins class="success-content" id="nb-node-messagecontent-js"></ins><ins id="sucess-close-js" class="sucess-close"></ins></ins></ins><ins class="nb-nodeboard-send" id="nb-node-contain-js"><ins id="nb-nodeboard-send-js" class="nb-nodeboard-send-btn nb-nodeboard-send-btn-${skinIndex}"></ins></ins></ins></ins></ins><!-- end -->'}),define("newstyleManage/tpls/mobile-preview/icon.tpl",[],function(){return'<!-- target: mobileiconDataPreview --><div class="qiao-icaon-wrap"><ins id="newBridge" class="mobile-preview"><ins id="nb_icon_wrap" class="nb-icon-wrap nb-icon-${position} nb-icon-wrap-${skinIndex}" style="height:${height}%;width:${width}%;"><!-- if: ${isCustomerStyle} == 1 --><ins class="nb-icon-wrap-base nb-icon-customer nb-icon-custom-defalut" style="${isCustomerStyle|showCustomerImg(${customerStyle.backImg})};"></ins><!-- else --><ins class="nb-icon-wrap-base nb-icon-wrap-${skinIndex}-${position}"></ins><!-- if: ${skinIndex} == 2 || ${skinIndex} == 5 --><ins style="border-left-width: ${width|getFlagBorderWidth()}px;border-right-width: ${width|getFlagBorderWidth()}px;" class="nb-icon-flag nb-icon-flag-${skinIndex}"></ins><!-- /if --><!-- /if --></ins></div>'}),define("newstyleManage/tpls/mobile-preview/invite.tpl",[],function(){return'<!-- target: mobileinviteDataPreview --><div class="qiao-icaon-wrap"><ins id="newBridge" class="mobile-preview"><!-- if: ${position} === \'middle\' --><ins class="nb-inviteWrap-base ${isCustomerStyle|getInviteStyle(${skinIndex})} mobile-invite-${position}" id="nb-inviteWrap-js" style="min-height:${height}%;${isCustomerStyle|showMobileBgImg(${customerStyle.backImg})};width:${width}%;"><!-- else --><ins class="nb-inviteWrap-base ${isCustomerStyle|getInviteStyle(${skinIndex})} mobile-invite-${position}" id="nb-inviteWrap-js" style="min-height:${height}%;${isCustomerStyle|showMobileBgImg(${customerStyle.backImg})}"><!-- /if --><ins class="nb-invite-tool-base nb-invite-tool" id="nb-invite-tool-js"></ins><ins class="nb-invite-body-base nb-invite-body"><!-- if: ${isShowText} == 1 --><ins class="nb-invite-welcom">${welcome}</ins><!-- /if --><ins class="nb-invite-btns"><!-- if: ${isCustomerStyle} == 1 --><ins class="nb-invite-okbtn" id="nb-invite-okbtn-js" style="background-color: ${customerStyle.acceptBgColor}; color: ${customerStyle.acceptFontColor};"></ins><!-- else --><ins class="nb-invite-okbtn" id="nb-invite-okbtn-js"></ins><!-- /if --><ins class="nb-invite-nobtn" id="nb-invite-nobtn-js"></ins></ins></ins></ins></ins></div><!-- end -->'}),define("newstyleManage/tpls/mobile-preview/webim.tpl",[],function(){return'<!-- target: mobilewebimDataPreview --><div class="qiao-webim-mobile-wrap"><!-- if: ${displayCompany} == 1 --><div class="qiao-webim-mobile webim-mobile-${skinIndex}"><!-- else --><div class="qiao-webim-mobile webim-mobile-${skinIndex} qiao-customer-webim"><!-- /if --><!-- if: ${displayCompany} == 1 --><div class="webim-mobile-companyInfo"><h3>${cpyInfo}</h3><!-- if: ${cpyTel} --><h4 class="webimHasTel">${cpyTel}</h4><!-- /if --></div><!-- /if --><div class="webim-mobile-messages"></div></div></div>'}),define("newstyleManage/tpls/mobile-preview/board.tpl",[],function(){return'<!-- target: mobileboardDataPreview --><div id="mobile-msgboard-container"><div id="phone-bg-container"><div id="mobile-msgboard"><!-- if: ${displayCompany} == 1 --><div id="company-info-container"><!-- if: ${cpyInfo} != \'\' --><div id="msg-company-name">${cpyInfo}</div><!-- /if --><!-- if: ${cpyTel} != \'\' --><div id="msg-phone-number"><img class="phone-icon" src="http://webim.h.qiao.baidu.com/f/pool/img/webim/icon-tel.png">${cpyTel}</div><!-- /if --></div><!-- /if --><div></div><div id="msg-main-content"><div id="msg-preview-content-container"><div class="preview-title">()</div><div id="msg-preview-content" class="item placeholder"></div></div><div class="default-item-container"><!-- for: ${items} as ${defaultItem}, ${index} --><!-- if: ${defaultItem.isShow} == 1 --><div id="msg-preview-${defaultItem.name}"class="item placeholder"><i class="icon icon-${defaultItem.name}"></i><div class="frame"><span class="placeholder">${defaultItem.name|defaultNameTranslate}${defaultItem.required|isRequire(${defaultItem.required})}</span></div></div><!-- /if --><!-- /for --></div><!-- for: ${itemsExt} as ${customItem}, ${index} --><!-- if: ${customItem.isShow} == 1 --><!-- if: !${customItem.subItems} --><div class="input-question-container"><div class="question">${customItem.question}${customItem.required|isRequire(${customItem.required})}</div><div class="input-question item"></div></div><!-- else --><div class="selection-question"><span>${customItem.question}${customItem.required|isRequire(${customItem.required})}</span></div><div class="item item-ext selection-drop-down"><span class="option"></span><i class="icon-downward-arrow"></i></div><!-- /if --><!-- /if --><!-- /for --></div><div id="msg-preview-btn-container"><div id="msg-preview-send-btn"></div></div><div id="msg-preview-brand"></div></div></div></div>'}),define("newstyleManage/tpls/pcinvite.tpl",[],function(){return'<!-- target: pcinvite --><div data-ui="type:Tab;id:styleControllerTab;" id="style-controller-tab"><ul data-role="navigator" class="tab-title"><li data-for="basic-settings"></li><li data-for="theme-settings"></li><li data-for="position-settings"></li></ul></div><div id="basic-settings" class="settings-tab model-bind"><!-- import: autoInviteOptions --></div><div id="theme-settings" class="settings-tab model-bind"><div class="row bottom-gap"></div><!-- use: pcinviteButtonCtrl(buttonTypes=${buttonTypes},buttonTypeIndex=${buttonType}) --><hr class="bottom-gap" /><!-- import: themeTypeRadio --><div class="theme-tab"><div class="radio-tab-page default-theme ${isCustomerStyle|tabVisibility(0)}"><!-- // pc,tab --><!-- // etpl --><!-- use: skinGallery(bindModel=\'skinIndex\',skinIndex=${skinIndex},defaultSkins=${defaultSkins},device=${device},target=${target},skinNameModel=\'skinName\',galleryID="pcinvite") --></div><div class="radio-tab-page custom-theme ${isCustomerStyle|tabVisibility(1)}"><div class="row gray sub-title">680&times;320px</div><div class="row"><div data-ui="type:Uploader;id:invite-img-upload;required:true;name:customerStyle.backImg;mode:default;bgUrl: ${resource}fileuploadBg.png;imgUrl:${customerStyle.backImg}"id="invite-img-upload"data-validate=""data-validate-type="img"class="img-upload"name="customerStyle.backImg"></div></div><div class="row img-error-tip"><div class="error-tip" data-tip-for="invite-img-upload"></div></div><div class="button-ctrl"><!-- // 3,config --><div class="radio-tab-page button-type-1 top-gap ${buttonType|tabVisibility(1)}"><!-- import: acceptButtonCtrl --></div><div class="radio-tab-page button-type-0 top-gap ${buttonType|tabVisibility(0)}"></div><div class="radio-tab-page button-type-2 top-gap ${buttonType|tabVisibility(2)}"><!-- import: sendButtonCtrl --></div></div></div></div><div class="title bottom-gap"></div><div class="row bottom-gap"><label class="model-bind refresh-preview"><input type="checkbox"name="isShowText"value="1"${isShowText|checkboxChecked} /><span></span></label></div><!-- use: richEditor(maxLength=50,text=${welcome},bindModelName="welcome") --></div><div id="position-settings" class="settings-tab"><div data-ui="type:Position;id:posBox" class="position-loc"></div><div class="title bottom-gap"></div><section class="model-bind refresh-preview"><div class="row bottom-gap"><div class="size-tip"><span class="gray">(<span id="width-num">${width}</span>px)</span></div><!-- // data-bindmodel --><div data-ui="type:Slider;id:sliderWidth;value:${width};min:${minwidth};max:${maxwidth};dataBind:width"class="ui-slider-position"></div></div><div class="row"><div class="size-tip"><span class="gray">(<span id="height-num">${height}</span>px)</span></div><div data-ui="type:Slider;id:sliderHeight;value:${height};min:${minheight};max:${maxheight};dataBind:height"class="ui-slider-position"></div></div></section></div>'}),define("newstyleManage/tpls/pcwebim.tpl",[],function(){return'<!-- target: pcwebim --><div data-ui="type:Tab;id:styleControllerTab;" id="style-controller-tab"><ul data-role="navigator" class="tab-title"><li data-for="basic-settings"></li><li data-for="theme-settings"></li></ul></div><div id="basic-settings" class="settings-tab"><div class="row bottom-gap"></div><div class="row model-bind refresh-preview"><label><!-- // isWebim01filter --><!-- // radio-tabclassdata-fortab --><input type="radio"name="isWebim"value="1"class="radio-tab"data-for="webim-tab-container.webim"${isWebim|radioChecked(1)} /><span></span></label><label class="radio-gap"><input type="radio"name="isWebim"value="0"class="radio-tab"data-for="webim-tab-container.webim-lite"${isWebim|radioChecked(0)} /><span></span></label></div><div class="webim-tab-container"><!-- // tabVisibilityfilterwebim1radio-tab-page --><div class="webim radio-tab-page ${isWebim|tabVisibility(1)}"><div class="title bottom-gap top-gap"></div><!-- use: customerInfo(displayCompany={key:\'webim.displayCompany\', value:${webim.displayCompany}},cpyInfo={key:\'webim.cpyInfo\', value:${webim.cpyInfo}},cpyTel={key:\'webim.cpyTel\', value:${webim.cpyTel}}) --><div class="title bottom-gap"></div><div class="row gray sub-title">130&times;80px500Kb</div><div class="row"><div data-ui="type:Banner;id:bannerCtrl;bgUrl:${resource}webim-skin-logo-${webim.skinIndex}.png;relateWith:pcwebim;bgPrefix: webim-skin-logo-"class="img-upload"data-validate=""data-validate-type="banner"id="bannerCtrl"></div></div><div class="title bottom-gap top-gap"></div><!-- use: richEditor(maxLength=50,text=${webim.slogan},bindModelName="webim.slogan") --></div><div class="webim-lite radio-tab-page ${isWebim|tabVisibility(0)}"></div></div></div><div id="theme-settings" class="settings-tab model-bind"><div class="webim-tab-container"><div class="webim radio-tab-page ${isWebim|tabVisibility(1)}"><!-- // etpl --><!-- use: skinGallery(bindModel=\'webim.skinIndex\',skinIndex=${webim.skinIndex},defaultSkins=${defaultSkins},device=${device},target=${target},skinNameModel=\'skinName\',galleryID="pcwebim") --></div><div class="webim-lite radio-tab-page ${isWebim|tabVisibility(0)}"><!-- // trick2webimwebimlitemodel --><!-- use: skinGallery(bindModel=\'webimLight.skinIndex\',skinIndex=${webimLight.skinIndex},defaultSkins=${defaultSkins},device=${device},target=${target},skinNameModel=\'skinName\',galleryID="pcwebimlite") --></div></div></div>'}),define("newstyleManage/tpls/pcicon.tpl",[],function(){return'<!-- target: pcicon --><div data-ui="type:Tab;id:styleControllerTab;" id="style-controller-tab"><ul data-role="navigator" class="tab-title"><li data-for="basic-settings"></li><li data-for="theme-settings"></li><li data-for="position-settings"></li></ul></div><div id="basic-settings" class="settings-tab model-bind"><div class="row model-bind refresh-preview bottom-gap"><label><!-- // name,radioCheck(),value --><!-- // data-fortab.tabid --><input type="radio"name="iconType"value="0"class="radio-tab"data-for="icon-type-tab.pic-type"${iconType|radioChecked(0)} /><span></span></label><label class="radio-gap"><input type="radio"name="iconType"value="1"class="radio-tab"data-for="icon-type-tab.group-type"${iconType|radioChecked(1)} /><span></span></label></div><!-- // tabradio --><div class="icon-type-tab"><!-- // tab --><div class="pic-type radio-tab-page ${iconType|tabVisibility(0)}"><div class="row gray"></div></div><!-- // tab --><div class="group-type radio-tab-page ${iconType|tabVisibility(1)}"><div class="row gray">-</div><div class="group-box"><div data-ui="type:Button;id:addGroup" class="ui-button-ok ui-button-new button-new-group"></div><ul data-ui="type:Group;id:groupBox"></ul></div></div></div></div><div id="theme-settings" class="settings-tab model-bind"><!-- import: themeTypeRadio --><div class="theme-tab"><div class="radio-tab-page default-theme ${isCustomerStyle|tabVisibility(0)}"><!-- // etpl --><!-- use: skinGallery(bindModel=\'skinIndex\',skinIndex=${skinIndex},defaultSkins=${defaultSkins},device=${device},target=${target},skinNameModel=\'skinName\',galleryID="pcicon") --></div><div class="radio-tab-page custom-theme ${isCustomerStyle|tabVisibility(1)}"><div class="row gray sub-title">350&times;600px</div><div class="row"><div data-ui="type:Uploader;id:icon-img-upload;required:true;name:customerStyle.backImg;mode:default;bgUrl:${resource}fileuploadBg.png;imgUrl:${customerStyle.backImg}"id="icon-img-upload"data-validate=""data-validate-type="img"class="img-upload"name="customerStyle.backImg"></div></div><div class="row"><div class="error-tip img-error-tip" data-tip-for="icon-img-upload"></div></div><div class="icon-type-tab model-bind refresh-preview top-gap"><!-- // tab --><div class="group-type radio-tab-page ${iconType|tabVisibility(1)}"><div class="title bottom-gap"><div class="color-revert" data-color-group="group-color"></div></div><div class="row bottom-gap"><div class="intro">&nbsp;:</div><div class="color-preview"id="group-bg-color"name="groupStyle.bgColor"data-color-picker=""data-color-group="group-color"default-color="#ffffff"style="background-color:${groupStyle.bgColor}"></div></div><div class="row bottom-gap"><div class="intro">&nbsp;:</div><div class="color-preview"id="group-button-color"name="groupStyle.buttonColor"data-color-picker=""data-color-group="group-color"default-color="#d6f3ff"style="background-color:${groupStyle.buttonColor}"></div></div><div class="row"><div class="intro">&nbsp;:</div><div class="color-preview"id="group-font-color"name="groupStyle.fontColor"data-color-picker=""data-color-group="group-color"default-color="#008edf"style="background-color:${groupStyle.fontColor}"></div></div></div></div></div></div></div><div id="position-settings" class="settings-tab"><div data-ui="type:Position;id:posBox" class="position-loc"></div><div class="title bottom-gap"></div><section class="model-bind refresh-preview"><div class="row bottom-gap"><div class="size-tip"><span class="gray">(<span id="width-num">${width}</span>px)</span></div><!-- // data-bindmodel --><div data-ui="type:Slider;id:sliderWidth;value:${width};min:${minwidth};max:${maxwidth};dataBind:width"class="ui-slider-position"></div></div><div class="row"><div class="size-tip"><span class="gray">(<span id="height-num">${height}</span>px)</span></div><div data-ui="type:Slider;id:sliderHeight;value:${height};min:${minheight};max:${maxheight};dataBind:height"class="ui-slider-position"></div></div></section></div>'}),define("newstyleManage/tpls/pcmessageboard.tpl",[],function(){return'<!-- target: pcmessageboard --><div data-ui="type:Tab;id:styleControllerTab;" id="style-controller-tab"><ul data-role="navigator" class="tab-title"><li data-for="basic-settings"></li><li data-for="theme-settings"></li><li data-for="position-settings"></li></ul></div><div id="basic-settings" class="settings-tab"><div class="row bottom-gap"></div><div class="row model-bind"><label><input type="radio"name="isAlwaysDisplay"value="0"${isAlwaysDisplay|radioChecked(0)} /><span></span></label><label class="radio-gap"><input type="radio"name="isAlwaysDisplay"value="1"${isAlwaysDisplay|radioChecked(1)} /><span></span></label><label class="radio-gap"><input type="radio"name="isAlwaysDisplay"value="2"${isAlwaysDisplay|radioChecked(2)} /><span></span></label></div><div class="title bottom-gap top-gap"></div><!-- use: customerInfo(displayCompany={key:\'displayCompany\', value:${displayCompany}},cpyInfo={key:\'cpyInfo\', value:${cpyInfo}},cpyTel={key:\'cpyTel\', value:${cpyTel}}) --><div class="title bottom-gap top-gap">(4)</div><div class="row"><!-- //  --><div data-ui="type:messageBoardCMS;id:messageBoardCMS" id="messageBoardCMS"></div></div></div><div id="theme-settings" class="settings-tab"><!-- use: skinGallery(bindModel=\'skinIndex\',skinIndex=${skinIndex},defaultSkins=${defaultSkins},device=${device},target=${target},skinNameModel=\'skinName\',galleryID="pcmessageboard") --></div><div id="position-settings" class="settings-tab"><div data-ui="type:Position;id:posBox" class="position-loc"></div></div>'}),define("newstyleManage/tpls/mobileinvite.tpl",[],function(){return'<!-- target: mobileinvite --><div data-ui="type:Tab;id:styleControllerTab;" id="style-controller-tab"><ul data-role="navigator" class="tab-title"><li data-for="basic-settings"></li><li data-for="theme-settings"></li><li data-for="position-settings"></li></ul></div><div id="basic-settings" class="settings-tab model-bind"><!-- import: autoInviteOptions --></div><div id="theme-settings" class="settings-tab model-bind"><!-- import: themeTypeRadio --><div class="theme-tab"><div class="radio-tab-page default-theme ${isCustomerStyle|tabVisibility(0)}"><!-- // pc,tab --><!-- // etpl --><!-- use: skinGallery(bindModel=\'skinIndex\',skinIndex=${skinIndex},defaultSkins=${defaultSkins},device=${device},target=${target},skinNameModel=\'skinName\',galleryID="mobileinvite") --></div><div class="radio-tab-page custom-theme ${isCustomerStyle|tabVisibility(1)}"><div class="row"><div class="gray sub-title">640&times;260px1280&times;536px</div><div data-ui="type:Uploader;id:icon-img-upload;required:true;name:customerStyle.backImg;mode:default;bgUrl: ${resource}fileuploadBg.png;imgUrl:${customerStyle.backImg}"id="icon-img-upload"data-validate=""data-validate-type="img"class="img-upload"name="customerStyle.backImg"></div></div><div class="row"><div class="error-tip img-error-tip" data-tip-for="icon-img-upload"></div></div><!-- import: acceptButtonCtrl --></div></div><!-- import: greetingsEditor --></div><div id="position-settings" class="settings-tab refresh-preview"><div data-ui="type:Position;id:posBox;refresh:true" class="position-loc" data-switch-position-for="sliderWidth"></div><div class="title bottom-gap"></div><section class="model-bind refresh-preview row"><!-- if: ${position} === \'bottom\' --><div class="row bottom-gap" style="display:none;"><!-- else --><div class="row bottom-gap"><!-- /if --><div class="size-tip"><span class="gray">(<span id="width-num">${width}</span>${widthUnit})</span></div><!-- // data-bindmodel --><div data-ui="type:Slider;id:sliderWidth;value:${width};min:${minwidth};max:${maxwidth};dataBind:width"class="ui-slider-position"></div></div><div class="row"><div class="size-tip"><span class="gray">(<span id="height-num">${height}</span>${heightUnit})</span></div><!-- // data-bindmodel --><div data-ui="type:Slider;id:sliderHeight;value:${height};min:${minheight};max:${maxheight};dataBind:height"class="ui-slider-position"></div></div></section></div>';
}),define("newstyleManage/tpls/mobilewebim.tpl",[],function(){return'<!-- target: mobilewebim --><div data-ui="type:Tab;id:styleControllerTab;" id="style-controller-tab"><ul data-role="navigator" class="tab-title"><li data-for="basic-settings"></li></ul></div><div id="basic-settings" class="settings-tab"><!-- use: customerInfo(displayCompany={key:\'displayCompany\', value:${displayCompany}},cpyInfo={key:\'cpyInfo\', value:${cpyInfo}},cpyTel={key:\'cpyTel\', value:${cpyTel}}) --></div>'}),define("newstyleManage/tpls/mobileicon.tpl",[],function(){return'<!-- target: mobileicon --><div data-ui="type:Tab;id:styleControllerTab;" id="style-controller-tab"><ul data-role="navigator" class="tab-title"><li data-for="theme-settings"></li><li data-for="position-settings"></li></ul></div><div id="theme-settings" class="settings-tab model-bind"><!-- import: themeTypeRadio --><div class="theme-tab"><div class="radio-tab-page default-theme ${isCustomerStyle|tabVisibility(0)}"><!-- // pc,tab --><!-- // etpl --><!-- use: skinGallery(bindModel=\'skinIndex\',skinIndex=${skinIndex},defaultSkins=${defaultSkins},device=${device},target=${target},skinNameModel=\'skinName\',galleryID="mobileicon") --></div><div class="radio-tab-page custom-theme ${isCustomerStyle|tabVisibility(1)}"><div class="row"><div class="gray sub-title">120&times;120px240&times;240px</div><div data-ui="type:Uploader;id:icon-img-upload;required:true;name:customerStyle.backImg;mode:default;bgUrl: ${resource}fileuploadBg.png;imgUrl:${customerStyle.backImg}"id="icon-img-upload"data-validate=""data-validate-type="img"class="img-upload"name="customerStyle.backImg"></div></div><div class="row"><div class="error-tip img-error-tip" data-tip-for="icon-img-upload"></div></div></div></div></div><div id="position-settings" class="settings-tab refresh-preview"><div data-ui="type:Position;id:posBox;refresh:true" class="position-loc"></div><div class="title bottom-gap"></div><section class="model-bind refresh-preview"><div class="row bottom-gap"><div class="size-tip"><span class="gray">(<span id="width-num">${width}</span>${widthUnit})</span></div><!-- // data-bindmodel --><div data-ui="type:Slider;id:sliderWidth;value:${width};min:${minwidth};max:${maxwidth};dataBind:width"class="ui-slider-position"></div></div><div class="row"><div class="size-tip"><span class="gray">(<span id="height-num">${height}</span>${heightUnit})</span></div><div data-ui="type:Slider;id:sliderHeight;value:${height};min:${minheight};max:${maxheight};dataBind:height"class="ui-slider-position"></div></div></section></div>'}),define("newstyleManage/tpls/mobilemessageboard.tpl",[],function(){return'<!-- target: mobilemessageboard --><div data-ui="type:Tab;id:styleControllerTab;" id="style-controller-tab"><ul data-role="navigator" class="tab-title"><li data-for="basic-settings"></li></ul></div><div id="basic-settings" class="settings-tab"><!-- use: customerInfo(displayCompany={key:\'displayCompany\', value:${displayCompany}},cpyInfo={key:\'cpyInfo\', value:${cpyInfo}},cpyTel={key:\'cpyTel\', value:${cpyTel}}) --><div class="title bottom-gap top-gap">(4)</div><div class="row"><!-- //  --><div data-ui="type:messageBoardCMS;id:messageBoardCMS" id="messageBoardCMS"></div></div></div>'}),define("newstyleManage/tpls/skinGallery.tpl",[],function(){return'<!-- //  --><!-- target: skinGallery --><!-- // model-bindrefreshPreviewmodel --><div class="skin-gallery model-bind refresh-preview" data-gallery-id="${galleryID}"><!-- for: ${defaultSkins} as ${skinName}, ${index} --><div class="container ${device}-${target}"><label><input type="radio"class="skin-radios"value="${index}"name="${bindModel}"data-skin-name="${skinName}"data-skin-name-model="${skinNameModel}"${skinIndex|radioChecked(${index})} /><div class="skin-thumb theme-index-${index}"></div><div class="skin-name">${skinName}</div></label></div><!-- /for --></div>'}),define("newstyleManage/tpls/miscs.tpl",[],function(){return'<!-- //  --><!-- target: autoInviteOptions --><div class="row bottom-gap"><label><input type="checkbox"name="autoInvite"data-switch-for="startPage,stayTime,reInvite,autoHide"${autoInvite|checkboxChecked} /><span></span></label></div><div class="title bottom-gap"></div><section class="bottom-gap"><div class="row sub-title"></div><div class="row"><label><input type="radio"name="startPage"value="1"${autoInvite|isDisabled}${startPage|radioChecked(1)} /><span></span></label><label class="radio-gap"><input type="radio"name="startPage"value="0"${autoInvite|isDisabled}${startPage|radioChecked(0)} /><span></span></label></div></section><hr class="bottom-gap" /><section><div class="row sub-title"></div><div class="row bottom-gap"><span class="gray">(1 - 600)</span><!-- // value:${stayTime}esui --><div data-ui="type:RangeInput;id:stayTime;width:63;name:stayTime;value:${stayTime};unit:;step: 10;maximum: 600;minimum: 1;disabled:${autoInvite|disableSwitch([])}"class="time-count"></div></div></section><hr class="bottom-gap" /><section><div class="row sub-title"><label><input type="checkbox"name="reInvite"data-switch-for="inviteInterval"${autoInvite|isDisabled}${reInvite|checkboxChecked} /><span></span></label></div><div class="row bottom-gap"><span class="gray">(1 - 600)</span><div data-ui="type:RangeInput;id:inviteInterval;width:63;name:inviteInterval;value:${inviteInterval};unit:;step: 10;maximum: 600;minimum: 1;disabled:${autoInvite|disableSwitch([${reInvite}])};"class="time-count"></div></div></section><hr class="bottom-gap" /><section><div class="row sub-title"><label><input type="checkbox"name="autoHide"data-switch-for="closeTime"${autoInvite|isDisabled}${autoHide|checkboxChecked} /><span></span></label></div><div class="row"><span class="gray">(1 - 600)</span><div data-ui="type:RangeInput;id:closeTime;width:63;name:closeTime;value:${closeTime};unit:;step: 10;maximum: 600;minimum: 1;disabled:${autoInvite|disableSwitch([${autoHide}])}"class="time-count"></div></div></section><!-- // radio --><!-- target: themeTypeRadio --><!-- // model-bindrefreshPreviewmodel --><div class="row model-bind refresh-preview bottom-gap"><label><!-- // name,radioCheck(),value --><!-- // data-fortab.tabid --><input type="radio"name="isCustomerStyle"value="0"class="radio-tab"data-for="theme-tab.default-theme"${isCustomerStyle|radioChecked(0)} /><span></span></label><label class="radio-gap"><input type="radio"name="isCustomerStyle"value="1"class="radio-tab"data-for="theme-tab.custom-theme"${isCustomerStyle|radioChecked(1)} /><span></span></label></div><!-- target: acceptButtonCtrl --><section class="model-bind refresh-preview"><div class="title bottom-gap"><div class="color-revert" data-color-group="invite-btn"></div></div><div class="row bottom-gap"><div class="intro">&nbsp;:</div><div class="color-preview"id="accept-bg-color"name="customerStyle.acceptBgColor"data-color-picker=""default-color="#fecb2e"data-color-group="invite-btn"style="background-color:${customerStyle.acceptBgColor}"></div></div><div class="row bottom-gap"><div class="intro">&nbsp;:</div><div class="color-preview"id="accept-font-color"name="customerStyle.acceptFontColor"data-color-picker=""default-color="#000000"data-color-group="invite-btn"style="background-color:${customerStyle.acceptFontColor}"></div></div></section><!-- target: sendButtonCtrl --><section class="model-bind refresh-preview"><div class="title bottom-gap"><div class="color-revert" data-color-group="send-btn"></div></div><div class="row bottom-gap"><div class="intro">&nbsp;:</div><div class="color-preview"id="send-bg-color"name="sendButton.bgColor"data-color-picker=""default-color="#bfecff"data-color-group="send-btn"style="background-color:${sendButton.bgColor}"></div></div><div class="row bottom-gap"><div class="intro">&nbsp;:</div><div class="color-preview"id="send-font-color"name="sendButton.fontColor"data-color-picker=""default-color="#1980df"data-color-group="send-btn"style="background-color:${sendButton.fontColor}"></div></div></section><!-- target: customerInfo --><section class="model-bind refresh-preview"><div class="row bottom-gap"><label><input type="checkbox"name="${displayCompany.key}"data-switch-for="${cpyInfo.key},${cpyTel.key}"${displayCompany.value|checkboxChecked} /><span></span></label></div><div class="row bottom-gap"><input type="text"class="text-box"placeholder=""name="${cpyInfo.key}"value="${cpyInfo.value}"spellcheck="false"maxlength="20"${displayCompany.value|isDisabled} /></div><div class="row bottom-gap"><input type="text"class="text-box"placeholder=""name="${cpyTel.key}"value="${cpyTel.value}"spellcheck="false"maxlength="20"${displayCompany.value|isDisabled} /></div></section><!-- target: greetingsEditor --><!-- // model-bindrefreshPreviewmodel --><section class="model-bind refresh-preview"><div class="title bottom-gap"></div><div class="row bottom-gap"><label><input type="checkbox"name="isShowText"data-switch-for="welcome"value="1"${isShowText|checkboxChecked} /><span></span></label></div><div class="row"><!-- // data-validate --><textarea name="welcome"id="greeting-editor"spellcheck="false"maxlength="50"${isShowText|isDisabled}>${welcome}</textarea></div><div class="row limit-info">50</div></section><!-- target: richEditor --><div class="row model-bind refresh-preview"><!-- // containerueditorscript, --><div class="ueditor-container"data-ueditor-id="rich-text-greetings-editor"data-validate=""data-max-length="${maxLength}"data-error-tip-id="richGreetings"data-validate-type="ueditor" ><!-- // filterhtml escape,js --><script id="rich-text-greetings-editor"type="text/plain"data-ueditor-id="rich-text-greetings-editor"data-max-length="${maxLength}"data-error-tip-id="richGreetings"data-model="${bindModelName}">${text|\'\'}</script></div></div><div class="row"><!-- // ueditordata-error-tip-id --><div class="error-tip img-error-tip" data-tip-for="richGreetings"></div></div>'}),define("newstyleManage/tpls/pcinviteButtonCtrl.tpl",[],function(){return'<!-- target: pcinviteButtonCtrl--><div class="skin-gallery pcinvite-button-ctrl model-bind refresh-preview"><!-- for: ${buttonTypes} as ${buttonType}, ${index} --><div class="container"><label><input type="radio"name="buttonType"class="radio-tab invite-btn-type-radio"data-for="button-ctrl.button-type-${buttonType.value}"value="${buttonType.value}"${buttonTypeIndex|radioChecked(${buttonType.value})} /><div class="skin-thumb invite-btn-type-${buttonType.value}"></div><div class="skin-name">${buttonType.name}</div></label></div><!-- /for --></div>'}),define("common/esuix/pickColor",["require","esui/main","esui/lib","esui/Control","esui/Layer","mini-event/EventTarget","jquery"],function(require){function e(){p.apply(this,arguments)}function t(e){var t=e.target,i=t.className;switch(i){case"ui-button-ok":this.saveColorCode();break;case"ui-button-circle":this.hide();break;case"ui-pickcolor-handel":this.setPanelColor(e);break;case"ui-pickcolor-handel-bg":this.setPanelColor(e)}}function i(e){var t=e.target,i=t.className;switch(i){case"ui-pickcolor-value":this.inputColorCode(e)}}function n(t){h.apply(this,arguments),this.colorCode=null,this.hsv={h:0,s:0,v:1},this.targetEles=null,this.targetElesData={},this.layer=new e(this),this.view={panel:null,codeValue:null,preview:null,btnOk:null,btnCancel:null,dot:null,pointer:null},this.init(t)}function r(e){e=e.replace("#","");var t,i=e.split("");if(6===i.length)t="#"+i.join("");else{for(var n=6-i.length;n;)i.unshift(0),n--;t="#"+i.join("")}return t}function o(e){for(var t=/^[0-9a-fA-F]$/,i=!0,n=e.split(""),r=0,o=n.length;o>r;r++)if(!t.test(n[r])){i=!1;break}return i}function a(e){e=e.replace("#","");var t=parseInt(e.substr(0,2),16),i=parseInt(e.substr(2,2),16),n=parseInt(e.substr(4,2),16);return{r:t,g:i,b:n}}function s(e,t,i){var n,r,o=e/255,a=t/255,s=i/255,l=Math.max(Math.max(o,a),s),u=Math.min(Math.min(o,a),s),c=l;if(u===l)n=0,r=0;else{var d=l-u;if(r=d/l,o===l)n=(a-s)/d;else if(a===l)n=2+(s-o)/d;else n=4+(o-a)/d;if(n/=6,0>n)n+=1;if(n>1)n-=1}return{h:Math.floor(1e3*n)/1e3,s:Math.floor(1e3*r)/1e3,v:Math.floor(1e3*c)/1e3}}function l(e){var t=this.getPanelColor(e.top);c(100,this,this.setPanelBackColor)(t),c(100,this,this.updataViewContent)(this.getColorCode()),c(100,this,this.updataColorCode)()}function u(e){var t=e.left,i=e.top;this.hsv.s=t/255,this.hsv.v=(255-i)/255,c(100,this,this.updataViewContent)(this.getColorCode()),c(100,this,this.updataColorCode)()}function c(e,t,i){var n=null;if(!i.throttleOld)i.throttleOld=(new Date).getTime(),n=function(){i.apply(t,arguments)};else n=function(){var n=(new Date).getTime();if(n-i.throttleOld>e)i.apply(t,arguments),i.throttleOld=n};return n}var d=require("esui/main"),f=require("esui/lib"),h=require("esui/Control"),p=require("esui/Layer"),g=require("mini-event/EventTarget"),v=require("jquery");return f.inherits(e,p),e.prototype.itemTemplate='<div class="${main}"><div class="${head}"><div class="${panel}"><span class="${dot}"></span></div><div class="${handel}"><div class="${handelBg}"></div><span class="${pointer}"></span></div></div><div class="${cont}"><span class="${tip}">#</span><input class="${value}" maxlength="6"><div class="${view}"></div><span class="ui-button-circle"></span><span class="ui-button-ok"></span></div></div>',e.prototype.render=function(e){var t={main:this.control.helper.getPartClasses("main"),head:this.control.helper.getPartClasses("head"),panel:this.control.helper.getPartClasses("panel"),dot:this.control.helper.getPartClasses("dot"),handel:this.control.helper.getPartClasses("handel"),handelBg:this.control.helper.getPartClasses("handel-bg"),pointer:this.control.helper.getPartClasses("pointer"),cont:this.control.helper.getPartClasses("cont"),tip:this.control.helper.getPartClasses("tip"),value:this.control.helper.getPartClasses("value"),view:this.control.helper.getPartClasses("view"),okId:this.control.helper.getId("ok"),cancelId:this.control.helper.getId("cancelId")},i=f.format(this.itemTemplate,t);e.innerHTML=i},e.prototype.initBehavior=function(e){this.control.helper.addDOMEvent(e,"click",t),this.control.helper.addDOMEvent(e,"keyup",i)},e.prototype.hide=function(e){if(!e&&this.control.active)this.control.cancelColorCode();p.prototype.hide.call(this)},n.prototype.dragHandler=function(e){var t=e.bar,i=e.target,n=e.maxHeight,r=e.maxWidth,o=e.callBack,a=e.withMouse,s=i.height()/2,l=i.width()/2,u=this.view.panel,c=v(document),d=null,f=null,h={},p=this;t.dragFlag=!1,t.on("mousedown",function(e){if(t.dragFlag=!0,h.left=e.clientX,h.top=e.clientY,h.tagTop=parseInt(i.css("top"),10),h.tagLeft=parseInt(i.css("left"),10),a){var n=e.clientX-u.offset().left,r=e.clientY-u.offset().top;h.tagTop=r,h.tagLeft=n,p.setDotPos(n,r);var s=n>255?255:n,l=r>255?255:r;s=0>s?0:s,l=0>l?0:l,o.apply(p,[{left:s,top:l}])}}),c.on("mousemove",function(e){if(t.dragFlag){var a=e.clientX-h.left,u=e.clientY-h.top;d=h.tagTop+u,f=h.tagLeft+a;var c,g;if(n){if(-s>d)c=-s;else if(d>n)c=n-s;else c=d;i.css("top",c)}if(r){if(-l>f)g=-l;else if(f>r)g=r-l;else g=f;i.css("left",g)}var v=f>255?255:f,m=d>255?255:d;v=0>v?0:v,m=0>m?0:m,o&&o.apply(p,[{left:v,top:m}]),e.preventDefault()}}),c.on("mouseup",function(e){t.dragFlag=!1})},n.prototype.type="pickColor",g.enable(n),n.prototype.inputColorCode=function(e){var t=this.view.codeValue.val();if(o(t)){var i=r(t),n=a(i),l=s(n.r,n.g,n.b);this.hsv=l,this.setColorPos(),this.setPreview(i),this.colorCode=i,this.updataColorCode()}},n.prototype.saveColorCode=function(){this.callBackFunc&&this.callBackFunc(),this.targetElesData[this.targetEles].color=this.colorCode,this.fire("ok",{data:{ele:this.targetElesData[this.targetEles].ele,color:this.targetElesData[this.targetEles].color}}),this.hide(!0)},n.prototype.cancelColorCode=function(){this.fire("cancel",{data:{ele:this.targetElesData[this.targetEles].ele,color:this.targetElesData[this.targetEles].color}})},n.prototype.updataColorCode=function(){this.fire("update",{data:{ele:this.targetElesData[this.targetEles].ele,color:this.colorCode}})},n.prototype.getPanelColor=function(e){if(0>e)e=0;if(e>255)e=255;this.hsv.h=(255-e)/255;var t=this.getColorCode({h:this.hsv.h,s:1,v:1});return t},n.prototype.setPanelColor=function(e){var t=e.offsetY,i=this.getPanelColor(t);this.setPanelBackColor(i),this.setPointerPos(t-this.view.pointer.height()/2),this.updataViewContent(i),this.updataColorCode()},n.prototype.setPanelBackColor=function(e){this.view.panel.css("backgroundColor",e)},n.prototype.setPointerPos=function(e){this.view.pointer.css("top",e)},n.prototype.getColorPos=function(e){var t=e.offsetX,i=e.offsetY;this.hsv.s=t/255,this.hsv.v=(255-i)/255;var n=this.getColorCode();this.setDotPos(t,i),this.updataViewContent(n)},n.prototype.setColorPos=function(e){var t=Math.floor(255*this.hsv.s-this.view.dot.width()/2),i=Math.floor(255-255*this.hsv.v-this.view.dot.height()/2);this.setDotPos(t,i);var n=Math.floor(255-255*this.hsv.h-this.view.pointer.height()/2);if(n>255)n=255-this.view.pointer.height()/2;this.setPointerPos(n);var r=this.getColorCode({h:this.hsv.h,s:1,v:1});this.setPanelBackColor(r)},n.prototype.setDotPos=function(e,t){var i=this.view.dot,n=this.dotPosHandler({x:e-i.width()/2,y:t-i.height()/2});i.css({left:n.left,top:n.top}),i.show()},n.prototype.dotPosHandler=function(e){var t,i,n=this.view.dot,r=255-n.width(),o=0,a=255-n.height(),s=0;if(e.x<o)t=o;else if(e.x>r)t=r;else t=e.x;if(e.y<s)i=s;else if(e.y>a)i=a;else i=e.y;return{left:t,top:i}},n.prototype.updataView=function(){this.view.main=v(".ui-pickcolor-main").last(),this.view.panel=v(".ui-pickcolor-panel").last(),this.view.pointer=v(".ui-pickcolor-pointer").last(),this.view.codeValue=v(".ui-pickcolor-value").last(),this.view.preview=v(".ui-pickcolor-view").last(),this.view.btnOk=v(".ui-button-ok").last(),this.view.btnCancel=v(".ui-button-circle").last(),this.view.dot=v(".ui-pickcolor-dot").last(),this.view.handel=v(".ui-pickcolor-handel").last()},n.prototype.updataViewContent=function(e){this.view.codeValue.val(e.replace("#","")),this.setPreview(e),this.colorCode=e},n.prototype.setPreview=function(e){this.view.preview.css("background",e)},n.prototype.setColor=function(e,t){this.colorCode=t,this.setTargetElesData(e,t)},n.prototype.getColorCode=function(e){e=e||{};var t=this.hsv,i=e.h||t.h,n=e.s||t.s,r=e.v||t.v,o=this.hsv2rgb(i,n,r);return"#"+this.rgb2hex(o.r)+this.rgb2hex(o.g)+this.rgb2hex(o.b)},n.prototype.rgb2hex=function(e){if(e=e.toString(16),1===e.length)e="0"+e;return e},n.prototype.hsv2rgb=function(e,t,i){var n,r,o;if(0===t)n=255*i,r=255*i,o=255*i;else{var a=6*e;if(6===a)a=0;var s=Math.floor(a),l=i*(1-t),u=i*(1-t*(a-s)),c=i*(1-t*(1-(a-s)));switch(s){case 0:n=i,r=c,o=l;break;case 1:n=u,r=i,o=l;break;case 2:n=l,r=i,o=c;break;case 3:n=l,r=u,o=i;break;case 4:n=c,r=l,o=i;break;default:n=i,r=l,o=u}n=255*n,o=255*o,r=255*r}return{r:Math.ceil(n),g:Math.ceil(r),b:Math.ceil(o)}},n.prototype.setTargetElesData=function(e,t){this.targetElesData[e]={ele:e,color:t}},n.prototype.render=function(e){this.targetEles=e.ele,this.callBackFunc=e.callBackFunc;var t=this.targetElesData[e.ele]?this.targetElesData[e.ele].color:e.color;this.setTargetElesData(e.ele,t),this.show(e);var i=this.getPos(e);this.setPos(i)},n.prototype.show=function(e){if(e=e||{},this.view.codeValue){var t=this.targetElesData[e.ele]?this.targetElesData[e.ele].color:e.color,i=r(t);this.updataViewContent(i);var n=a(i),o=s(n.r,n.g,n.b);this.hsv=o,this.setColorPos(e)}this.layer.show()},n.prototype.hide=function(e){if(this.view.pointer)this.view.pointer.dragFlag=!1,this.view.panel.dragFlag=!1;this.layer.hide(e)},n.prototype.getPos=function(e){var t=this.getPosHandler(e);return{left:t.left,top:t.top}},n.prototype.getPosHandler=function(e){var t=v(e.ele),i=t.offset().left,n=t.offset().top,r=t.outerWidth(),o=t.outerHeight(),a=v(window).width(),s=v(window).height(),l=this.view.main.outerWidth(),u=this.view.main.outerHeight(),c=v(document).scrollTop(),d=v(document).scrollLeft(),f=a-(i-d+r),h=s-(n-c+o),p=null,g=null;if(f>l+e.left)p=i+r+e.left;else p=i-l-e.left;if(h>u+e.top)g=n+e.top;else g=s-u+c;return{left:p,top:g}},n.prototype.setPos=function(e){var t=this.layer.getElement();t.style.left=e.left+"px",t.style.top=e.top+"px"},n.prototype.init=function(e){function t(t){n.callBackFunc=null,i.render(v.extend(n,e[t.data]))}var i=this,n={left:0,top:0,color:"#ffffff",callBackFunc:null};this.show(),this.hide(!0),this.updataView(),this.dragHandler({target:this.view.pointer,bar:this.view.pointer,maxHeight:this.view.handel.height(),callBack:l}),this.dragHandler({target:this.view.dot,bar:this.view.panel,maxHeight:this.view.panel.height(),maxWidth:this.view.panel.width(),callBack:u,withMouse:!0});for(var r=0,o=e.length;o>r;r++)v(e[r].ele).bind("click",r,t);v(window).on("resize.PickColor",function(){i.hide()})},n.prototype.dispose=function(){if(!this.helper.isInStage("DISPOSED")){if(this.layer)this.layer.dispose(),this.layer=null;v(window).off("resize.PickColor"),h.prototype.dispose.apply(this,arguments)}},f.inherits(n,h),d.register(n),n}),define("newstyleManage/colorPickerCtrl",["require","jquery","common/esuix/pickColor"],function(require){var e=require("jquery"),t=require("common/esuix/pickColor"),exports={},i=null,n=[],r=null;return exports.init=function(o){if(i=e("[data-color-picker]"),i.each(function(){var t,i=e(this),r=i.attr("id"),a=i.attr("name"),s=i.attr("default-color"),l=i.attr("data-color-group");if(a.indexOf(".")>0){var u=a.split("."),c=u[0],d=u[1];t=o.get(c)[d]}else t=o.get(a);n.push({ele:"#"+r,color:t,defaultColor:s,left:80,group:l})}),n.length>0)r=new t(n),r.on("ok",function(t){var i=e(t.data.ele);i.trigger("dataChange",{value:t.data.color,type:"str"}),i.css("background-color",t.data.color)}),r.on("update",function(t){var i=e(t.data.ele);i.trigger("dataChange",{value:t.data.color,type:"str"}),i.css("background-color",t.data.color)}),r.on("cancel",function(t){var i=e(t.data.ele);i.trigger("dataChange",{value:t.data.color,type:"str"}),i.css("background-color",t.data.color)});e(".color-revert").on("click",function(){var t=e(this).attr("data-color-group");n.forEach(function(i){var n=e(i.ele);if(i.group===t)r.setColor(i.ele,i.defaultColor),n.css("background-color",i.defaultColor),n.trigger("dataChange",{value:i.defaultColor,type:"str"})})})},exports.dispose=function(){if(r)r.dispose();r=null},exports}),define("newstyleManage/StyleManageView",["require","etpl","er/util","ef/UIView","esui/Tab","common/esuix/RangeInput","common/esuix/Slider","common/ueditorx/font","./widget/Position","./widget/Group","./widget/Uploader","./widget/messageBoardCMS/MessageBoardCMS","./widget/Banner","jquery","./main.tpl","./filters","./imgUpload","./ueditorCtrl","./skinGallery","./modelBind","./switch","./radioTab","./saveConfirmation","./preview.tpl","./tpls/pc-preview/invite.tpl","./tpls/pc-preview/icon.tpl","./tpls/pc-preview/webim.tpl","./tpls/pc-preview/board.tpl","./tpls/mobile-preview/icon.tpl","./tpls/mobile-preview/invite.tpl","./tpls/mobile-preview/webim.tpl","./tpls/mobile-preview/board.tpl","./tpls/pcinvite.tpl","./tpls/pcwebim.tpl","./tpls/pcicon.tpl","./tpls/pcmessageboard.tpl","./tpls/mobileinvite.tpl","./tpls/mobilewebim.tpl","./tpls/mobileicon.tpl","./tpls/mobilemessageboard.tpl","./tpls/skinGallery.tpl","./tpls/miscs.tpl","./tpls/pcinviteButtonCtrl.tpl","./colorPickerCtrl"],function(require){function e(){n.apply(this,arguments)}var t=require("etpl"),i=require("er/util"),n=require("ef/UIView");require("esui/Tab"),require("common/esuix/RangeInput"),require("common/esuix/Slider"),require("common/ueditorx/font"),require("./widget/Position"),require("./widget/Group"),require("./widget/Uploader"),require("./widget/messageBoardCMS/MessageBoardCMS"),require("./widget/Banner");var r=require("jquery"),o=require("./main.tpl");require("./filters");var a=require("./imgUpload"),s=require("./ueditorCtrl"),l=require("./skinGallery"),u=require("./modelBind"),c=require("./switch"),d=require("./radioTab"),f=require("./saveConfirmation"),h=require("./preview.tpl");return t.compile(h),t.compile(require("./tpls/pc-preview/invite.tpl")),t.compile(require("./tpls/pc-preview/icon.tpl")),t.compile(require("./tpls/pc-preview/webim.tpl")),t.compile(require("./tpls/pc-preview/board.tpl")),t.compile(require("./tpls/mobile-preview/icon.tpl")),t.compile(require("./tpls/mobile-preview/invite.tpl")),t.compile(require("./tpls/mobile-preview/webim.tpl")),t.compile(require("./tpls/mobile-preview/board.tpl")),t.compile(require("./tpls/pcinvite.tpl")),t.compile(require("./tpls/pcwebim.tpl")),t.compile(require("./tpls/pcicon.tpl")),t.compile(require("./tpls/pcmessageboard.tpl")),t.compile(require("./tpls/mobileinvite.tpl")),t.compile(require("./tpls/mobilewebim.tpl")),t.compile(require("./tpls/mobileicon.tpl")),t.compile(require("./tpls/mobilemessageboard.tpl")),t.compile(require("./tpls/skinGallery.tpl")),t.compile(require("./tpls/miscs.tpl")),t.compile(require("./tpls/pcinviteButtonCtrl.tpl")),t.parse(o),e.prototype.template="main",e.prototype.uiProperties={typeTab:{activeIndex:"@typeIndex"},posBox:{pos:"@posConfig",checked:"@position"},groupBox:{fields:"@groups",name:"groupName",maxLength:8},messageBoardCMS:{items:"@items",itemsExt:"@itemsExt"},bannerCtrl:{value:"@webim.banners"}},e.prototype.uiEvents={typeTab:{activate:function(e){this.fire("targetChanged",{activeIndex:e.target.activeIndex})}},posBox:{change:function(e){if(this.model.set(e.name,e.value),this.model.set("hasChange",!0),"true"===e.target.refresh)r(e.target.main).trigger("dataChange")}},groupBox:{change:function(e){this.model.set(e.name,e.value),this.fire("refreshPreview")},equalToMax:function(){this.get("addGroup").setProperties({disabled:!0})},lessThanMax:function(){this.get("addGroup").setProperties({disabled:!1})}},addGroup:{click:function(){this.get("groupBox").addGroup()}},sliderHeight:{change:function(e){this.fire("sizeChange",{sliderDOM:e.target.main,direction:"height",value:e.value,dataBind:e.target.dataBind})}},sliderWidth:{change:function(e){this.fire("sizeChange",{sliderDOM:e.target.main,direction:"width",value:e.value,dataBind:e.target.dataBind})}},save:{click:function(){this.fire("tryToSave")}},preview:{click:function(e){this.fire("getPreview",{previewButton:e.target})}},reset:{click:function(){this.fire("reset")}},messageBoardCMS:{change:function(){this.fire("messageItemChange")}},bannerCtrl:{change:function(){this.fire("bannerChanged",{refreshPreview:!0})},updateUrl:function(){this.fire("bannerChanged",{refreshPreview:!1})}}},e.prototype.enterDocument=function(){n.prototype.enterDocument.call(this,arguments);var e=this,t=this.model,i=require("./colorPickerCtrl");i.dispose(),i.init(t),a.init(e,t),f.init(e),l.init(e,t),u.init(e,t),c.init(e),d.init(),r(".refresh-preview").on("change input dataChange",function(t,i){if(t.stopPropagation(),"undefined"!=typeof i){if(!i.preventRefresh)e.fire("refreshPreview")}else e.fire("refreshPreview")}),r('[name="isCustomerStyle"]').on("change",function(e){var i=r(e.target);if(1===+i.val())t.set("skinName","")}),s.init(e,t)},i.inherits(e,n),e}),define("newstyleManage/StyleManageAction",["require","er/util","er/Action","etpl","./pretreat","er/locator","er/URL","jquery","common/esuix/Dialog","common/util/clientInterface","./lib","./config","./tips","./validate","./StyleManageModel","./StyleManageView"],function(require){function e(){i.apply(this,arguments)}var t=require("er/util"),i=require("er/Action"),n=require("etpl"),r=require("./pretreat"),o=require("er/locator"),a=require("er/URL"),s=require("jquery"),l=require("common/esuix/Dialog"),u=require("common/util/clientInterface"),c=require("./lib"),d=require("./config"),f=require("./tips"),h=require("./validate");return e.prototype.modelType=require("./StyleManageModel"),e.prototype.viewType=require("./StyleManageView"),e.prototype.initBehavior=function(){i.prototype.initBehavior.apply(this,arguments);var e=this.view,t=this.model;e.on("refreshPreview",function(){var e=s("#previewer"),i=t.get("device"),o=t.get("target"),a=n.getRenderer(i+o+"Preview");e.html(a(t.dump())),r.init(t.dump(),i+o)}),e.on("refreshModel",function(i){e.model=i.model,t=i.model,e.render(),e.fire("refreshPreview")}),e.on("styleRefreshStatus",function(){var e=(new Date).getTime();window.localStorage.setItem("styleRefreshStatus","save"+e)}),e.on("messageItemChange",function(){var i=e.get("messageBoardCMS");t.set("hasChange",!0);var n=i.getValue();t.set("items",n.items),t.set("itemsExt",n.itemsExt),e.fire("refreshPreview")}),e.on("bannerChanged",function(i){var n=e.get("bannerCtrl"),r=t.get("webim");if(t.set("hasChange",!0),r.banners=n.getRawValue(),i.refreshPreview)e.fire("refreshPreview")}),e.on("targetChanged",function(e){var i={device:t.get("device"),typeIndex:e.activeIndex,styleId:t.get("styleId"),styleName:t.get("styleName"),"default":t.get("default")},n=a.withQuery("/",i);o.redirect(n,{silent:!0});var r=c.getHashSearchObj(),s=require("./StyleManageModel"),l=new s(r),u=l.load(),d=this;u.done(function(){d.fire("refreshModel",{model:l})})}),e.on("reset",function(){var i=d.confirmDialogParam;i.content='<p class="info-title">'+d.targetNameCN[t.get("typeIndex")]+"</p>";var n=l.confirm(i);n.on("ok",function(){var t=c.getHashSearchObj(),i=require("./StyleManageModel"),n=new i(s.extend({},t,{isReset:!0})),r=n.load();r.done(function(){e.fire("refreshModel",{model:n}),e.fire("styleRefreshStatus")})})}),e.on("sizeChange",function(e){var t=s(e.sliderDOM);t.trigger("dataChange",{value:e.value,type:"num",name:e.dataBind}),s("#"+e.direction+"-num").html(e.value)}),e.on("getPreview",function(e){var i=e.previewButton,n=s("#preview-site"),r=d.alertDialogParam;if(""===n.val().trim())r.content='<p class="info-title"></p>',l.alert(r);else if(!n[0].checkValidity())r.content='<p class="info-title"></p>',l.alert(r);else{var o=t.getStyleContent(),c={url:n.val(),typeName:t.get("target")},f="/styleManage/beforePreview.action",h="/styleManage/preview.action",p=a.serialize(s.extend({},{styleContent:o},c)),g=t.savePreviewStyle(f,{styleContent:p},i);g.done(function(e){u.notify("OpenBrowser",{url:h+"?userId="+e.userId+"&uuid="+e.uuid,type:"default"})})}}),e.on("tryToSave",function(i){f.hideAllErrorTip();var n=h.validate(e);if(!n.result){f.showAllErrorTip(n.errorTipIDCollection);var r=s('[data-tip-for="'+n.errorTipIDCollection[0]+'"]').closest(".settings-tab"),o=s(".settings-tab").index(r),a=e.get("styleControllerTab");a.activate(a.tabs[o]);var c=d.alertDialogParam;c.content='<p class="info-title">'+d.errorTipMap[n.errorTipIDCollection[0]]+"</p>",l.alert(c)}else{var p=t.saveStyle(e);p.done(function(t){if(f.showToast("top-toast","",2e3),e.fire("styleRefreshStatus"),"undefined"!=typeof t.accessSiteManage){var n=d.confirmDialogParam;if(n.title="",1===t.accessSiteManage)n.content='<p class="info-title"></p><p class="info-content">-</p>';else if(0===t.accessSiteManage)n.content='<p class="info-title"></p><p class="info-content">-</p>';var r=l.confirm(n);if(1===t.accessSiteManage)r.on("ok",function(){u.notify("OpenCurrencyWindow",{windowType:3})})}if(t.groups)e.get("groupBox").setDatasource(t.groups);if(i.successCallback)i.successCallback()}),t.set("styleContentBackUp",s.extend(!0,{},t.get("unsavedStyleContent")))}}),e.fire("refreshPreview"),window.onCEFClose=function(){var e=t.get("hasChange"),i=null,n=d.confirmDialogParam;if(n.content='<p class="info-title"></p>',!e)u.notify("CloseWindow");else if(i=l.confirm(n))i.on("ok",function(){u.notify("CloseWindow");
})}},t.inherits(e,i),e}),define("er/util",[],function(){var e=+new Date,t={};t.guid=function(){return"er"+e++},t.mix=function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];if(i){for(var n in i)if(i.hasOwnProperty(n))e[n]=i[n]}else;}return e};var i=Function.prototype.bind;t.bind=i?function(e){return i.apply(e,[].slice.call(arguments,1))}:function(e,t){var i=[].slice.call(arguments,2);return function(){var n=i.concat([].slice.call(arguments));return e.apply(t,n)}},t.noop=function(){};var n=!{toString:1}.propertyIsEnumerable("toString");t.inherits=function(e,t){var i=function(){};i.prototype=t.prototype;var r=new i,o=e.prototype;e.prototype=r;for(var a in o)r[a]=o[a];if(n){if(o.hasOwnProperty("toString"))r.toString=o.toString;if(o.hasOwnProperty("valueOf"))r.valueOf=o.valueOf}return e.prototype.constructor=e,e},t.parseJSON=function(e){if(!e)return void 0;if(window.JSON&&"function"==typeof JSON.parse)return JSON.parse(e);else return new Function("return ("+e+");")()};var r=/(^[\s\t\xa0\u3000]+)|([\u3000\xa0\s\t]+$)/g;return t.trim=function(e){return e.replace(r,"")},t.encodeHTML=function(e){return e+="",e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")},t.getElement=function(e){if("string"==typeof e)e=document.getElementById(e);return e},t}),define("er/Deferred",["require","./util","./assert","mini-event/EventTarget"],function(require){function e(e){function t(){for(var t=0;t<i.length;t++){var n=i[t];try{n.apply(e.promise,e._args)}catch(r){}}}if("pending"!==e.state){var i="resolved"===e.state?e._doneCallbacks.slice():e._failCallbacks.slice();if(e.syncModeEnabled)t();else o(t);e._doneCallbacks=[],e._failCallbacks=[]}}function t(e,t,n,r){return function(){if("function"==typeof n){var o=t.resolver;try{var a=n.apply(e.promise,arguments);if(i.isPromise(a))a.then(o.resolve,o.reject);else o.resolve(a)}catch(s){i.fire("exception",{deferred:e,args:[s],reason:s}),o.reject(s)}}else t[r].apply(t,e._args)}}function i(){this.state="pending",this._args=null,this._doneCallbacks=[],this._failCallbacks=[],this.promise={done:n.bind(this.done,this),fail:n.bind(this.fail,this),ensure:n.bind(this.ensure,this),then:n.bind(this.then,this)},this.promise.promise=this.promise,this.resolver={resolve:n.bind(this.resolve,this),reject:n.bind(this.reject,this)}}var n=require("./util"),r=require("./assert"),o="function"==typeof window.setImmediate?function(e){window.setImmediate(e)}:function(e){window.setTimeout(e,0)};return require("mini-event/EventTarget").enable(i),i.isPromise=function(e){return e&&"function"==typeof e.then},i.prototype.syncModeEnabled=!1,i.prototype.resolve=function(){if("pending"===this.state)this.state="resolved",this._args=[].slice.call(arguments),i.fire("resolve",{deferred:this,args:this._args,reason:this._args[0]}),e(this)},i.prototype.reject=function(){if("pending"===this.state)this.state="rejected",this._args=[].slice.call(arguments),i.fire("reject",{deferred:this,args:this._args,reason:this._args[0]}),e(this)},i.prototype.done=function(e){return this.then(e)},i.prototype.fail=function(e){return this.then(null,e)},i.prototype.ensure=function(e){return this.then(e,e)},i.prototype.then=function(n,r){var o=new i;return o.syncModeEnabled=this.syncModeEnabled,this._doneCallbacks.push(t(this,o,n,"resolve")),this._failCallbacks.push(t(this,o,r,"reject")),e(this),o.promise},i.all=function(){function e(e){a--,r.greaterThanOrEquals(a,0,"workingCount should be positive");var t=[].slice.call(arguments,1);if(t.length<=1)t=t[0];if(l[e]=t,0===a)u[s].apply(u,l)}function t(){s="reject",e.apply(this,arguments)}var o=[].concat.apply([],arguments),a=o.length;if(!a)return i.resolved();for(var s="resolve",l=[],u=new i,c=0;c<o.length;c++){var d=o[c];d.then(n.bind(e,d,c),n.bind(t,d,c))}return u.promise},i.resolved=function(){var e=new i;return e.resolve.apply(e,arguments),e.promise},i.rejected=function(){var e=new i;return e.reject.apply(e,arguments),e.promise},i.when=function(e){if(i.isPromise(e))return e;var t=new i;return t.syncModeEnabled=!0,t.resolve(e),t.promise},i.require=function(e){var t=new i;return window.require(e,t.resolver.resolve),t.promise.abort=t.resolver.reject,t.promise},i}),define("er/router",["require","./util","mini-event/EventTarget","./URL","./locator","./events"],function(require){function e(){this.routes=[],this.backup=null}function t(e){for(var t=require("./URL").parse(e.url),i=t.getPath(),n=0;n<this.routes.length;n++){var r=this.routes[n];if(r.rule instanceof RegExp&&r.rule.test(i)||r.rule===i)return void r.handler.call(this,t)}if(this.backup)this.backup(t);this.getEventBus().fire("route",{url:t,router:this})}var i=require("./util");i.inherits(e,require("mini-event/EventTarget")),e.prototype.add=function(e,t){this.routes.push({rule:e,handler:t})},e.prototype.setBackup=function(e){this.backup=e},e.prototype.getLocator=function(){return this.locator},e.prototype.setLocator=function(e){this.locator=e},e.prototype.getEventBus=function(){return this.eventBus},e.prototype.setEventBus=function(e){this.eventBus=e},e.prototype.start=function(){this.getLocator().on("redirect",t,this)};var n=new e;return n.setLocator(require("./locator")),n.setEventBus(require("./events")),n.Router=e,n}),define("er/permission",[],function(){var e={},t={add:function(t){for(var i in t)if(t.hasOwnProperty(i)){var n=t[i];if("object"==typeof n)this.add(n);else e[i]=n}},isAllow:function(t){return!!e[t]}};return t}),define("er/controller",["require","./Deferred","./URL","./config","./util","./assert","mini-event/EventTarget","./locator","./router","./events","./permission"],function(require){function e(){this.actionPathMapping={},this.childActionMapping={},this.currentURL=null,this.currentAction=null,this.globalActionLoader=null,this.childActionLoaders={}}function t(e,t,i){var n=e.childActionMapping[t.id];if(n){if(e.childActionMapping[t.id]=void 0,n.hijack)if(t.removeEventListener)t.removeEventListener("click",n.hijack,!1);else t.detachEvent("onclick",n.hijack);if(n.action){if(!i)i={url:null,referrer:n.url,container:t.id,isChildAction:!0};if(e.getEventBus().fire("leaveaction",{controller:e,action:n.action,to:i}),"function"==typeof n.action.leave)n.action.leave()}}}function i(e,i,n,r,o){if(t(e,i,o),i.addEventListener)i.addEventListener("click",r,!1);else i.attachEvent("onclick",r);var a={url:o.url,container:i.id,action:n,hijack:r};e.childActionMapping[i.id]=a;var s=require("mini-event/EventTarget");if(n instanceof s)n.on("leave",function(){t(e,i)})}var n=require("./Deferred"),r=require("./URL"),o=require("./config"),a=require("./util"),s=require("./assert");a.inherits(e,require("mini-event/EventTarget")),e.prototype.registerAction=function(e){if(!e.hasOwnProperty("length"))e=[e];for(var t=0;t<e.length;t++){var i=e[t];s.hasProperty(i,"path",'action config should contains a "path" property'),this.actionPathMapping[i.path]=i}},e.prototype.getDefaultTitle=function(){return this.defaultTitle},e.prototype.setDefaultTitle=function(e){this.defaultTitle=e},e.prototype.getRouter=function(){return this.router},e.prototype.setRouter=function(e){this.router=e},e.prototype.getLocator=function(){return this.locator},e.prototype.setLocator=function(e){this.locator=e},e.prototype.getEventBus=function(){return this.eventBus},e.prototype.setEventBus=function(e){this.eventBus=e},e.prototype.getPermissionProvider=function(){return this.permissionProvider},e.prototype.setPermissionProvider=function(e){this.permissionProvider=e},e.prototype.getMainContainer=function(){return this.mainContainer||o.mainElement},e.prototype.setMainContainer=function(e){this.mainContainer=e},e.prototype.getNoAuthorityLocation=function(){return this.noAuthorityLocation||o.noAuthorityLocation},e.prototype.setNoAuthorityLocation=function(e){this.noAuthorityLocation=e},e.prototype.getNotFoundLocation=function(){return this.notFoundLocation||o.notFoundLocation},e.prototype.setNotFoundLocation=function(e){this.notFoundLocation=e},e.prototype.start=function(){if(!this.getDefaultTitle())this.setDefaultTitle(o.systemName||document.title);this.getRouter().setBackup(a.bind(this.renderAction,this))},e.prototype.findActionConfig=function(e){var t=e.url.getPath(),i=this.actionPathMapping[t];return i},e.prototype.resolveActionConfig=function(e,t){return e},e.prototype.checkAuthority=function(e,t){var i=e.authority;if(!i)return!0;var n=this.getPermissionProvider();if("function"==typeof i)return i(t,e,n);if("string"==typeof i)i=i.split("|");for(var r=0;r<i.length;r++)if(n.isAllow(a.trim(i[r])))return!0;return!1},e.prototype.findEligibleActionConfig=function(e){var t=this.findActionConfig(e);if(t&&t.movedTo)return this.getEventBus().fire("actionmoved",{controller:this,url:e.url,config:t,movedTo:t.movedTo}),e.originalURL=e.url,e.url=r.parse(t.movedTo),this.findEligibleActionConfig(e);if(t&&t.childActionOnly&&!e.isChildAction)t=null;if(!t)if(this.getEventBus().fire("actionnotfound",a.mix({controller:this,failType:"NotFound",reason:"Not found"},e)),e.originalURL=e.url,e.url=r.parse(this.getNotFoundLocation()),!this.actionPathMapping[e.url.getPath()])return null;else return this.findEligibleActionConfig(e);var i=this.checkAuthority(t,e);if(!i){this.getEventBus().fire("permissiondenied",a.mix({controller:this,failType:"PermissionDenied",reason:"Permission denied",config:t},e));var n=t.noAuthorityLocation||this.getNoAuthorityLocation();return e.originalURL=e.url,e.url=r.parse(n),this.findEligibleActionConfig(e)}return t},e.prototype.loadAction=function(e){var t=this.findEligibleActionConfig(e);if(t=this.resolveActionConfig(t,e),!t){var i=new n;return i.syncModeEnabled=!1,i.reject("no action configured for url "+e.url.getPath()),i.promise}if(e.title=t.title,e.args.title=t.title,t.args)for(var r in t.args)if(t.args.hasOwnProperty(r)){if(!e.args.hasOwnProperty(r))e.args[r]=t.args[r];if(!e.hasOwnProperty(r))e[r]=t.args[r]}var o=new n;o.syncModeEnabled=!1;var s=o.promise,l=!1,u=function(){if(!l)l=!0,this.getEventBus().fire("actionabort",a.mix({controller:this},e))};if(s.abort=a.bind(u,this),!e.isChildAction)this.currentURL=e.url;var c=function(i){if(!l){if(!i){var r="No action implement for "+t.type,s=a.mix({controller:this,failType:"NoModule",config:t,reason:r},e);return this.getEventBus().fire("actionfail",s),this.getEventBus().notifyError(s),void o.reject(r)}if(this.getEventBus().fire("actionloaded",{controller:this,url:e.url,config:t,action:i}),"function"==typeof i)o.resolve(new i,e);else if("function"==typeof i.createRuntimeAction){var u=function(i){if(!i){var n="Action factory returns non-action",r=a.mix({controller:this,failType:"InvalidFactory",config:t,reason:n,action:i},e);this.getEventBus().fire("actionfail",r),this.getEventBus().notifyError(r),o.reject(n)}else o.resolve(i,e)};u=a.bind(u,this);var c=i.createRuntimeAction(e);n.when(c).then(u)}else o.resolve(i,e)}};if(c=a.bind(c,this),"string"==typeof t.type)window.require([t.type],c);else c(t.type);return s},e.prototype.enterAction=function(e,t){if(!t.isChildAction){if(t.url!==this.currentURL)return;if(this.currentAction)if(this.getEventBus().fire("leaveaction",{controller:this,action:this.currentAction,to:a.mix({},t)}),"function"==typeof this.currentAction.leave)this.currentAction.leave();this.currentAction=e,document.title=t.title||t.documentTitle||this.getDefaultTitle()}this.getEventBus().fire("enteraction",a.mix({controller:this,action:e},t));var i=function(){this.getEventBus().fire("enteractioncomplete",a.mix({controller:this,action:e},t))};i=a.bind(i,this);var n=function(e){var i="";if(!e)i="Invoke action.enter() causes error";else if(e.message){if(i=e.message,e.stack)i+="\n"+e.stack}else if(window.JSON&&"function"==typeof JSON.stringify)try{i=JSON.stringify(e)}catch(n){i=e}else i=e;var r=a.mix({failType:"EnterFail",reason:i},t);this.getEventBus().fire("enteractionfail",r),this.getEventBus().notifyError(r)};n=a.bind(n,this);var r=e.enter(t);return r.then(i,n),r},e.prototype.forward=function(e,t,i,n){var r={url:e,container:t,isChildAction:!!n};if(n){var o=this.childActionMapping[t];r.referrer=o?o.url:null}else r.referrer=this.currentURL;a.mix(r,i),r.args=a.mix({},r),a.mix(r.args,e.getQuery()),this.getEventBus().fire("forwardaction",a.mix({controller:this},r));var l=this.loadAction(r);return s.has(l,"loadAction should always return a Promise"),l},e.prototype.renderAction=function(e){if("string"==typeof e)e=r.parse(e);if(this.globalActionLoader&&"function"==typeof this.globalActionLoader.abort)this.globalActionLoader.abort();if(this.currentAction&&"function"==typeof this.currentAction.filterRedirect&&this.currentAction.filterRedirect(e)===!1)return n.rejected("Redirect aborted by previous action");this.globalActionLoader=this.forward(e,this.getMainContainer(),null,!1);var t=this.getEventBus();return this.globalActionLoader.then(a.bind(this.enterAction,this)).fail(a.bind(t.notifyError,t))},e.prototype.enterChildAction=function(e,n){function r(e,i,r){i=i||{};var e=u.resolveURL(e,i);if(i.global){var o=document.getElementById(n.container),a=u.redirect(e,i);if(a&&o)t(c,o);return a}var s=c.childActionMapping[n.container],l=e.toString()!==s.url.toString(),d=l||i.force;if(d)if(i.silent)s.url=e;else c.renderChildAction(e,s.container,r);return d}function o(e){if(e.isChildActionRedirected)return!0;for(var t=e.target||e.srcElement;t&&(!t.id||!c.childActionMapping[t.id]);)t=t.parentNode;if(t.id!==n.container)return e.isChildActionRedirected=!0,!0;else return!1}function s(e){e=e||window.event;var t=e.target||e.srcElement;if("a"===t.nodeName.toLowerCase()){var i=t.getAttribute("href",2)||"";if("#"===i.charAt(0))if(!o(e)){if(e.preventDefault)e.preventDefault();else e.returnValue=!1;for(var n=i.substring(1),s=(t.getAttribute("data-redirect")||"").split(/[,\s]/),l={},u=0;u<s.length;u++){var c=a.trim(s[u]);l[c]=!0}r(n,l)}}}this.childActionLoaders[n.container]=null;var l=document.getElementById(n.container);if(l){var u=this.getLocator(),c=this;return e.redirect=r,e.reload=function(e){this.redirect(n.url,{force:!0},e)},e.back=function(e,t){var i=this.context&&this.context.referrer,n=i||e;this.redirect(n,null,t)},i(this,l,e,s,n),this.enterAction(e,n)}},e.prototype.renderChildAction=function(e,t,i){if(s.has(t),"string"==typeof e)e=r.parse(e);var o=this.childActionLoaders[t];if(o&&"function"==typeof o.abort)o.abort();var l=this.childActionMapping[t],u=l&&l.action;if(u&&"function"==typeof u.filterRedirect&&u.filterRedirect(e)===!1)return n.rejected("Redirect aborted by previous action");var c=this.forward(e,t,i,!0),d=this.getEventBus(),f=c.then(a.bind(this.enterChildAction,this)).fail(a.bind(d.notifyError,d));return f.abort=c.abort,this.childActionLoaders[t]=f,f};var l=new e;return l.setLocator(require("./locator")),l.setRouter(require("./router")),l.setEventBus(require("./events")),l.setPermissionProvider(require("./permission")),l.Controller=e,l}),define("er/main",["require","./controller","./router","./locator"],function(require){var e={version:"3.1.0-beta.4",start:function(){require("./controller").start(),require("./router").start(),require("./locator").start()}};return e}),define("er",["er/main"],function(e){return e}),define("newstyleManage/StyleManageMain",["require","er/controller","er/main"],function(require){function e(){var e=require("er/controller");e.registerAction({path:"/",type:"newstyleManage/StyleManageAction"}),e.registerAction({path:"/messageBoardCMS",type:"newstyleManage/messageBoardCMS/MessageBoardCMSAction"}),require("er/main").start()}return e});